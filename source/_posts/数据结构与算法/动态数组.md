---
title: åŠ¨æ€æ•°ç»„
date: 2020-10-15 14:41:12
tags: æ•°æ®ç»“æ„ä¸ç®—æ³•
---

[åŠ¨æ€æ•°ç»„](https://baike.baidu.com/item/%E5%8A%A8%E6%80%81%E6%95%B0%E7%BB%84/10997983?fr=aladdin)æ˜¯æŒ‡åœ¨å£°æ˜æ—¶æ²¡æœ‰ç¡®å®šæ•°ç»„å¤§å°çš„æ•°ç»„ï¼Œå³å¿½ç•¥åœ†æ‹¬å·ä¸­çš„ä¸‹æ ‡ï¼›å½“è¦ç”¨å®ƒæ—¶ï¼Œå¯éšæ—¶ç”¨ReDimè¯­å¥é‡æ–°æŒ‡å‡ºæ•°ç»„çš„å¤§å°ã€‚ä½¿ç”¨åŠ¨æ€æ•°ç»„çš„ä¼˜ç‚¹æ˜¯å¯ä»¥æ ¹æ®ç”¨æˆ·éœ€è¦ï¼Œæœ‰æ•ˆåˆ©ç”¨å­˜å‚¨ç©ºé—´ã€‚

<!-- more -->

# æ•°æ®ç»“æ„
[æ•°æ®ç»“æ„](https://baike.baidu.com/item/%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84/1450?fr=aladdin)æ˜¯è®¡ç®—æœºå­˜å‚¨ã€ç»„ç»‡æ•°æ®çš„æ–¹å¼ã€‚æ•°æ®ç»“æ„æ˜¯æŒ‡ç›¸äº’ä¹‹é—´å­˜åœ¨ä¸€ç§æˆ–å¤šç§ç‰¹å®šå…³ç³»çš„æ•°æ®å…ƒç´ çš„é›†åˆã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œç²¾å¿ƒé€‰æ‹©çš„æ•°æ®ç»“æ„å¯ä»¥å¸¦æ¥æ›´é«˜çš„è¿è¡Œæˆ–è€…å­˜å‚¨æ•ˆç‡ã€‚æ•°æ®ç»“æ„å¾€å¾€åŒé«˜æ•ˆçš„æ£€ç´¢ç®—æ³•å’Œç´¢å¼•æŠ€æœ¯æœ‰å…³ã€‚

## æ•°æ®çš„é€»è¾‘ç»“æ„
æŒ‡åæ˜ æ•°æ®å…ƒç´ ä¹‹é—´çš„é€»è¾‘å…³ç³»çš„æ•°æ®ç»“æ„ï¼Œå…¶ä¸­çš„é€»è¾‘å…³ç³»æ˜¯æŒ‡æ•°æ®å…ƒç´ ä¹‹é—´çš„å‰åé—´å…³ç³»ï¼Œè€Œä¸ä»–ä»¬åœ¨è®¡ç®—æœºä¸­çš„å­˜å‚¨ä½ç½®æ— å…³ã€‚é€»è¾‘ç»“æ„åŒ…æ‹¬ï¼š
1. é›†åˆï¼šæ•°æ®ç»“æ„ä¸­çš„å…ƒç´ ä¹‹é—´é™¤äº†â€œåŒå±ä¸€ä¸ªé›†åˆâ€ çš„ç›¸äº’å…³ç³»å¤–ï¼Œåˆ«æ— å…¶ä»–å…³ç³»ï¼›
2. çº¿æ€§ç»“æ„ï¼šæ•°æ®ç»“æ„ä¸­çš„å…ƒç´ å­˜åœ¨ä¸€å¯¹ä¸€çš„ç›¸äº’å…³ç³»ï¼›  
3. æ ‘å½¢ç»“æ„ï¼šæ•°æ®ç»“æ„ä¸­çš„å…ƒç´ å­˜åœ¨ä¸€å¯¹å¤šçš„ç›¸äº’å…³ç³»ï¼› 
4. å›¾å½¢ç»“æ„ï¼šæ•°æ®ç»“æ„ä¸­çš„å…ƒç´ å­˜åœ¨å¤šå¯¹å¤šçš„ç›¸äº’å…³ç³»ã€‚
![åŠ¨æ€æ•°ç»„02](åŠ¨æ€æ•°ç»„/åŠ¨æ€æ•°ç»„02.png)
çº¿æ€§ç»“æ„åŒ…æ‹¬ï¼šçº¿æ€§è¡¨ã€æ•°ç»„ã€é“¾è¡¨ã€æ ˆã€é˜Ÿåˆ—å’Œå“ˆå¸Œè¡¨ã€‚  
æ ‘å½¢ç»“æ„åŒ…æ‹¬ï¼šäºŒå‰æ ‘ã€AVLæ ‘ã€çº¢é»‘æ ‘ã€Bæ ‘ã€å †ã€Trieã€å“ˆå¤«æ›¼æ ‘å’Œå¹¶æŸ¥é›†ã€‚  
å›¾å½¢ç»“æ„åŒ…æ‹¬ï¼šé‚»æ¥çŸ©é˜µå’Œé‚»æ¥è¡¨ã€‚

## å¸¸ç”¨çš„æ•°æ®ç»“æ„ï¼š
![åŠ¨æ€æ•°ç»„01](åŠ¨æ€æ•°ç»„/åŠ¨æ€æ•°ç»„01.png)

## çº¿æ€§è¡¨
[çº¿æ€§è¡¨](https://baike.baidu.com/item/%E7%BA%BF%E6%80%A7%E8%A1%A8/3228081?fr=aladdin)æ˜¯æœ€åŸºæœ¬ã€æœ€ç®€å•ã€ä¹Ÿæ˜¯æœ€å¸¸ç”¨çš„ä¸€ç§æ•°æ®ç»“æ„ã€‚çº¿æ€§è¡¨ï¼ˆlinear listï¼‰æ˜¯æ•°æ®ç»“æ„çš„ä¸€ç§ï¼Œä¸€ä¸ªçº¿æ€§è¡¨æ˜¯nä¸ªå…·æœ‰ç›¸åŒç‰¹æ€§çš„æ•°æ®å…ƒç´ çš„æœ‰é™åºåˆ—ã€‚

![åŠ¨æ€æ•°ç»„03](åŠ¨æ€æ•°ç»„/åŠ¨æ€æ•°ç»„03.png)
a1 æ˜¯é¦–èŠ‚ç‚¹ï¼ˆé¦–å…ƒç´ ï¼‰ï¼Œan æ˜¯ä¸ºèŠ‚ç‚¹ï¼ˆå°¾å…ƒç´ ï¼‰ã€‚  
a1 æ˜¯ a2 çš„å‰é©±ï¼Œa2 æ˜¯ a1 çš„åç»§ã€‚

psï¼š[ä»€ä¹ˆæ˜¯çº¿æ€§è¡¨](http://data.biancheng.net/view/157.html)

## æ•°ç»„
[æ•°ç»„](https://baike.baidu.com/item/%E6%95%B0%E7%BB%84/3794097?fr=aladdin)æ˜¯ä¸€ç§é¡ºåºå­˜å‚¨çš„çº¿æ€§è¡¨ï¼Œæ‰€æœ‰å…ƒç´ çš„å†…å­˜åœ°å€æ˜¯è¿ç»­çš„ã€‚ä¸€ç»´æ•°ç»„æ˜¯æœ€ç®€å•çš„æ•°ç»„ï¼Œå…¶é€»è¾‘ç»“æ„æ˜¯çº¿æ€§è¡¨ã€‚
```
int[] array = new int[]{11, 22, 33};
```
![åŠ¨æ€æ•°ç»„04](åŠ¨æ€æ•°ç»„/åŠ¨æ€æ•°ç»„04.png)

åœ¨å¾ˆå¤šç¼–ç¨‹è¯­è¨€ä¸­ï¼Œæ•°ç»„éƒ½æœ‰ä¸ªè‡´å‘½çš„ç¼ºç‚¹ï¼Œæ— æ³•åŠ¨æ€ä¿®æ”¹å®¹é‡ã€‚æ€ä¹ˆå®ç°ä¸€ä¸ªå®¹é‡å¯ä»¥åŠ¨æ€ä¿®æ”¹çš„æ•°ç»„å‘¢ï¼ŸğŸ‘‡

psï¼š[ä»€ä¹ˆæ˜¯æ•°ç»„](http://data.biancheng.net/view/181.html)

# åŠ¨æ€æ•°ç»„

## æ¥å£è®¾è®¡
```
public class ArrayList<E> {
	
	/**
	 * æ¸…é™¤æ‰€æœ‰å…ƒç´ 
	 */
	public void clear() {}

	/**
	 * å…ƒç´ çš„æ•°é‡
	 * @return
	 */
	public int size() {}

	/**
	 * æ˜¯å¦ä¸ºç©º
	 * @return
	 */
	public boolean isEmpty() {}

	/**
	 * æ˜¯å¦åŒ…å«æŸä¸ªå…ƒç´ 
	 * @param element
	 * @return
	 */
	public boolean contains(E element) {}

	/**
	 * æ·»åŠ å…ƒç´ åˆ°å°¾éƒ¨
	 * @param element
	 */
	public void add(E element) {} 

	/**
	 * è·å–indexä½ç½®çš„å…ƒç´ 
	 * @param index
	 * @return
	 */
	public E get(int index) {}

	/**
	 * è®¾ç½®indexä½ç½®çš„å…ƒç´ 
	 * @param index
	 * @param element
	 * @return åŸæ¥çš„å…ƒç´ Öµ
	 */
	public E set(int index, E element) {}

	/**
	 * åœ¨indexä½ç½®æ’å…¥ä¸€ä¸ªå…ƒç´ 
	 * @param index
	 * @param element
	 */
	public void add(int index, E element) {}

	/**
	 * åˆ é™¤indexä½ç½®çš„å…ƒç´ 
	 * @param index
	 * @return
	 */
	public E remove(int index) {}

	/**
	 * æŸ¥çœ‹å…ƒç´ çš„ç´¢å¼•
	 * @param element
	 * @return
	 */
	public int indexOf(E element) {}
}
```

## å®ç°æ–¹æ¡ˆ
![åŠ¨æ€æ•°ç»„05](åŠ¨æ€æ•°ç»„/åŠ¨æ€æ•°ç»„05.png)

å®šä¹‰ size è®°å½•æ•°ç»„çš„å¤§å°ï¼Œå®šä¹‰ elements å­˜å‚¨å…ƒç´ ã€‚
```
public class ArrayList<E> {

	/*
	 * å…ƒç´ çš„æ•°é‡
	 */
	private int size;
	
    /*
	 * æ‰€æœ‰çš„å…ƒç´ 
	 */
	private E[] elements;
	
    /*
	 * é»˜è®¤å®¹é‡
	 */
	private static final int DEFAULT_CAPACITY = 10;
	
    /*
	 * æ„é€ æ–¹æ³•
	 */
	public ArrayList(int capacity) {
		capacity = (capacity < DEFAULT_CAPACITY) ? DEFAULT_CAPACITY : capacity;
		elements = (E[]) new Object[capacity];
	}
	
    /*
	 * æ„é€ æ–¹æ³•
	 */
	public ArrayList() {
		this(DEFAULT_CAPACITY);
	}
}
```

## æ·»åŠ å…ƒç´ 
![åŠ¨æ€æ•°ç»„06](åŠ¨æ€æ•°ç»„/åŠ¨æ€æ•°ç»„06.png)
æ·»åŠ æ–°å…ƒç´ ï¼Œå°±æ˜¯åœ¨ size å¤„æ·»åŠ æ–°å…ƒç´ ï¼Œä»£ç å®ç°ï¼š
```
public void add(int element) {
    elements[size++] = element;
}
```

## åˆ é™¤å…ƒç´ 
size ç­‰äº 7ï¼Œindex ç­‰äº 3ï¼š
![åŠ¨æ€æ•°ç»„07](åŠ¨æ€æ•°ç»„/åŠ¨æ€æ•°ç»„07.png)
ä» `index + 1` å¤„å¼€å§‹ä¾æ¬¡å‘å‰ç§»åŠ¨ï¼Œæœ€åä¸€ä¸ªå…ƒç´ ä¸åšå¤„ç†ï¼ˆå› ä¸ºæ‰§è¡Œäº† `size--`ï¼Œæ‰€ä»¥æœ€åä¸€ä¸ªå…ƒç´ ä¸ä¼šè¢«å¤–ç•Œè®¿é—®åˆ°ï¼‰ï¼š
```
public E remove(int index) {
	int old = elements[index];
	for (int i = index + 1; i < size; i++) {
		elements[i - 1] = elements[i];
	} 
	elements[--size] = null;
	return old;
}
```

## æ’å…¥å…ƒç´ 
size ç­‰äº 5ï¼Œindex ç­‰äº 2ï¼š
![åŠ¨æ€æ•°ç»„08](åŠ¨æ€æ•°ç»„/åŠ¨æ€æ•°ç»„08.png)
ä» `size - 1` å¤„å¼€å§‹ä¾æ¬¡å‘åç§»åŠ¨ï¼Œæœ€åè¦†ç›– index å¤„çš„å…ƒç´ ï¼š
```
public void add(int index, int element) {
	for (int i = size; i > index; i--) {
		elements[i] = elements[i - 1];
	}
	elements[index] = element;
	size++;
}
```

## æ‰©å®¹
![åŠ¨æ€æ•°ç»„09](åŠ¨æ€æ•°ç»„/åŠ¨æ€æ•°ç»„09.png)
åˆ›å»ºæ–°çš„æ•°ç»„ï¼Œæ–°æ•°ç»„çš„å®¹é‡ä¸ºæ—§æ•°ç»„å®¹é‡çš„1.5å€ï¼ˆiOS 1.6å€, java 1.5å€ï¼‰ã€‚
```
private void ensureCapacity(int capacity) {
    int oldCapacity = elements.length;
    if (oldCapacity >= capacity) return;
    
    int newCapacity = oldCapacity + (oldCapacity >> 1); // >> è¡¨ç¤ºé™¤ä»¥2
    int[] newElements = new int[newCapacity];
    for (int i = 0; i < size; i++) {
        newElements[i] = elements[i];
    }
    elements = newElements;
}
```

## ç¼©å®¹
å¦‚æœå†…å­˜ä½¿ç”¨æ¯”è¾ƒç´§å¼ ï¼ŒåŠ¨æ€æ•°ç»„æœ‰æ¯”è¾ƒå¤šçš„å‰©ä½™ç©ºé—´ï¼Œå¯ä»¥è€ƒè™‘è¿›è¡Œç¼©å®¹æ“ä½œã€‚æ¯”å¦‚å‰©ä½™ç©ºé—´å æ€»å®¹é‡çš„ä¸€åŠæ—¶ï¼Œå°±è¿›è¡Œç¼©å®¹ã€‚
```
private void trim() {
    int oldCapacity = elements.length;
    int newCapacity = oldCapacity >> 1;
    // å‰©ä½™ç©ºé—´å°äºä¸€åŠ || ç©ºé—´å¤§å° <= é»˜è®¤ç©ºé—´
    if (size >= newCapacity || oldCapacity <= DEFAULT_CAPACITY) return;
    
    E[] newElements = (E[]) new Object[newCapacity];
    for (int i = 0; i < size; i++) {
        newElements[i] = elements[i];
    }
    elements = newElements;
}
```

å¦‚æœæ‰©å®¹å€æ•°ã€ç¼©å®¹æ—¶æœºè®¾è®¡ä¸å¾—å½“ï¼Œæœ‰å¯èƒ½ä¼šå¯¼è‡´å¤æ‚åº¦éœ‡è¡ã€‚æ¯”å¦‚ç¼©å®¹æ—¶æœºæ”¹ä¸º `size > newCapacity`ï¼Œæ­¤æ—¶å®¹é‡ç­‰äºæ•°ç»„çš„ä¸€åŠæ—¶ï¼Œæ–°å¢åŠ å…ƒç´ éœ€è¦æ‰©å®¹ï¼Œåˆ é™¤å…ƒç´ éœ€è¦ç¼©å®¹ï¼Œé‚£ä¹ˆå¤æ‚åº¦å°±ä¸€ç›´æ˜¯ O(n)ã€‚

åœ¨ clear() å’Œ remove() æ–¹æ³•é‡Œè¿›è¡Œç¼©å®¹ï¼š
```
public void clear() {
    for (int i = 0; i < size; i++) {
        elements[i] = null;
    }
    size = 0;
    
    // ç¼©å®¹
    if (elements != null && elements.length > DEFAULT_CAPACITY) {
        elements = (E[]) new Object[DEFAULT_CAPACITY];
    }
}

public E remove(int index) {
    rangeCheck(index);
    E old = elements[index];
    for (int i = index + 1; i < size; i++) {
        elements[i - 1] = elements[i];
    } 
    elements[--size] = null;
    
    // ç¼©å®¹
    trim();
    
    return old;
}
```

## æ³›å‹
ä½¿ç”¨æ³›å‹æŠ€æœ¯å¯ä»¥è®©åŠ¨æ€æ•°ç»„æ›´åŠ é€šç”¨ï¼Œå¯ä»¥å­˜æ”¾ä»»ä½•æ•°æ®ç±»å‹ã€‚  
E è¡¨ç¤ºæ³›å‹ï¼š
```
public class ArrayList<E> {
    private int size;
    private E[] elements;
}
```

ä½¿ç”¨ Object åˆ›å»ºçš„æ•°ç»„å¯ä»¥å­˜æ”¾æ‰€æœ‰å¯¹è±¡ç±»å‹ï¼Œå› ä¸ºæ‰€æœ‰çš„ç±»éƒ½ç»§æ‰¿è‡ªObjectã€‚
```
elements = (E[]) new Object[capacity];
```

ç¤ºä¾‹ï¼š
```
ArrayList<Integer> ints = new ArrayList<>();
ints.add(10);

ArrayList<Object> objs = new ArrayList<>();
objs.add(10);
objs.add(new Person(10, "Tom"));
```

# å¯¹è±¡æ•°ç»„
æ•°ç»„ä¸­å­˜æ”¾çš„æ˜¯å¯¹è±¡åœ°å€ã€‚
![åŠ¨æ€æ•°ç»„10](åŠ¨æ€æ•°ç»„/åŠ¨æ€æ•°ç»„10.png)

## åˆ é™¤å…ƒç´ 
åˆ é™¤å…ƒç´ æ—¶ï¼Œéœ€è¦å°†æ•°ç»„å¯¹åº”çš„ä½ç½®è®¾ä¸º nullï¼š
```
/**
* æ¸…é™¤æ‰€æœ‰å…ƒç´ 
*/
public void clear() {
    for (int i = 0; i < size; i++) {
        elements[i] = null;
    }
    size = 0;
}
/**
* åˆ é™¤indexä½ç½®çš„å…ƒç´ 
* @param index
* @return
*/
public E remove(int index) {
    rangeCheck(index);
    E old = elements[index];
    for (int i = index + 1; i < size; i++) {
        elements[i - 1] = elements[i];
    }
    elements[--size] = null;
    return old;
}
```

åœ¨è°ƒç”¨ `clear()` æ–¹æ³•æ—¶ï¼ŒJava çš„åƒåœ¾å›æ”¶æœºåˆ¶ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œå¯ä»¥é€šè¿‡ `System.gc()` è®©åƒåœ¾å›æ”¶æœºåˆ¶ç«‹å³å¯åŠ¨ï¼š
```
persons.clear();
// æç¤ºJVMè¿›è¡Œåƒåœ¾å›æ”¶
System.gc();
```

## æŸ¥æ‰¾å…ƒç´ 
å¦‚æœæ•°ç»„æ”¯æŒ nullï¼Œéœ€è¦ä¿®æ”¹ `indexOf()` æ–¹æ³•ï¼š
```
public int indexOf(E element) {
    if (element == null) {
        for (int i = 0; i < size; i++) {
            if (elements[i] == null) return i;
        }
    } else {
        for (int i = 0; i < size; i++) {
            //if (elements[i] == element) return i; // == æ¯”è¾ƒå†…å­˜åœ°å€
            if (elements[i].equals(element)) return i; // é‡å†™ equals()ã€‚Integer è°ƒç”¨ equals()ï¼Œå†…éƒ¨æ¯”è¾ƒçš„æ˜¯æ•°å€¼
        }
    }
    return ELEMENT_NOT_FOUND;
}
```

## åˆ¤ç­‰
Person ç±»é‡Œå®ç° `equals()` æ–¹æ³•ï¼ˆage ç›¸ç­‰ -> ä¸¤ä¸ª Person å¯¹è±¡ç›¸ç­‰ï¼‰ï¼š
```
public boolean equals(Object obj) {
	if (obj == null) return false;
	if (obj instanceof Person) {
		Person person = (Person)obj;
		return this.age == person.age;
	}
	return false;
}
```

# æºç åˆ†æ

## ArrayList
JDKä¸­å†…ç½®äº†ä¸€ä¸ªåŠ¨æ€æ•°ç»„ç±»ï¼šjava.util.ArrayListã€‚  

æ–¹å¼ä¸€ï¼š
å¦‚æœ Eclipse é‡Œæ²¡æœ‰åŠ è½½è¿™ä¸ªåŒ…ï¼Œå¯ä»¥æ‰‹åŠ¨å¯¼å…¥ï¼š
![åŠ¨æ€æ•°ç»„11](åŠ¨æ€æ•°ç»„/åŠ¨æ€æ•°ç»„11.png)

æŒ‰ä½ command ç‚¹å‡» ArrayListï¼š
```
public class Main {
	public static void main(String[] args) {
		java.util.ArrayList<E>
	}
}
```

æ–¹å¼äºŒï¼š
![åŠ¨æ€æ•°ç»„12](åŠ¨æ€æ•°ç»„/åŠ¨æ€æ•°ç»„12.png)

## ä»£ç 
### å˜é‡
```
/**
 * Default initial capacity.
 */
private static final int DEFAULT_CAPACITY = 10;

/**
 * Shared empty array instance used for empty instances.
 */
private static final Object[] EMPTY_ELEMENTDATA = {};

/**
 * Shared empty array instance used for default sized empty instances. We
 * distinguish this from EMPTY_ELEMENTDATA to know how much to inflate when
 * first element is added.
 */
private static final Object[] DEFAULTCAPACITY_EMPTY_ELEMENTDATA = {};

/**
 * The array buffer into which the elements of the ArrayList are stored.
 * The capacity of the ArrayList is the length of this array buffer. Any
 * empty ArrayList with elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA
 * will be expanded to DEFAULT_CAPACITY when the first element is added.
 */
transient Object[] elementData; // non-private to simplify nested class access

/**
 * The size of the ArrayList (the number of elements it contains).
 *
 * @serial
 */
private int size;
```

### æ„é€ æ–¹æ³•
```
/**
 * Constructs an empty list with the specified initial capacity.
 *
 * @param  initialCapacity  the initial capacity of the list
 * @throws IllegalArgumentException if the specified initial capacity
 *         is negative
 */
public ArrayList(int initialCapacity) {
    if (initialCapacity > 0) {
        this.elementData = new Object[initialCapacity];
    } else if (initialCapacity == 0) {
        this.elementData = EMPTY_ELEMENTDATA;
    } else {
        throw new IllegalArgumentException("Illegal Capacity: "+
                                           initialCapacity);
    }
}

/**
 * Constructs an empty list with an initial capacity of ten.
 */
public ArrayList() {
    this.elementData = DEFAULTCAPACITY_EMPTY_ELEMENTDATA;
}
```

### æ•°ç»„å¤§å°
```
//**
 * Returns the number of elements in this list.
 *
 * @return the number of elements in this list
 */
public int size() {
    return size;
}
```

### åˆ¤ç©º
```
/**
 * Returns {@code true} if this list contains no elements.
 *
 * @return {@code true} if this list contains no elements
 */
public boolean isEmpty() {
    return size == 0;
}
```

### æŸ¥æ‰¾
```
/**
 * Returns {@code true} if this list contains the specified element.
 * More formally, returns {@code true} if and only if this list contains
 * at least one element {@code e} such that
 * {@code Objects.equals(o, e)}.
 *
 * @param o element whose presence in this list is to be tested
 * @return {@code true} if this list contains the specified element
 */
public boolean contains(Object o) {
    return indexOf(o) >= 0;
}

/**
 * Returns the index of the first occurrence of the specified element
 * in this list, or -1 if this list does not contain the element.
 * More formally, returns the lowest index {@code i} such that
 * {@code Objects.equals(o, get(i))},
 * or -1 if there is no such index.
 */
public int indexOf(Object o) {
    return indexOfRange(o, 0, size);
}

int indexOfRange(Object o, int start, int end) {
    Object[] es = elementData;
    if (o == null) {
        for (int i = start; i < end; i++) {
            if (es[i] == null) {
                return i;
            }
        }
    } else {
        for (int i = start; i < end; i++) {
            if (o.equals(es[i])) {
                return i;
            }
        }
    }
    return -1;
}
```

### è·å–
```
/**
 * Returns the element at the specified position in this list.
 *
 * @param  index index of the element to return
 * @return the element at the specified position in this list
 * @throws IndexOutOfBoundsException {@inheritDoc}
 */
public E get(int index) {
    Objects.checkIndex(index, size);
    return elementData(index);
}
```

### ä¿®æ”¹
```
/**
 * Replaces the element at the specified position in this list with
 * the specified element.
 *
 * @param index index of the element to replace
 * @param element element to be stored at the specified position
 * @return the element previously at the specified position
 * @throws IndexOutOfBoundsException {@inheritDoc}
 */
public E set(int index, E element) {
    Objects.checkIndex(index, size);
    E oldValue = elementData(index);
    elementData[index] = element;
    return oldValue;
}
```

### æ·»åŠ 
```
/**
 * This helper method split out from add(E) to keep method
 * bytecode size under 35 (the -XX:MaxInlineSize default value),
 * which helps when add(E) is called in a C1-compiled loop.
 */
private void add(E e, Object[] elementData, int s) {
    if (s == elementData.length)
        elementData = grow();
    elementData[s] = e;
    size = s + 1;
}

/**
 * Appends the specified element to the end of this list.
 *
 * @param e element to be appended to this list
 * @return {@code true} (as specified by {@link Collection#add})
 */
public boolean add(E e) {
    modCount++;
    add(e, elementData, size);
    return true;
}

/**
 * Inserts the specified element at the specified position in this
 * list. Shifts the element currently at that position (if any) and
 * any subsequent elements to the right (adds one to their indices).
 *
 * @param index index at which the specified element is to be inserted
 * @param element element to be inserted
 * @throws IndexOutOfBoundsException {@inheritDoc}
 */
public void add(int index, E element) {
    rangeCheckForAdd(index);
    modCount++;
    final int s;
    Object[] elementData;
    if ((s = size) == (elementData = this.elementData).length)
        elementData = grow();
    System.arraycopy(elementData, index,
                     elementData, index + 1,
                     s - index);
    elementData[index] = element;
    size = s + 1;
}
```

### åˆ é™¤
```
/**
 * Removes the element at the specified position in this list.
 * Shifts any subsequent elements to the left (subtracts one from their
 * indices).
 *
 * @param index the index of the element to be removed
 * @return the element that was removed from the list
 * @throws IndexOutOfBoundsException {@inheritDoc}
 */
public E remove(int index) {
    Objects.checkIndex(index, size);
    final Object[] es = elementData;

    @SuppressWarnings("unchecked") E oldValue = (E) es[index];
    fastRemove(es, index);

    return oldValue;
}
```

### æ¸…ç©º
```
/**
 * Removes all of the elements from this list.  The list will
 * be empty after this call returns.
 */
public void clear() {
    modCount++;
    final Object[] es = elementData;
    for (int to = size, i = size = 0; i < to; i++)
        es[i] = null;
}
```

### æ‰©å®¹
```
**
 * Increases the capacity of this {@code ArrayList} instance, if
 * necessary, to ensure that it can hold at least the number of elements
 * specified by the minimum capacity argument.
 *
 * @param minCapacity the desired minimum capacity
 */
public void ensureCapacity(int minCapacity) {
    if (minCapacity > elementData.length
        && !(elementData == DEFAULTCAPACITY_EMPTY_ELEMENTDATA
             && minCapacity <= DEFAULT_CAPACITY)) {
        modCount++;
        grow(minCapacity);
    }
}

/**
 * Increases the capacity to ensure that it can hold at least the
 * number of elements specified by the minimum capacity argument.
 *
 * @param minCapacity the desired minimum capacity
 * @throws OutOfMemoryError if minCapacity is less than zero
 */
private Object[] grow(int minCapacity) {
    int oldCapacity = elementData.length;
    if (oldCapacity > 0 || elementData != DEFAULTCAPACITY_EMPTY_ELEMENTDATA) {
        int newCapacity = ArraysSupport.newLength(oldCapacity,
                minCapacity - oldCapacity, /* minimum growth */
                oldCapacity >> 1           /* preferred growth */);
        return elementData = Arrays.copyOf(elementData, newCapacity);
    } else {
        return elementData = new Object[Math.max(DEFAULT_CAPACITY, minCapacity)];
    }
}

private Object[] grow() {
    return grow(size + 1);
}
```

# æµ‹è¯•
ä½¿ç”¨ Assertsï¼ˆæ–­è¨€ï¼‰è¿›è¡Œæµ‹è¯•ï¼š
![åŠ¨æ€æ•°ç»„13](åŠ¨æ€æ•°ç»„/åŠ¨æ€æ•°ç»„13.png)

# å¤æ‚åº¦åˆ†æ

psï¼š[è‡ªå®šä¹‰ArrayListï¼ˆä»£ç ï¼‰](https://github.com/KevinYangGit/Data-Structures)  


