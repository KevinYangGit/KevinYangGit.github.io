---
title: é›†åˆç±»
date: 2023-01-15 17:11:07
tags: Swift
---

* [æ•°ç»„](#æ•°ç»„)
* [Set](#set)
* [å­—å…¸](#å­—å…¸)

<!-- more -->

## æ•°ç»„

### åˆ›å»ºæ•°ç»„

#### æ•°ç»„å­—é¢é‡

1ã€å­—é¢é‡åˆ›å»ºï¼š

```swift
let array = [1, 2, 3, 4]
```

>æ•°ç»„å­—é¢é‡å†™æ³•ï¼šä¸€ç³»åˆ—çš„å€¼ï¼Œç”¨é€—å·åˆ†éš”ï¼Œç”¨æ–¹æ‹¬å·æ‹¬èµ·æ¥ã€‚

2ã€å­—é¢é‡åˆ›å»ºç©ºæ•°ç»„ï¼š

```swift
var array:[Int] = []
var array:[String] = []
```

>âš ï¸æ³¨æ„ï¼š**åˆ›å»ºç©ºæ•°ç»„å¿…é¡»æºå¸¦ç±»å‹ä¿¡æ¯**ï¼Œå¦åˆ™ç¼–è¯‘ä¸é€šè¿‡ã€‚
![01](é›†åˆç±»/01.png)

3ã€å¦‚æœå†…å®¹å·²ç»æä¾›äº†ç±»å‹ä¿¡æ¯ï¼Œåˆ™å¯ä»¥é€šè¿‡ç©ºæ•°ç»„å­—é¢é‡æ¥åˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„ï¼š

```swift
// å› ä¸ºå†…å®¹æä¾›äº†ç±»å‹ä¿¡æ¯ [Int]
var array = [1, 2, 3, 4]
print(array)
// æ‰€ä»¥å¯ä»¥é€šè¿‡ç©ºæ•°ç»„å­—é¢é‡æ¥åˆ›å»ºä¸€ä¸ªç©ºæ•°ç»„
array = []
print(array)
```

>æä¾›ç±»å‹ä¿¡æ¯çš„æƒ…å†µåŒ…æ‹¬ï¼š
>
>1. ä½œä¸ºå‡½æ•°çš„å®é™…å‚æ•°ï¼›
>2. å·²ç»åˆ†ç±»äº†çš„å˜é‡æˆ–å¸¸é‡ï¼›

#### åˆå§‹åŒ–å™¨

ä½¿ç”¨åˆå§‹åŒ–å™¨æœ‰ä¸¤ç§æ–¹å¼ï¼š

1ã€`[ç±»å‹]()`

```swift
var array = [String]()
```

2ã€`Array<ç±»å‹>()`

```swift
var array = Array<String>()
```

#### åˆå§‹åŒ–å™¨å‚æ•°

```swift
let fiveZs = Array(repeating: "Z", count: 5)
print(fiveZs)
// Prints ["Z", "Z", "Z", "Z", "Z"]
```

```swift
let fiveYs = Array(arrayLiteral: "Y", "Y", "Y", "Y", "Y")
print(fiveYs)
// Prints ["Y", "Y", "Y", "Y", "Y"]
```

```swift
let numbers = [Int](0...7)
print(numbers)
// Prints [0, 1, 2, 3, 4, 5, 6, 7]
```

```swift
let persons = ["zhangsan":27, "lisi":28, "wangwu":29]
let names = [String](persons.keys)
print(names)
// Prints ["zhangsan", "wangwu", "lisi"]
```

### æ•°ç»„éå†ä¸ç´¢å¼•

#### For-In

1ã€éå†

```swift
let numbers = [Int](0...7)
for num in numbers {
    print(num)
}
```

æ‰“å°ç»“æœï¼š

```js
0
1
2
3
4
5
6
7
```

2ã€ä½¿ç”¨ break è·³å‡ºå¾ªç¯ã€‚

```swift
let numbers = [Int](0...7)
for num in numbers {
    if (num == 3) {
        break
    }
    print(num)
}
```

æ‰“å°ç»“æœä¸­åªæœ‰`0ã€1ã€2`ï¼š

```js
0
1
2
```

3ã€ä½¿ç”¨ continue è·³è¿‡å¾ªç¯ã€‚

```swift
let numbers = [Int](0...7)
for num in numbers {
    if (num == 3) {
        continue
    }
    print(num)
}
```

æ‰“å°ç»“æœä¸­æ²¡æœ‰3ï¼š

```js
0
1
2
4
5
6
7
```

#### forEach

1ã€éå†ã€‚

```swift
let numbers = [Int](0...7)
numbers.forEach { (num) in
    print(num)
}
```

æ‰“å°ç»“æœï¼š

```js
0
1
2
3
4
5
6
7
```

2ã€æ— æ³•ä½¿ç”¨ break æˆ– continue è·³å‡ºæˆ–è€…è·³è¿‡å¾ªç¯ã€‚

![02](é›†åˆç±»/02.png)

3ã€ä½¿ç”¨ return åªèƒ½é€€å‡ºå½“å‰ä¸€æ¬¡å¾ªç¯çš„æ‰§è¡Œä½“ï¼Œæ•ˆæœç­‰åŒäº For-in ä¸­ä½¿ç”¨ continueã€‚

```swift
let numbers = [Int](0...7)
numbers.forEach { (num) in
    if num == 3 {
        return
    }
    print(num)
}
```

æ‰“å°ç»“æœä¸­æ²¡æœ‰3ï¼š

```js
0
1
2
4
5
6
7
```

#### enumerated

å¯ä»¥å®ç°åŒæ—¶å¾—åˆ°ç´¢å¼•å’Œå€¼ã€‚

```swift
let numbers = [Int](2...7)
for (index, num) in numbers.enumerated() {
    print("the index is: \(index)")
}
```

æ‰“å°ç»“æœï¼š

```js
the index is: 0
the index is: 1
the index is: 2
the index is: 3
the index is: 4
the index is: 5
```

æƒ³è¦åŒæ—¶å¾—åˆ°ç´¢å¼•å’Œå€¼ï¼Œå¿…é¡»ä½¿ç”¨ `enumerated()`ï¼Œå¦åˆ™ä¼šæŠ¥é”™ã€‚

![03](é›†åˆç±»/03.png)

#### Iterator

`Iterator`ï¼šè¿­ä»£å™¨ã€‚

```swift
let numbers = [Int](2...7)
var numIterator = numbers.makeIterator()
while let num = numIterator.next() {
    print(num)
}
```

æ‰“å°ç»“æœï¼š

```js
2
3
4
5
6
7
```

#### ç´¢å¼•

`startIndex`ï¼šè¿”å›ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ï¼Œå¯¹äºæ•°ç»„æ¥è¯´ï¼Œæ°¸è¿œéƒ½æ˜¯0ã€‚

```swift
let numbers = [1]
print(numbers.startIndex)
// Prints 0
```

`endIndex`ï¼šè¿”å›æœ€åä¸€ä¸ªå…ƒç´  **ç´¢å¼•å€¼+1** çš„ä½ç½®ï¼Œå¯¹äºæ•°ç»„æ¥è¯´ï¼Œ**ç­‰åŒäº`count`**ã€‚

```swift
let numbers = [1]
print(numbers.endIndex)
print(numbers.count)
// 1
// 1
```

å¯¹äºç©ºæ•°ç»„ï¼Œ`startIndex` ç­‰äº `endIndex`ã€‚

* `indices`ï¼šè·å–æ•°ç»„çš„ç´¢å¼•åŒºé—´ã€‚

```swift
let numbers = [Int](2...7)
for i in numbers.indices {
    print(numbers[i])
}
```

æ‰“å°ç»“æœï¼š

```js
2
3
4
5
6
7
```

### æ•°ç»„çš„æŸ¥æ‰¾æ“ä½œ

#### åˆ¤æ–­æ˜¯å¦åŒ…å«æŒ‡å®šå…ƒç´ 

`contains(_:)`ï¼šåˆ¤æ–­æ•°ç»„æ˜¯å¦åŒ…å«ç»™å®šå…ƒç´ ã€‚

```swift
let numbers = [Int](0...7)
if numbers.contains(3) {
    print("numbers contains 3")
}
// Prints "numbers contains 3"
```

`contains(where:)`ï¼šåˆ¤æ–­æ•°ç»„æ˜¯å¦åŒ…å«ç¬¦åˆç»™å®šæ¡ä»¶çš„å…ƒç´ ã€‚

```swift
if numbers.contains(where: { $0 > 7 }) {
    print("num > 7")
} else {
    print("num < 7")
}
// Prints "num < 7"
```

#### åˆ¤æ–­æ‰€æœ‰å…ƒç´ ç¬¦åˆæŸä¸ªæ¡ä»¶

`allSatisfy(_:)`ï¼šåˆ¤æ–­æ•°ç»„çš„æ¯ä¸€ä¸ªå…ƒç´ éƒ½ç¬¦åˆç»™å®šçš„æ¡ä»¶ã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]
print(array.allSatisfy({ $0 > 10 }))
print(array.allSatisfy({ $0 >= 4 }))
```

æ‰“å°ç»“æœï¼š

```text
false
true
```

#### æŸ¥æ‰¾å…ƒç´ 

`first`ï¼šè¿”å›æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ•°ç»„ä¸ºç©ºï¼Œè¿”å› nilã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]
print(array.first)
// Prints Optional(10)
```

`last`ï¼šè¿”å›æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœæ•°ç»„ä¸ºç©ºï¼Œè¿”å› nilã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]
print(array.last)
// Prints Optional(4)
```

`first(where:)`ï¼šè¿”å›æ•°ç»„ç¬¬ä¸€ä¸ªç¬¦åˆç»™å®šæ¡ä»¶çš„å…ƒç´ ã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]
print(array.first(where: { $0 > 25 }))
// Prints Optional(45)
```

`last(where)`ï¼šè¿”å›æ•°ç»„æœ€åä¸€ä¸ªç¬¦åˆç»™å®šæ¡ä»¶çš„å…ƒç´ ã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]
print(array.last(where: { $0 > 25 }))
// Prints Optional(30)
```

#### æŸ¥æ‰¾ç´¢å¼•

`firstIndex(of:)`ï¼šè¿”å›ç»™å®šå…ƒç´ åœ¨æ•°ç»„ä¸­å‡ºç°çš„ç¬¬ä¸€ä¸ªä½ç½®ã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]
print(array.firstIndex(of: 30))
// Prints Optional(3)
```

`lastIndex(of:)`ï¼šè¿”å›ç»™å®šå…ƒç´ åœ¨æ•°ç»„ä¸­å‡ºç°çš„æœ€åä¸€ä¸ªä½ç½®ã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]
print(array.lastIndex(of: 20))
// Prints Optional(1)
```

`firstIndex(where:)`ï¼šè¿”å›ç¬¦åˆæ¡ä»¶çš„ç¬¬ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]
print(array.firstIndex(where: { $0 > 25 }))
// Prints Optional(2)
```

`lastIndex(where:)`ï¼šè¿”å›ç¬¦åˆæ¡ä»¶çš„æœ€åä¸€ä¸ªå…ƒç´ çš„ä½ç½®ã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]
print(array.lastIndex(where: { $0 > 25 }))
// Prints Optional(6)
```

#### æŸ¥æ‰¾æœ€å¤§æœ€å°å…ƒç´ 

`min()`ï¼šè¿”å›æ•°ç»„ä¸­æœ€å°çš„å…ƒç´ ã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]
print(array.min())
// Prints Optional(4)
```

`max()`ï¼šè¿”å›æ•°ç»„ä¸­æœ€å¤§çš„å…ƒç´ ã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]
print(array.max())
// Prints Optional(101)
```

`min(by:)`ï¼šåˆ©ç”¨ç»™å®šçš„æ–¹å¼æ¯”è¾ƒå…ƒç´ å¹¶è¿”å›æ•°ç»„ä¸­æœ€å°çš„å…ƒç´ ã€‚

```swift
var array = [(45, "error1"), (23, "error2"), (30, "error3")]
// ç³»ç»Ÿæ–¹æ³•
print(array.min(by: { a, b in
    a.0 < b.0
}))
// Prints Optional((23, "error2"))

// å°¾éšé—­åŒ…æ–¹å¼
print(array.min { a, b in a.0 < b.0 })
// Prints Optional((23, "error2"))
```

`max(by:)`ï¼šåˆ©ç”¨ç»™å®šçš„æ–¹å¼æ¯”è¾ƒå…ƒç´ å¹¶è¿”å›æ•°ç»„ä¸­æœ€å¤§çš„å…ƒç´ ã€‚

```swift
var array = [(45, "error1"), (23, "error2"), (30, "error3")]
print(array.max { a, b in a.0 < b.0 })
// Prints Optional((45, "error1"))
```

### æ•°ç»„æ·»åŠ å’Œåˆ é™¤

#### åœ¨æœ«å°¾æ·»åŠ 

`append(_:)`ï¼šåœ¨æœ«å°¾æ·»åŠ ä¸€ä¸ªå…ƒç´ ã€‚

```swift
var numbers = [Int](2...7)
numbers.append(100)
print(numbers)
// Prints [2, 3, 4, 5, 6, 7, 100]
```

`append(contentsOf:)`ï¼šåœ¨æœ«å°¾æ·»åŠ å¤šä¸ªå…ƒç´ ã€‚

```swift
var numbers = [Int](2...7)
numbers.append(contentsOf: 100...105)
print(numbers)
// Prints [2, 3, 4, 5, 6, 7, 100, 101, 102, 103, 104, 105]
```

#### åœ¨ä»»æ„ä½ç½®æ’å…¥

`insert(_:at:)`ï¼šåœ¨æŒ‡å®šä½ç½®æ’å…¥ä¸€ä¸ªå…ƒç´ ã€‚

```swift
var numbers = [Int](2...7)
numbers.insert(-1, at: 0)
print(numbers)
// Prints [-1, 2, 3, 4, 5, 6, 7]
```

`insert(contentOf:at:)`ï¼šåœ¨æŒ‡å®šä½ç½®æ’å…¥å¤šä¸ªå…ƒç´ ã€‚

```swift
var numbers = [Int](2...7)
numbers.insert(contentsOf: -2...0, at: 0)
print(numbers)
// Prints [-2, -1, 0, 2, 3, 4, 5, 6, 7]
```

#### å­—ç¬¦ä¸²ä¹Ÿæ˜¯é›†åˆ

å­—ç¬¦ä¸²ä¹Ÿæ˜¯é›†åˆï¼ˆCollectionï¼‰ï¼ŒElementï¼ˆå…ƒç´ ï¼‰æ˜¯å­—ç¬¦ï¼ˆCharacterï¼‰ç±»å‹ã€‚

```swift
var chars: [Character] = ["a", "b", "c"]
chars.insert(contentsOf: "hello", at: 0)
print(chars)
// Prints ["h", "e", "l", "l", "o", "a", "b", "c"]
```

#### ç§»é™¤å•ä¸ªå…ƒç´ 

`remove(at:)`ï¼šç§»é™¤å¹¶è¿”å›æŒ‡å®šä½ç½®çš„ä¸€ä¸ªå…ƒç´ ã€‚

```swift
var chars: [Character] = ["a", "b", "c", "d"]
let removedChar = chars.remove(at: 1)
print(removedChar)
print(chars)
// b
// ["a", "c", "d"]
```

`removeFirst()`ï¼šç§»é™¤å¹¶è¿”å›æ•°ç»„çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚

```swift
var chars: [Character] = ["a", "b", "c", "d"]
let removedChar = chars.removeFirst()
print(removedChar)
print(chars)
// a
// ["b", "c", "d"]
```

`removeLast()`ï¼šç§»é™¤å¹¶è¿”å›æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ã€‚

```swift
var chars: [Character] = ["a", "b", "c", "d"]
let removedChar = chars.removeLast()
print(removedChar)
print(chars)
// d
// ["a", "b", "c"]
```

`popLast`ï¼šç§»é™¤å¹¶è¿”å›æ•°ç»„çš„æœ€åä¸€ä¸ªå…ƒç´ ï¼ˆ`Optional`ï¼‰ï¼Œå¦‚æœæ•°ç»„ä¸ºç©ºè¿”å›`nil`ã€‚

```swift
var chars: [Character] = ["a", "b", "c", "d"]
let removedChar = chars.popLast()
print(removedChar)
print(chars)
// Optional("d")
// ["a", "b", "c"]
```

```swift
var chars: [Character] = []
let removedChar = chars.popLast()
print(removedChar)
// Prints nil
```

#### ç§»é™¤å¤šä¸ªå…ƒç´ 

`removeFirst(:)`ï¼šç§»é™¤æ•°ç»„å‰é¢å¤šä¸ªå…ƒç´ ã€‚

```swift
var chars: [Character] = ["a", "b", "c", "d"]
chars.removeFirst(2)
print(chars)
// Prints ["c", "d"]
```

`removeLast(:)`ï¼šç§»é™¤æ•°ç»„åé¢å¤šä¸ªå…ƒç´ ã€‚

```swift
chars.removeLast(2)
print(chars)
// Prints ["a", "b"]
```

`removeSubrange(_:)`ï¼šç§»é™¤æ•°ç»„ä¸­ç»™å®šèŒƒå›´çš„å…ƒç´ ã€‚

```swift
chars.removeSubrange(1...2)
print(chars)
// Prints ["a", "d"]
```

`removeAll()`ï¼šç§»é™¤æ•°ç»„æ‰€æœ‰å…ƒç´ ï¼Œæ•°ç»„å®¹é‡ç½®ä¸º0ã€‚

```swift
chars.removeAll()
print(chars)
print(chars.capacity)
// []
// 0
```

`removeAll(keepingCapacity:)`ï¼šç§»é™¤æ•°ç»„æ‰€æœ‰å…ƒç´ ï¼Œä¿ç•™æ•°ç»„å®¹é‡ã€‚

```swift
chars.removeAll(keepingCapacity: true)
print(chars)
print(chars.capacity)
// []
// 4
```

### ArraySlice

ArraySlice æ˜¯æ•°ç»„æˆ–è€…å…¶å®ƒ ArraySlice çš„ä¸€æ®µè¿ç»­åˆ‡ç‰‡ï¼Œ**å’ŒåŸæ•°ç»„å…±äº«å†…å­˜**ã€‚å½“è¦æ”¹å˜ ArraySlice çš„æ—¶å€™ï¼ŒArraySlice ä¼š copy å‡ºæ¥ï¼Œå½¢æˆå•ç‹¬å†…å­˜ã€‚

ArraySlice æ‹¥æœ‰å’Œ Array åŸºæœ¬å®Œå…¨ç±»ä¼¼çš„æ–¹æ³•ã€‚

#### é€šè¿‡ Drop å¾—åˆ° ArraySlice

`dropFirst(:)`ï¼šâ€œç§»é™¤â€åŸæ•°ç»„å‰é¢æŒ‡å®šä¸ªæ•°çš„å…ƒç´ **å¾—åˆ°ä¸€ä¸ª ArraySlice**ã€‚

ç§»é™¤å‰é¢æŒ‡å®šä¸ªæ•°çš„å…ƒç´ ï¼Œæ¯æ¬¡æ“ä½œå¾—åˆ°ä¸€ä¸ªæ–°çš„ ArraySliceï¼š

```swift
let array = [5, 2, 10, 1, 0, 100, 46, 99]  // [5, 2, 10, 1, 0, 100, 46, 99]
array.dropFirst()                          // [2, 10, 1, 0, 100, 46, 99]
array.dropFirst(3)                         // [1, 0, 100, 46, 99]
```

ç§»é™¤åé¢æŒ‡å®šä¸ªæ•°çš„å…ƒç´ ï¼Œæ¯æ¬¡æ“ä½œå¾—åˆ°ä¸€ä¸ªæ–°çš„ ArraySliceï¼š

```swift
let array = [5, 2, 10, 1, 0, 100, 46, 99]  // [5, 2, 10, 1, 0, 100, 46, 99]
array.dropLast()                           // [5, 2, 10, 1, 0, 100, 46]
array.dropLast(3)                          // [5, 2, 10, 1, 0]
```

#### é€šè¿‡ prefix å¾—åˆ° ArraySlice

`prefix()`ï¼šè·å–æ•°ç»„å‰é¢æŒ‡å®šä¸ªæ•°çš„å…ƒç´ ç»„æˆ ArraySliceã€‚

```swift
let array = [5, 2, 10, 1, 0, 100, 46, 99]  // [5, 2, 10, 1, 0, 100, 46, 99]
array.prefix(4)                            // [5, 2, 10, 1]
```

`prefix(upTo:)`ï¼šè·å–æ•°ç»„åˆ°æŒ‡å®šä½ç½®ï¼ˆä¸åŒ…å«æŒ‡å®šä½ç½®ï¼‰å‰é¢çš„å…ƒç´ ç»„æˆ ArraySliceã€‚

```swift
let array = [5, 2, 10, 1, 0, 100, 46, 99]  // [5, 2, 10, 1, 0, 100, 46, 99]
array.prefix(upTo: 4)                      // [5, 2, 10, 1]
```

`prefix(through:)`ï¼šè·å–æ•°ç»„åˆ°æŒ‡å®šä½ç½®ï¼ˆåŒ…å«æŒ‡å®šä½ç½®ï¼‰å‰é¢çš„å…ƒç´ ç»„æˆ ArraySliceã€‚

```swift
let array = [5, 2, 10, 1, 0, 100, 46, 99]  // [5, 2, 10, 1, 0, 100, 46, 99]
array.prefix(through: 4)                   // [5, 2, 10, 1, 0]
```

`prefix(while:)`ï¼šè·å–æ•°ç»„å‰é¢ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼ˆåˆ°ç¬¬ä¸€ä¸ªä¸ç¬¦åˆæ¡ä»¶çš„å…ƒç´ æˆªæ­¢ï¼‰ç»„æˆçš„ ArraySliceã€‚

```swift
let array = [5, 2, 10, 1, 0, 100, 46, 99]  // [5, 2, 10, 1, 0, 100, 46, 99]
array.prefix(while: { $0 < 10 })           // [5, 2]
array.prefix { $0 < 10 }                   // [5, 2]
```

#### é€šè¿‡ suffix å¾—åˆ° ArraySlice

`suffix()`ï¼šè·å–æ•°ç»„åé¢æŒ‡å®šä¸ªæ•°çš„å…ƒç´ ç»„æˆçš„ ArraySliceã€‚

```swift
let array = [5, 2, 10, 1, 0, 100, 46, 99]
array.suffix(3)  // [100, 46, 99]
```

`suffix(from:)`ï¼šè·å–æ•°ç»„ä»æŒ‡å®šä½ç½®åˆ°ç»“å°¾ï¼ˆåŒ…å«æŒ‡å®šä½ç½®ï¼‰çš„å…ƒç´ ç»„æˆçš„ ArraySliceã€‚

```swift
let array = [5, 2, 10, 1, 0, 100, 46, 99]
array.suffix(from: 5)  // [100, 46, 99]
```

#### é€šè¿‡ Range å¾—åˆ° ArraySlice

å¯ä»¥é€šè¿‡å¯¹æ•°ç»„ä¸‹æ ‡æŒ‡å®š Range è·å– ArraySliceï¼Œå¯ä»¥ä½¿ç”¨é—­åŒºé—´ã€åŠå¼€åŠé—­åŒºé—´ã€å•ä¾§åŒºé—´æˆªå–æ•°ç»„è·å¾— ArraySliceï¼Œä¹Ÿå¯ä»¥ç”¨`...`æ¥è·å–æ•´ä¸ªæ•°ç»„ç»„æˆçš„ ArraySliceã€‚

```swift
let array = [5, 2, 10, 1, 0, 100, 46, 99]  // [5, 2, 10, 1, 0, 100, 46, 99]
array[...2]                                // [5, 2, 10]
array[..<2]                                // [5, 2]
array[3...5]                               // [1, 0, 100]
array[3..<5]                               // [1, 0]
array[6...]                                // [46, 99]
array[...]                                 // [5, 2, 10, 1, 0, 100, 46, 99]
```

#### ArraySlice è½¬ä¸º Array

ArraySlice æ— æ³•ç›´æ¥å¤åˆ¶ç»™ä¸€ä¸ª Array çš„å¸¸é‡æˆ–å˜é‡ï¼Œéœ€è¦ä½¿ç”¨ `Array(slice)` æ–¹æ³•è½¬æˆ Array ç±»å‹ã€‚

```swift
var array = [5, 2, 10, 1, 0, 100, 46, 99]  // [5, 2, 10, 1, 0, 100, 46, 99]
let slice = array[3...5]                   // [1, 0, 100]
array = Array(slice)                       // [1, 0, 100]
```

![04](é›†åˆç±»/04.png)

#### ArraySlice å’ŒåŸ Array ç›¸äº’ç‹¬ç«‹

`ArraySlice` å’ŒåŸ `Array` æ˜¯ç›¸äº’ç‹¬ç«‹çš„ï¼Œå®ƒä»¬æ·»åŠ åˆ é™¤å…ƒç´ ä¸ä¼šå½±å“å¯¹æ–¹ã€‚

```swift
var array = [10, 46, 99]      // [10, 46, 99]
var slice = array.dropLast()  // [10, 46]

array.append(333)             // [10, 46, 99, 333]
slice.append(555)             // [10, 46, 555]
```

### é‡æ’æ“ä½œ

#### æ•°ç»„å…ƒç´ çš„éšæœºåŒ–

`shuffle()`ï¼šåœ¨åŸæ•°ç»„ä¸Šå°†æ•°ç»„å…ƒç´ æ‰“ä¹±ï¼Œåªèƒ½ä½œç”¨åœ¨æ•°ç»„**å˜é‡**ä¸Šã€‚

```swift
var array = [Int](1...8)  // [1, 2, 3, 4, 5, 6, 7, 8]
array.shuffle()           // [8, 2, 3, 5, 6, 1, 7, 4]
```

`shuffled()`ï¼šè¿”å›åŸæ•°ç»„çš„éšæœºåŒ–**æ•°ç»„**ï¼Œå¯ä»¥ä½œç”¨åœ¨æ•°ç»„**å˜é‡å’Œå¸¸é‡**ä¸Šã€‚

```swift
let array = [Int](1...8)       // [1, 2, 3, 4, 5, 6, 7, 8]
var array2 = array.shuffled()  // [4, 8, 1, 7, 3, 2, 6, 5]
```

#### æ•°ç»„çš„é€†åº

`reverse()`ï¼šåœ¨åŸæ•°ç»„ä¸Šå°†æ•°ç»„é€†åºï¼Œåªèƒ½ä½œç”¨åœ¨æ•°ç»„**å˜é‡**ä¸Šã€‚

```swift
var array = [Int](1...8)  // [1, 2, 3, 4, 5, 6, 7, 8]
array.reverse()           // [8, 7, 6, 5, 4, 3, 2, 1]
```

`reversed()`ï¼šè¿”å›åŸæ•°ç»„çš„é€†åºâ€œ**é›†åˆè¡¨ç¤º**â€ï¼Œå¯ä»¥ä½œç”¨åœ¨æ•°ç»„å˜é‡å’Œå¸¸é‡ä¸Šï¼Œè¯¥æ–¹æ³•**ä¸ä¼šåˆ†é…æ–°å†…å­˜ç©ºé—´**ã€‚

```swift
let array1 = [Int](1...8)       // [1, 2, 3, 4, 5, 6, 7, 8]
var array2 = array1.reversed()  // ReversedCollection<Array<Int>>
print(array2)                   // ReversedCollection<Array<Int>>(_base: [1, 2, 3, 4, 5, 6, 7, 8])
```

#### æ•°ç»„çš„åˆ†ç»„

`partition(by belongsInSecondPartition: (Element) throws -> Bool) rethrows -> Int`ï¼šå°†æ•°ç»„ä»¥æŸä¸ªæ¡ä»¶åˆ†ç»„ï¼Œæ•°ç»„å‰åŠéƒ¨åˆ†éƒ½æ˜¯ä¸ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ï¼Œæ•°ç»„ååŠéƒ¨åˆ†éƒ½æ˜¯ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]         // [10, 20, 45, 30, 98, 101, 30, 4]
let index = array.partition { (element) -> Bool in   // 5
    element > 30
}
let partition1 = array[..<index]                     // [10, 20, 4, 30, 30]
let partition2 = array[index...]                     // [101, 98, 45]
```

#### æ•°ç»„çš„æ’åº

`sort`ï¼šåœ¨åŸæ•°ç»„ä¸Šå°†å…ƒç´ æ’åºï¼Œåªèƒ½ä½œç”¨äºæ•°ç»„**å˜é‡**ã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]  // [10, 20, 45, 30, 98, 101, 30, 4]
array.sort()                                  // [4, 10, 20, 30, 30, 45, 98, 101] 
```

`sorted()`ï¼šè¿”å›åŸæ•°ç»„çš„æ’åºç»“æœ**æ•°ç»„**ï¼Œå¯ä»¥ä½œç”¨åœ¨æ•°ç»„**å˜é‡å’Œå¸¸é‡**ä¸Šã€‚

```swift
let array = [10, 20, 45, 30, 98, 101, 30, 4]
let array2 = array.sorted()
```

#### äº¤æ¢æ•°ç»„ä¸¤ä¸ªå…ƒç´ 

`swapAt(_ i: Int, _ j: Int)`ï¼šäº¤æ¢æŒ‡å®šä½ç½®çš„ä¸¤ä¸ªå…ƒç´ ã€‚

```swift
var array = [10, 20, 45, 30, 98, 101, 30, 4]        // [10, 20, 45, 30, 98, 101, 30, 4]
array.swapAt(array.startIndex, array.endIndex - 1)  // [4, 20, 45, 30, 98, 101, 30, 10]
```

### æ‹¼æ¥æ“ä½œ

#### å­—ç¬¦ä¸²æ•°ç»„æ‹¼æ¥

`joined()`ï¼šæ‹¼æ¥å­—ç¬¦ä¸²æ•°ç»„é‡Œçš„æ‰€æœ‰å…ƒç´ ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚

```swift
var array = ["hello", "world"]        // ["hello", "world"]
print(array.joined())                 // "helloworld\n"
```

`joined(separator)`ï¼šä»¥ç»™å®šçš„åˆ†éš”ç¬¦æ‹¼æ¥å­—ç¬¦ä¸²æ•°ç»„é‡Œçš„æ‰€æœ‰å…ƒç´ ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚

```swift
var array = ["hello", "world"]        // ["hello", "world"]
print(array.joined(separator: ", "))  // "hello, world\n"
```

#### å…ƒç´ ä¸º Sequence æ•°ç»„çš„æ‹¼æ¥

`joined()`ï¼šæ‹¼æ¥æ•°ç»„é‡Œçš„æ‰€æœ‰å…ƒç´ ä¸ºä¸€ä¸ªæ›´å¤§çš„ Sequenceã€‚

```swift
let ranges = [0..<3, 8..<10, 15..<17]  // [{lowerBound 0, upperBound 3}, {lowerBound 8, upperBound 10}, {lowerBound 15, upperBound 17}]
for range in ranges {
    print(range)
}

print("")
for i in ranges.joined() {
    print(i)
}
```

æ‰“å°ç»“æœï¼š

```js
0..<3
8..<10
15..<17

0
1
2
8
9
15
16
```

`joined(separator:)`ï¼šä»¥ç»™å®šçš„åˆ†éš”ç¬¦æ‹¼æ¥æ•°ç»„é‡Œçš„æ‰€æœ‰å…ƒç´ ä¸ºä¸€ä¸ªæ›´å¤§çš„Sequenceã€‚

```swift
let nestedNumbers = [[1, 2, 3], [4, 5, 6], [7, 8, 9]]
let joined = nestedNumbers.joined(separator: [-1, -2])
print(Array(joined))  // "[1, 2, 3, -1, -2, 4, 5, 6, -1, -2, 7, 8, 9]\n"
```

### æ¢ç§˜æ•°ç»„

é˜…è¯»æºç ï¼š

1. å…ˆçœ‹é¡¶å±‚è®¾è®¡ï¼Œå†çœ‹åº•å±‚æºç æ˜¯æ€ä¹ˆç¬¦åˆé¡¶å±‚è®¾è®¡çš„ã€‚
2. ä»å…³é”®çš„è°ƒç”¨é“¾å¼€å§‹ï¼Œæ‰¾åˆ°å…³é”®æ–¹æ³•ï¼Œå†çœ‹å…³é”®æ–¹æ³•åº•å±‚åˆè°ƒç”¨åˆ°äº†å“ªäº›æ–¹æ³•ã€‚

#### æ•°ç»„çš„åè®®ç»“æ„

![05](é›†åˆç±»/05.png)

#### é¡¶å±‚è®¾è®¡

##### Sequence

ä¸€ä¸ªåºåˆ—ï¼ˆsequenceï¼‰ä»£è¡¨çš„æ˜¯ä¸€ç³»åˆ—å…·æœ‰ç›¸åŒç±»å‹çš„å€¼ï¼Œå¯ä»¥å¯¹è¿™äº›å€¼è¿›è¡Œè¿­ä»£ã€‚

![06](é›†åˆç±»/06.png)

##### IteratorProtocol

è¿­ä»£å™¨ï¼šSequence é€šè¿‡åˆ›å»ºä¸€ä¸ªè¿­ä»£å™¨æ¥æä¾›å¯¹å…ƒç´ çš„è®¿é—®ã€‚è¿­ä»£å™¨æ¯æ¬¡äº§ç”Ÿä¸€ä¸ªåºåˆ—çš„å€¼ï¼Œå¹¶ä¸”å½“éå†åºåˆ—æ—¶å¯¹éå†çŠ¶æ€è¿›è¡Œç®¡ç†ã€‚

å¦‚ï¼š

```swift
protocol IteratorProtocol {
    associatedtype Element
    mutating func next() -> Element?
}
```

`next()` è¿”å›åºåˆ—çš„ä¸‹ä¸€ä¸ªå…ƒç´ ã€‚å½“åºåˆ—è¢«è€—å°½æ—¶ï¼Œ`next()` åº”è¯¥è¿”å› nilã€‚

##### å®šä¹‰è‡ªå·±çš„ Sequence

å®ç°æ–æ³¢é‚£å¥‘æ•°åˆ—ï¼š

```swift
struct FibsIterator: IteratorProtocol {
    let number: Int
    var index: Int = 0
    
    init(_ number: Int) {
        self.number = number
    }
    
    var state = (0, 1)
    mutating func next() -> Int? {
        if index >= number {
            return nil
        }
        index += 1
        
        let fibNumber = state.0
        // åä¸€ä¸ªæ•°ç­‰äºå‰ä¸¤ä¸ªæ•°ä¹‹å’Œ
        state = (state.1, state.0 + state.1)
        return fibNumber
    }
    typealias Element = Int
}

struct FibsSequence: Sequence {
    let number: Int
    init(_ number: Int) {
        self.number = number
    }
    typealias Iterator = FibsIterator
    func makeIterator() -> FibsSequence.Iterator {
        return FibsIterator(number)
    }
}

let fibs = FibsSequence(10)

for fib in fibs {
    print(fib)
}
```

æ‰“å°ç»“æœï¼š

```swift
0
1
1
2
3
5
8
13
21
34
```

`IteratorProtocol` æ˜¯è¿­ä»£å™¨åè®®ï¼Œç»§æ‰¿åè®®åŒæ—¶å®ç°åè®®è¦æ±‚çš„æ–¹æ³•ï¼Œå°±æ‹¥æœ‰äº†è¿­ä»£å™¨çš„èƒ½åŠ›ã€‚`Sequence` æ˜¯åºåˆ—åè®®ï¼Œç»§æ‰¿åè®®åŒæ—¶å®ç°åè®®è¦æ±‚çš„æ–¹æ³•ï¼Œå°±æ‹¥æœ‰äº†åºåˆ—çš„èƒ½åŠ›ã€‚

`mutating` è¡¨ç¤ºæ–¹æ³•å†…éƒ¨å¯ä»¥å¯¹å…¨å±€å˜é‡è¿›è¡Œä¿®æ”¹ã€‚

##### Collection

ä¸€ä¸ªé›†åˆï¼ˆCollectionï¼‰æ˜¯æ»¡è¶³ä¸‹é¢æ¡ä»¶çš„åºåˆ—ï¼ˆSequenceï¼‰ï¼š

1. ç¨³å®šçš„ Sequenceï¼Œ èƒ½å¤Ÿè¢«å¤šæ¬¡éå†ä¸”ä¿æŒä¸€è‡´ï¼›
2. é™¤äº†çº¿æ€§éå†ä»¥å¤–ï¼Œé›†åˆä¸­çš„å…ƒç´ ä¹Ÿå¯ä»¥é€šè¿‡ä¸‹æ ‡ç´¢å¼•çš„æ–¹å¼è¢«è·å–åˆ°ï¼›
3. å’Œ Sequence ä¸åŒï¼ŒCollection ç±»å‹ä¸èƒ½æ˜¯æ— é™çš„ã€‚

![07](é›†åˆç±»/07.png)

#### Array æºç 

Array çš„æœ¬è´¨æ˜¯ä¸€ä¸ª Sequenceã€‚

Array çš„è¿­ä»£å™¨å®ç°åŸºäºæ•°ç»„çš„ä¸‹æ ‡æ“ä½œï¼Œæ•°ç»„çš„å°æ ‡æ“ä½œåŸºäº `buffer.getElement()` æ–¹æ³•ï¼Œ`buffer.getElement()` æ–¹æ³•åŸºäº `UnsafeMutablePointer` çš„å°æ ‡æ“ä½œã€‚

#### Array çš„è¿­ä»£å™¨

å·¦ä¾§æ˜¯ Array çš„è¿­ä»£å™¨çš„åº•å±‚å®ç°ã€‚`next()` æ–¹æ³•è´Ÿè´£è¿”å›æ•°ç»„çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œè¶…å‡ºæ•°ç»„å®¹é‡åˆ™è¿”å›ç©ºã€‚è·å–æ•°ç»„å†…éƒ¨å…ƒç´ çš„æ–¹å¼æ˜¯**ä¸‹æ ‡è®¿é—®**ã€‚

å³ä¾§æ˜¯ Array çš„è¿­ä»£å™¨çš„åˆ›å»ºã€‚è°ƒç”¨ `IndexingItetator` ä¼ å…¥çš„æ˜¯ `self`ï¼Œä¹Ÿå°±æ˜¯è¯´å·¦é¢çš„ element æ˜¯å³é¢ä¼ å…¥çš„ Collectionã€‚

![09](é›†åˆç±»/09.png)

#### Array çš„ä¸‹æ ‡è®¿é—®

ä¸‹å›¾æ˜¯ä¸‹æ ‡è®¿é—®çš„ä»£ç å®ç°ï¼Œæ ¸å¿ƒæ–¹æ³•æ˜¯ `_getElement()` æ–¹æ³•ã€‚ä¸‹æ ‡æ–¹æ³•çš„è°ƒç”¨é“¾æ˜¯ `subscrip(index:)`â†’`_getElement()`â†’`_buffer.getElement()`ã€‚

![10](é›†åˆç±»/10.png)

#### Array çš„ buffer

`_Buffer` çš„å®ç°åŒºåˆ† Objc å’Œ Swift ä¸¤ä¸ªç‰ˆæœ¬ï¼ŒSwift ç‰ˆæœ¬æ˜¯ `_ContiguousArrayBuffer`ã€‚

![11](é›†åˆç±»/11.png)

`storageAddr` æ˜¯é€šè¿‡ `UnsafeMutablePointer` æ–¹æ³•ç”Ÿæˆçš„ä¸€ä¸ªåœ°å€ï¼Œåç»­ä¼šå¯¹`_storageAddr`è¿›è¡ŒåŠ æ³•æ“ä½œã€‚

##### _ContiguousArrayBuffer

![12](é›†åˆç±»/12.png)

`_ContiguousArrayBuffer` ä¸­ `getElement()` æ–¹æ³•çš„å®ç°ï¼š

1. é¦–å…ˆåˆ¤æ–­äº†æ˜¯å¦è¶Šç•Œï¼›
2. é€šè¿‡ä¸‹è¡¨è®¿é—®ï¼Œè¿”å› `firstElementAddress[i]` ä¸­ç¬¬ `i` ä¸ªå…ƒç´ ã€‚`firstElementAddress` æ–¹æ³•ä¸­æ˜¯åŸºäº c/c++ çš„æŒ‡é’ˆæ“ä½œã€‚

##### _ContiguousArrayBuffer çš„ getElement

![13](é›†åˆç±»/13.png)

##### UnsafeMutablePointer çš„ä¸‹æ ‡æ“ä½œ

`UnsafeMutablePointer` æ˜¯ Array çš„è¿­ä»£å™¨å®ç°ä¸­çœŸæ­£çš„æŒ‡é’ˆæ“ä½œå®ç°ï¼ŒåŸºäº c/c++ å®ç°ã€‚

![14](é›†åˆç±»/14.png)

è‡³æ­¤ï¼Œæ•°ç»„è¿­ä»£å™¨çš„åº•å±‚ä»£ç å®ç°å·²ç»å®Œæˆã€‚æ•°ç»„çš„ `Iterator` å®é™…ä¸Šæ˜¯ `IndexingIterator`ã€‚å› ä¸º `IndexingIterator` æ–¹æ³•ä¼ å…¥çš„å‚æ•°æ˜¯ selfï¼Œæ‰€ä»¥ `next()` æ–¹æ³•å®é™…æ˜¯å¯¹ selfï¼ˆæ•°ç»„ï¼‰çš„ä¸‹æ ‡è¿›è¡Œæ“ä½œã€‚è€Œæ•°ç»„çš„ä¸‹æ ‡æ“ä½œåˆä¼šè½¬åŒ–æˆ ArrayBuffer çš„ä¸‹æ ‡æ“ä½œã€‚

åœ¨é˜…è¯»æ•°ç»„æºç çš„è¿‡ç¨‹ä¸­ï¼Œä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªæ­¥éª¤ï¼š

1. å…ˆçœ‹é¡¶å±‚è®¾è®¡ï¼ŒåŒ…æ‹¬ Sequenceã€IteratorProtocolã€Collectionã€‚
2. ä»å…³é”®çš„è°ƒç”¨é“¾å¼€å§‹ï¼Œä» Iterator çš„ `next()` æ–¹æ³•åˆ‡å…¥ã€‚ `subscrip(index:)`â†’`_getElement()`â†’`_buffer.getElement()`ã€‚

#### é—®é¢˜ï¼šendIndex vs count

* endIdex æ˜¯ Self.index ç±»å‹ã€‚
* count æ˜¯ Int ç±»å‹ã€‚

![15](é›†åˆç±»/15.png)

##### æ¢ç´¢-ç´¢å¼•

å®˜æ–¹æ–‡æ¡£æŒ‡å‡ºï¼Œæ‰€æœ‰å®ç° Collection åè®®ç±»ï¼Œå¿…é¡»æä¾› startIndex å’Œ endIndex ä¸¤ä¸ªå±æ€§ï¼Œå¹¶ä¸”è¯»å–è¿™ä¸¤ä¸ªå±æ€§çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1) çš„ã€‚å› ä¸ºåœ¨è¯»å–ä¸€ä¸ªå‰å‘æˆ–åŒå‘çš„ Collection çš„ count å±æ€§æ—¶ï¼Œéœ€è¦éå†æ•´ä¸ª Collection çš„æ‰€æœ‰å…ƒç´ ï¼Œæ‰€ä»¥å…¶å¤æ‚åº¦æ˜¯ O(n) çš„ã€‚

å³ï¼š

å¯¹äºä¸€ä¸ªéšæœºå­˜å‚¨çš„æ•°ç»„ï¼Œè·å– count çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(1) çš„ã€‚

å¯¹äºä¸€ä¸ªé“¾è¡¨å®ç°çš„æ•°ç»„ï¼Œè·å– count çš„æ—¶é—´å¤æ‚åº¦æ˜¯ O(n) çš„ï¼ŒstartIndex å’Œ endIndex å±æ€§è·å–æ˜¯ O(1) çš„ã€‚åœ¨éå†ä¸€ä¸ªé“¾è¡¨æ•°ç»„æ—¶ï¼Œå¦‚æœä½¿ç”¨ startIndex æˆ– endIndex éå†ï¼Œä¼šæ¯”ä½¿ç”¨ count éå†æ›´åŠ ä¾¿æ·ã€‚

![16](é›†åˆç±»/16.png)

å·¦ä¾§æ˜¯ String çš„ endIndex å’Œ count çš„å®ç°ã€‚endIndex è¿”å›çš„æ˜¯ _guits.endIndex()ï¼Œæ˜¯ O(1) å¤æ‚åº¦çš„ã€‚count è¿”å›çš„æ˜¯ä» startIndex åˆ° endIndex çš„è®¡ç®—ç»“æœï¼Œå¤æ‚åº¦æ˜¯é O(1) çš„ã€‚

å³ä¾§æ˜¯ Array çš„ endIndex å’Œ count çš„å®ç°ã€‚ä¸¤è€…çš„å®ç°æ˜¯ä¸€æ ·çš„ã€‚

![17](é›†åˆç±»/17.png)

##### æ¢ç´¢

* é˜…è¯» `removeFirst` æ–¹æ³•çš„æºç ï¼Œå¾—å‡º `removeFirst` çš„å¤æ‚åº¦ã€‚

* é˜…è¯» `sort` æ–¹æ³•çš„æºç ï¼Œäº†è§£ Array çš„æ’åºæ–¹æ³•ã€‚

#### å®ç°æ ˆå’Œé˜Ÿåˆ—

#### Stack

æ ˆï¼ˆStackï¼‰æ˜¯ä¸€ç§ **åå…¥å…ˆå‡ºï¼ˆLast in First Outï¼‰** çš„æ•°æ®ç»“æ„ï¼Œä»…é™å®šåœ¨æ ˆé¡¶è¿›è¡Œæ’å…¥æˆ–è€…åˆ é™¤æ“ä½œã€‚æ ˆç»“æ„çš„å®ç°åº”ç”¨ä¸»è¦æœ‰æ•°åˆ¶è½¬æ¢ã€æ‹¬å·åŒ¹é…ã€è¡¨è¾¾å¼æ±‚å€¼ç­‰ç­‰ã€‚

![18](é›†åˆç±»/18.png)

```swift
struct Stack <T> {
    private var elements = [T]()
    
    var count: Int {
        return elements.count
    }
    
    var isEmpty: Bool {
        return elements.isEmpty
    }
    
    var peek: T? {
        return elements.last
    }
    
    mutating func push(_ element: T) {
        elements.append(element)
    }
    
    mutating func pop() -> T? {
        return elements.popLast()
    }
}

var stack = Stack<Int>()
stack.push(1)
stack.push(3)
stack.push(8)
print(stack.pop() ?? 0)  // "8"
print(stack.count)       // "2"
```

#### Queue

é˜Ÿåˆ—åœ¨ç”Ÿæ´»ä¸­éå¸¸å¸¸è§ã€‚æ’é˜Ÿç­‰ä½åƒé¥­ã€åœ¨ç«è½¦ç«™å–ç¥¨ã€é€šè¿‡é«˜é€Ÿè·¯å£ç­‰ï¼Œè¿™äº›ç”Ÿæ´»ä¸­çš„ç°è±¡å¾ˆå¥½çš„æè¿°äº†é˜Ÿåˆ—çš„ç‰¹ç‚¹ï¼šå…ˆè¿›å…ˆå‡ºï¼ˆFIFOï¼Œfirst in first outï¼‰ï¼Œæ’åœ¨æœ€å‰é¢çš„å…ˆå‡ºæ¥ï¼Œåé¢æ¥çš„åªèƒ½æ’åœ¨æœ€åé¢ã€‚

![19](é›†åˆç±»/19.png)

```swift
struct Queue<T> {
    private var elements : [T] = []
    
    var count: Int {
        return elements.count
    }
    
    var isEmpty: Bool {
        return elements.isEmpty
    }
    
    var peek: T? {
        return elements.first
    }
    
    mutating func enqueue(_ element: T) {
        elements.append(element)
    }
    
    mutating func dequeue() -> T? {
        return isEmpty ? nil : elements.removeFirst();
    }
}

var queue = Queue<Int>()
queue.enqueue(1)
queue.enqueue(3)
queue.enqueue(8)
print(queue.dequeue() ?? 0)  // "1"
print(queue.count)           // "2"
```

#### ç»ƒä¹ 

å°è¯•æ”¹é€  Stack å’Œ Queue çš„ä»£ç è®©å®ç° Sequence åè®®ï¼Œæ”¯æŒ For-in å¾ªç¯ã€‚

```swift
struct QueueIterator<T>: IteratorProtocol {
    let elements: [T]
    var index: Int = 0
    
    init(_ elements: [T]) {
        self.elements = elements
    }
    
    mutating func next() -> T? {
        if index >= elements.count {
            return nil
        }
        let element: T = elements[index];
        index += 1
        return element
    }
    
    typealias Element = T
}

struct Queue<T> : Sequence {
    private var elements : [T] = []
        
    var count: Int {
        return elements.count
    }
    
    var isEmpty: Bool {
        return elements.isEmpty
    }
    
    var peek: T? {
        return elements.first
    }
    
    mutating func enqueue(_ element: T) {
        elements.append(element)
    }
    
    mutating func dequeue() -> T? {
        return isEmpty ? nil : elements.removeFirst();
    }
    
    typealias Iterator = QueueIterator
    func makeIterator() -> Queue.Iterator<T> {
        return QueueIterator(elements)
    }
}

var queue = Queue<Int>()
queue.enqueue(1)
queue.enqueue(3)
queue.enqueue(8)

for element in queue {
    print(element)
}
```

æ‰“å°ç»“æœï¼š

```js
1
3
8
```

æ€»ç»“ï¼šå®ç° Sequence åè®®ï¼Œéœ€è¦å®ç° Sequence åˆ›å»ºè¿­ä»£å™¨çš„æ–¹æ³• `makeIterator()`ï¼Œè¿­ä»£å™¨åˆ™è´Ÿè´£å®ç° `next()` æ–¹æ³•åºåˆ—çš„ä¸‹ä¸€ä¸ªå…ƒç´ ï¼Œä»è€Œå®ç°å¯¹åºåˆ—çš„éå†ã€‚

## Set

Setï¼ˆé›†åˆï¼‰æ˜¯æŒ‡å…·æœ‰æŸç§ç‰¹å®šæ€§è´¨çš„å…·ä½“çš„æˆ–æŠ½è±¡çš„å¯¹è±¡æ±‡æ€»è€Œæˆçš„é›†ä½“ã€‚å…¶ä¸­ï¼Œæ„æˆ Set çš„è¿™äº›å¯¹è±¡åˆ™ç§°ä¸ºè¯¥ Set çš„å…ƒç´ ã€‚

é›†åˆçš„ä¸‰ä¸ªç‰¹æ€§

1. ç¡®å®šæ€§ï¼šç»™å®šä¸€ä¸ªé›†åˆï¼Œä»»ç»™ä¸€ä¸ªå…ƒç´ ï¼Œè¯¥å…ƒç´ æˆ–è€…å±äºæˆ–è€…ä¸å±äºè¯¥é›†åˆï¼ŒäºŒè€…å¿…å±…å…¶ä¸€ã€‚
2. äº’æ–¥æ€§ï¼šä¸€ä¸ªé›†åˆä¸­ï¼Œä»»ä½•ä¸¤ä¸ªå…ƒç´ éƒ½è®¤ä¸ºæ˜¯ä¸ç›¸åŒçš„ï¼Œå³**æ¯ä¸ªå…ƒç´ åªå‡ºç°ä¸€æ¬¡**ã€‚
3. æ— åºæ€§ï¼šä¸€ä¸ªé›†åˆä¸­ï¼Œæ¯ä¸ªå…ƒç´ çš„åœ°ä½éƒ½æ˜¯ç›¸åŒçš„ï¼Œ**å…ƒç´ ä¹‹é—´æ˜¯æ— åºçš„**ã€‚

Swift çš„é›†åˆç±»å‹å†™åš `Set<Element>`ï¼Œè¿™é‡Œçš„ Element æ˜¯ Set è¦å‚¨å­˜çš„ç±»å‹ã€‚ä¸åŒäºæ•°ç»„ï¼Œé›†åˆæ²¡æœ‰ç­‰ä»·çš„ç®€å†™ã€‚

### åˆ›å»º Set

1ã€ä½¿ç”¨**åˆå§‹åŒ–å™¨**è¯­æ³•æ¥åˆ›å»ºä¸€ä¸ªç¡®å®šç±»å‹çš„ç©º Setï¼š

```swift
var letters = Set<Character>()
letters.insert("c")
print(letters)
```

2ã€ä½¿ç”¨**æ•°ç»„å­—é¢é‡**åˆ›å»º Setï¼š

```swift
var course: Set<String> = ["Math", "English", "History"]
course.insert("History")
print(course)
```

### Set ç±»å‹çš„å“ˆå¸Œå€¼

ä¸ºäº†èƒ½è®©ç±»å‹å‚¨å­˜åœ¨ Set ä¸­ï¼Œå®ƒå¿…é¡»æ˜¯å¯å“ˆå¸Œçš„â€”â€”å°±æ˜¯è¯´ç±»å‹å¿…é¡»æä¾›è®¡ç®—å®ƒè‡ªèº«å“ˆå¸Œå€¼çš„æ–¹æ³•ã€‚

æ‰€æœ‰ Swift çš„åŸºç¡€ç±»å‹ï¼Œæ¯”å¦‚ `String`ï¼Œ`Int`ï¼Œ`Double` å’Œ `Bool` é»˜è®¤éƒ½æ˜¯å¯å“ˆå¸Œçš„ï¼Œå¹¶ä¸”å¯ä»¥ç”¨äº Set æˆ–è€… DIctionary çš„é”®ã€‚

æŠ¥é”™ä¿¡æ¯ï¼šPerson æ²¡æœ‰å®ç° Hashable åè®®ã€‚

![20](é›†åˆç±»/20.png)

è®© Person å®ç° Hashable åè®®ï¼š

```swift
struct Person {
    var name: String
    var age: Int
}

extension Person: Hashable {
    func hash(into hasher: inout Hasher) {
        hasher.combine(name)
        hasher.combine(age)
    }
}

var PersonSet = Set<Person>()
PersonSet.insert(Person(name: "zhangsan", age: 28))
// Prints '[__lldb_expr_28.Person(name: "zhangsan", age: 28)]'
```

### è®¿é—®å’Œä¿®æ”¹ Set

#### éå† Set

å¯ä»¥ä½¿ç”¨ `For-In` éå† Setã€‚

```swift
let courses: Set = ["Math", "English", "History"]
for course in courses {
    print(course)
}
```

æ‰“å°ç»“æœï¼š

```js
History
Math
English
```

å› ä¸º Set æ˜¯æ— åºçš„ï¼Œå¦‚æœéœ€è¦é¡ºåºéå† Setï¼Œå¯ä»¥ä½¿ç”¨ `sorted()` æ–¹æ³•è¿›è¡Œæ’åºã€‚

```swift
for course in courses.sorted() {
    print(course)
}
```

æ‰“å°ç»“æœï¼š

```js
English
History
Math
```

#### è®¿é—® Set

ä½¿ç”¨ `count` è·å– Set é‡Œå…ƒç´ ä¸ªæ•°ã€‚

```swift
let set: Set<Character> = ["A", "B", "C"]
print(set.count)
//Prints '3'
```

ä½¿ç”¨ `isEmpty` åˆ¤æ–­ Set æ˜¯å¦ä¸ºç©ºã€‚

```swift
let set: Set<Character> = ["A", "B", "C"]
print(set.isEmpty)
// 'false'
```

#### æ·»åŠ å…ƒç´ 

`insert(_:)`ï¼šæ·»åŠ ä¸€ä¸ªå…ƒç´ åˆ° Setã€‚

```swift
struct Person {
    var name: String
    var age: Int
}

extension Person: Hashable {
    func hash(into hasher: inout Hasher) {
        hasher.combine(name)
        hasher.combine(age)
    }
}

var personSet = Set<Person>()
personSet.insert(Person(name: "zhangsan", age: 28))  // '[__lldb_expr_28.Person(name: "zhangsan", age: 28)]'
```

`update(with:)`ï¼šå¦‚æœå·²ç»æœ‰ç›¸ç­‰çš„å…ƒç´ ï¼Œæ›¿æ¢ä¸ºæ–°å…ƒç´ ã€‚å¦‚æœ Set ä¸­æ²¡æœ‰ï¼Œåˆ™æ’å…¥ã€‚

```swift
struct Person {
    var name: String
    var age: Int
}

extension Person: Hashable {
    func hash(into hasher: inout Hasher) {
        hasher.combine(name)
        hasher.combine(age)
    }
}

extension Person: Equatable {
    static func == (lhs: Person, rhs: Person) -> Bool {
        return lhs.name == rhs.name
    }
}

var personSet : Set = [Person(name: "zhangsan", age: 28)]
personSet.update(with: Person(name: "wangwu", age: 18))    // '[__lldb_expr_44.Person(name: "zhangsan", age: 28), __lldb_expr_44.Person(name: "wangwu", age: 18)]'
personSet.update(with: Person(name: "zhangsan", age: 18))  // '[__lldb_expr_44.Person(name: "zhangsan", age: 18), __lldb_expr_44.Person(name: "wangwu", age: 18)]'
```

åœ¨ä½¿ç”¨ `update(with:)` æ–¹æ³•æ—¶ï¼Œéœ€è¦ä¿è¯é›†åˆå†…çš„å…ƒç´ å®ç°äº† `Equatable` åè®®ï¼Œç”¨æ¥åˆ¤æ–­ä¸¤ä¸ªå…ƒç´ æ˜¯å¦ç›¸ç­‰ã€‚

#### ç§»é™¤å…ƒç´ 

`filter(_:)`ï¼šè¿”å›ä¸€ä¸ªæ–°çš„ Setï¼Œæ–° Set çš„å…ƒç´ æ˜¯åŸå§‹ Set ç¬¦åˆæ¡ä»¶çš„å…ƒç´ ã€‚

```swift
struct Person {
    var name: String
    var age: Int
}

extension Person: Hashable {
    func hash(into hasher: inout Hasher) {
        hasher.combine(name)
        hasher.combine(age)
    }
}

extension Person: Equatable {
    static func == (lhs: Person, rhs: Person) -> Bool {
        return lhs.name == rhs.name
    }
}

var personSet : Set = [Person(name: "zhangsan", age: 28), Person(name: "wangwu", age: 18)]
print(personSet.filter{ $0.age > 20 })  // '[__lldb_expr_59.Person(name: "zhangsan", age: 28)]'
print(personSet)                        // '[__lldb_expr_59.Person(name: "wangwu", age: 18), __lldb_expr_59.Person(name: "zhangsan", age: 28)]'
```

`remove(_:)`ï¼šä» Set å½“ä¸­ç§»é™¤ä¸€ä¸ªå…ƒç´ ï¼Œå¦‚æœå…ƒç´ æ˜¯ Set çš„æˆå‘˜å°±ç§»é™¤å®ƒï¼Œå¹¶ä¸”è¿”å›ç§»é™¤çš„å€¼ã€‚å¦‚æœé›†åˆæ²¡æœ‰è¿™ä¸ªæˆå‘˜å°±è¿”å› nilã€‚

```swift
struct Person {
    var name: String
    var age: Int
}

extension Person: Hashable {
    func hash(into hasher: inout Hasher) {
        hasher.combine(name)
        hasher.combine(age)
    }
}

extension Person: Equatable {
    static func == (lhs: Person, rhs: Person) -> Bool {
        return lhs.name == rhs.name
    }
}

var personSet : Set = [Person(name: "zhangsan", age: 28), Person(name: "wangwu", age: 18)]
personSet.remove(Person(name: "zhangsan", age: 33))
print(personSet)
// Prints '[__lldb_expr_67.Person(name: "wangwu", age: 18)]'
```

`removeAll()`ï¼šç§»é™¤æ‰€æœ‰å…ƒç´ ã€‚

```swift
var personSet : Set = [Person(name: "zhangsan", age: 28), Person(name: "wangwu", age: 18)]
personSet.removeAll()
print(personSet)
// Prints '[]'
```

`removeFirst()`ï¼šç§»é™¤ Set çš„ç¬¬ä¸€ä¸ªå…ƒç´ ï¼Œå› ä¸º Set æ˜¯æ— åºçš„ï¼Œæ‰€ä»¥ç¬¬ä¸€ä¸ªå…ƒç´ å¹¶ä¸æ˜¯æ”¾å…¥çš„ç¬¬ä¸€ä¸ªå…ƒç´ ã€‚

```swift
var personSet : Set = [Person(name: "zhangsan", age: 28), Person(name: "wangwu", age: 18)]
personSet.removeFirst()
print(personSet)
// Prints '[__lldb_expr_71.Person(name: "zhangsan", age: 28)]'
```

### åŸºæœ¬ Set æ“ä½œ

![21](é›†åˆç±»/21.png)

`intersection(_:)`ï¼šäº¤é›†ï¼Œç”±å±äº A ä¸”å±äº B çš„ç›¸åŒå…ƒç´ ç»„æˆçš„é›†åˆï¼Œè®°ä½œ Aâˆ©Bï¼ˆæˆ– Bâˆ©Aï¼‰ã€‚

```swift
let set1: Set<Character> = ["A", "B", "C"]
let set2: Set<Character> = ["B", "E", "F", "G"]
print(set1.intersection(set2))
// Prints '["B"]'
```

`union(_:)`ï¼šå¹¶é›†ï¼Œç”±å±äº A æˆ–è€…å±äº B çš„æ‰€æœ‰å…ƒç´ ç»„æˆçš„é›†åˆï¼Œè®°ä½œ AâˆªBï¼ˆæˆ– BâˆªAï¼‰ã€‚

```swift
let set1: Set<Character> = ["A", "B", "C"]
let set2: Set<Character> = ["B", "E", "F", "G"]
print(set1.union(set2))
// Prints '["F", "G", "C", "A", "E", "B"]'
```

`symmetricDifference(_:)`ï¼šå¯¹ç§°å·®é›†ï¼Œé›†åˆ A ä¸é›†åˆ B çš„å¯¹ç§°å·®é›†å®šä¹‰ä¸ºé›†åˆ A ä¸é›†åˆ B ä¸­æ‰€æœ‰ä¸å±äº Aâˆ©B çš„å…ƒç´ çš„é›†åˆã€‚

```swift
let set1: Set<Character> = ["A", "B", "C"]
let set2: Set<Character> = ["B", "E", "F", "G"]
print(set1.symmetricDifference(set2))
// Prints '["G", "C", "A", "E", "F"]'
```

`subtracting(_:)`ï¼šç›¸å¯¹è¡¥é›†ï¼Œç”±å±äº A è€Œä¸å±äº B çš„å…ƒç´ ç»„æˆçš„é›†åˆï¼Œç§°ä¸º B å…³äº A çš„ç›¸å¯¹è¡¥é›†ï¼Œè®°ä½œ A-B æˆ– A\Bã€‚

```swift
let set1: Set<Character> = ["A", "B", "C"]
let set2: Set<Character> = ["B", "E", "F", "G"]
print(set1.subtracting(set2))
// Prints '["C", "A"]'
```

#### Set åˆ¤æ–­æ–¹æ³•

`isSubset(of:)`ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯å¦ä¸€ä¸ª Set æˆ–è€… Sequence çš„å­é›†ã€‚

```swift
let smallSet: Set = [1, 2, 3]
let bigSet: Set = [1, 2, 3, 4]
print(smallSet.isSubset(of: bigSet))
// Prints 'true'
```

`isSuperset(of:)`ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯å¦ä¸€ä¸ª Set æˆ–è€… Sequence çš„è¶…é›†ã€‚

```swift
let smallSet: Set = [1, 2, 3]
let bigSet: Set = [1, 2, 3, 4]
print(bigSet.isSuperset(of: smallSet))
// Prints 'true'
```

`isStrictSubset(of:)` ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯å¦ä¸€ä¸ª Set çš„**å­é›†**ï¼Œä½†æ˜¯åˆä¸ç­‰äºå¦ä¸€ä¸ª Setã€‚

```swift
let smallSet: Set = [1, 2, 3]
let bigSet: Set = [1, 2, 3, 4]
print(smallSet.isStrictSubset(of: bigSet))
// Prints 'true'
```

`isStrictSuperset(of:)`ï¼šåˆ¤æ–­æ˜¯å¦æ˜¯å¦ä¸€ä¸ª Set çš„**è¶…é›†**ï¼Œä½†æ˜¯åˆä¸ç­‰äºå¦ä¸€ä¸ª Setã€‚

```swift
let smallSet: Set = [1, 2, 3]
let bigSet: Set = [1, 2, 3, 4]
print(bigSet.isStrictSuperset(of: smallSet))
// Prints 'true'
```

`isDisjoint(with:)`ï¼šåˆ¤æ–­ä¸¤ä¸ª Set æ˜¯å¦ä¸ç›¸äº¤ï¼Œå¦‚æœä¸ç›¸äº¤è¿”å› `true`ï¼Œå¦‚æœç›¸äº¤è¿”å› `false`ã€‚

```swift
let smallSet: Set = [1, 2, 3]
let bigSet: Set = [1, 2, 3, 4]
print(smallSet.isDisjoint(with: bigSet))
// Prints 'false'
```

### Set-ç»ƒä¹ 

* ç»™å®šä¸€ä¸ªé›†åˆï¼Œè¿”å›è¿™ä¸ªé›†åˆæ‰€æœ‰çš„å­é›†ã€‚

#### æ€è·¯1-ä½

è§£è¿™é“é¢˜çš„æ€æƒ³æœ¬è´¨ä¸Šå°±æ˜¯å…ƒç´ é€‰ä¸ä¸é€‰çš„é—®é¢˜ï¼Œäºæ˜¯å°±å¯ä»¥æƒ³åˆ°ç”¨äºŒè¿›åˆ¶æ¥ä»£è¡¨é€‰ä¸ä¸é€‰çš„æƒ…å†µã€‚â€œ1â€ä»£è¡¨è¿™ä¸ªå…ƒç´ å·²ç»é€‰æ‹©ï¼Œè€Œâ€œ0â€ä»£è¡¨è¿™ä¸ªå…ƒç´ æ²¡æœ‰é€‰æ‹©ã€‚å‡å¦‚ä¸‰ä¸ªå…ƒç´  A B Cï¼Œé‚£ä¹ˆ 101 å°±ä»£è¡¨ B æ²¡æœ‰é€‰æ‹©ï¼Œæ‰€ä»¥ 101 ä»£è¡¨çš„å­é›†ä¸º ACã€‚

```swift
func getSubsetsOfSet<T>(_ set1: Set<T>) -> Array<Set<T>> {
    // å­é›†æœ‰ 2^n ä¸ª
    let count = 1 << set1.count
    // ä½¿ç”¨æ•°ç»„ï¼Œæ–¹ä¾¿ä½¿ç”¨ä¸‹æ ‡
    let elements = Array(set1)
    var subsets = Array<Set<T>>()
    // éå† 2^n ä¸ªå­é›†å¯¹åº”çš„ä¸‹æ ‡
    for i in 0..<count {
        var subSet = Set<T>()
        for j in 0..<set1.count {
            // å½“å­é›†çš„ä¸‹æ ‡å¯¹åº”çš„äºŒè¿›åˆ¶ä½ä¸º1æ—¶ï¼Œæ”¾å…¥å­é›†ä¸­
            if ((i >> j) & 1) == 1 {
                subSet.insert(elements[j])
            }
        }
        subsets.append(subSet)
    }
    return subsets
}

let set1: Set = ["A", "B", "C"]
let subSets = getSubsetsOfSet(set1)
for subset in subSets {
    print(subset)
}
```

æ‰“å°ç»“æœï¼š

```js
[]
["A"]
["B"]
["A", "B"]
["C"]
["A", "C"]
["B", "C"]
["A", "B", "C"]
```

æ‰“å°ç»“æœè§£æï¼š

ç¬¬0ä¸ªå­é›†ï¼ŒäºŒè¿›åˆ¶ 000ï¼Œæ²¡æœ‰å…ƒç´ 
ç¬¬1ä¸ªå­é›†ï¼ŒäºŒè¿›åˆ¶ 001ï¼Œæœ‰ä¸€ä¸ªå…ƒç´  A
ç¬¬2ä¸ªå­é›†ï¼ŒäºŒè¿›åˆ¶ 010ï¼Œæœ‰ä¸€ä¸ªå…ƒç´  B
ç¬¬3ä¸ªå­é›†ï¼ŒäºŒè¿›åˆ¶ 011ï¼Œæœ‰ä¸¤ä¸ªå…ƒç´  A B
ç¬¬4ä¸ªå­é›†ï¼ŒäºŒè¿›åˆ¶ 100ï¼Œæœ‰ä¸€ä¸ªå…ƒç´  C
ç¬¬5ä¸ªå­é›†ï¼ŒäºŒè¿›åˆ¶ 101ï¼Œæœ‰ä¸¤ä¸ªå…ƒç´  A C
ç¬¬6ä¸ªå­é›†ï¼ŒäºŒè¿›åˆ¶ 110ï¼Œæœ‰ä¸¤ä¸ªå…ƒç´  A B
ç¬¬7ä¸ªå­é›†ï¼ŒäºŒè¿›åˆ¶ 111ï¼Œæœ‰ä¸‰ä¸ªå…ƒç´  A B C

ä½¿ç”¨è¿™ç§æ–¹å¼æœ‰ä¸€ä¸ªæ³¨æ„é¡¹ï¼Œå› ä¸ºäºŒè¿›åˆ¶çš„æœ€å¤§é•¿åº¦æ˜¯64ï¼Œæ‰€æœ‰ count ä¸èƒ½è¶…è¿‡64ä½ã€‚

#### æ€è·¯2-é€’å½’

```swift
func getSubsetsOfSet<T>(_ originSet: Set<T>) -> Array<Set<T>> {
    let elements = Array(originSet)
    return getSubsetsOfSet2(elements, elements.count - 1)
}

func getSubsetsOfSet2<T>(_ elements: Array<T>, _ index: Int) -> Array<Set<T>> {
    var subSets = Array<Set<T>>()
    if index == 0 {
        // ç©ºé›†
        subSets.append(Set<T>())
        // åªæœ‰ä¸€ä¸ªå…ƒç´ 
        var subSet = Set<T>()
        subSet.insert(elements[index])
        subSets.append(subSet)
    } else {
        subSets = getSubsetsOfSet2(elements, index - 1)
        for subSet in subSets {
            // æ ¹æ® subSet ç”Ÿæˆæ–°çš„ currentSubSetï¼Œå‘ currentSubSet ä¸­åŠ å…¥æ–°çš„å…ƒç´ 
            var currentSubSet = subSet
            currentSubSet.insert(elements[index])
            subSets.append(currentSubSet)
        }
    }
    return subSets
}

let originSet: Set = ["A", "B", "C"]
let subSets = getSubsetsOfSet(originSet)
for subSet in subSets {
    print(subSet)
}
```

æ‰“å°ç»“æœï¼š

```js
[]
["A"]
["B"]
["A", "B"]
["C"]
["C", "A"]
["B", "C"]
["A", "B", "C"]
```

index == 0ï¼Œä¸€ä¸ªå…ƒç´ ï¼Œç”Ÿæˆä¸¤ä¸ªå­é›†ï¼Œ`[] ["A"]`
index == 1ï¼Œä¸¤ä¸ªå…ƒç´ ï¼Œç”Ÿæˆå››ä¸ªå­é›†ï¼Œ`[] ["A"]` `["B"] ["A", "B"]`
index == 2ï¼Œä¸‰ä¸ªå…ƒç´ ï¼Œç”Ÿæˆå…«ä¸ªå­é›†ï¼Œ`[] ["A"]` `["B"] ["A", "B"]` `["C"] ["A", "C"] ["B", "C"] ["A", "B", "C"]`

### Set å®ç°æ¢ç§˜

1. å…ˆçœ‹é¡¶å±‚è®¾è®¡ï¼Œå†çœ‹åº•å±‚æºç å®ç°ã€‚
2. ä»å…³é”®æ–¹æ³•å¼€å§‹ï¼Œæ²¿ç€è°ƒç”¨é“¾é˜…è¯»ã€‚

ä¸»è¦åŒ…æ‹¬ä¸¤ä¸ªéƒ¨åˆ†ï¼š

1. ä½¿ç”¨ HashTable å­˜æ”¾ bucketã€‚
2. ä½¿ç”¨ elements å­˜æ”¾ å…ƒç´ ã€‚

çº¿æ€§æ¢æµ‹çš„å¼€æ”¾å¯»å€æ³•ï¼š

![22](é›†åˆç±»/22.png)

å·¦ä¾§æ˜¯ keysï¼Œå³ä¾§æ˜¯ bucketsã€‚

John Smith é€šè¿‡è®¡ç®—æ‰¾åˆ° bucketï¼Œå› ä¸º bucket æ²¡æœ‰è¢«å ç”¨ï¼Œæ‰€ä»¥å¯ä»¥ç›´æ¥è¿›è¡Œå­˜å‚¨ã€‚
Sam Doe é€šè¿‡è®¡ç®—å¾—æ‰¾åˆ° bucketï¼Œå› ä¸º bucket è¢«å ç”¨ï¼Œå¯»æ‰¾ä¸‹ä¸€ä¸ª bucket01ï¼Œå› ä¸º bucket01 æ²¡æœ‰è¢«å ç”¨ï¼Œæ‰€ä»¥å¯ä»¥ä½¿ç”¨ bucket01 è¿›è¡Œå­˜å‚¨ã€‚

#### ä» Set çš„ insert è¯´èµ·

![23](é›†åˆç±»/23.png)

è¿™æ˜¯ `inser()` çš„å…³é”®ä»£ç ï¼Œç”¨åˆ°çš„æ ¸å¿ƒæ–¹æ³•æ˜¯ `find()` å’Œ `insertNew()`ã€‚

#### _NativeSet çš„ find æ–¹æ³•

`find()`ï¼šæŸ¥æ‰¾æ¡¶ï¼ˆBucketï¼‰ï¼Œæ‰¾åˆ°åç›´æ¥ä½¿ç”¨å¹¶è¿”å›ã€‚æ²¡æœ‰æ‰¾åˆ°åˆ™è°ƒç”¨ `insertNew()`ã€‚ä¸»è¦ç”¨åˆ°äº† HasTable çš„ `idealBucket()` å’Œ `bucket()` æ–¹æ³•ã€‚

`_isOccupied()`ï¼šåˆ¤æ–­æ¡¶æ˜¯å¦è¢«å ç”¨ã€‚

![24](é›†åˆç±»/24.png)

#### HashTable

`idealBucket()`ï¼šæ‰¾åˆ°å¯¹åº”çš„ bucketã€‚
`bucket()`ï¼šæ‰¾åˆ°å½“å‰ bucket çš„åä¸€ä¸ª bucketã€‚

![25](é›†åˆç±»/25.png)

ä» HashTable çš„æºç å¯ä»¥çœ‹åˆ°ï¼Œ`bucketMask = bucketCount &-1`ï¼Œä¸ä¸Š `-1` å¯ä»¥ä¿è¯ `bucket.offset & bucketMask` å°äº bucketCountï¼Œ`hashValue & bucketMask` å°äº bucketCountã€‚

![26](é›†åˆç±»/26.png)

#### _NativeSet çš„ insertNew

_isDebugAssertConfiguration() æ˜¯ debug ä»£ç ï¼Œå¯ä»¥ç›´æ¥çœ‹ else é‡Œçš„ä»£ç ï¼Œæ˜¯è°ƒç”¨äº† HashTable çš„ `insertNew()` æ–¹æ³•ã€‚

`insertNew()` æ ¹æ® hashValue æ‰¾åˆ° bucketï¼Œå†è°ƒç”¨ `uncheckedInitialize()` æ’å…¥æ•°æ®ã€‚

![27](é›†åˆç±»/27.png)

#### HashTable çš„ insertNew

æ ¹æ® hashValue æ‰¾åˆ°å¯ç”¨çš„ bucketã€‚

![28](é›†åˆç±»/28.png)

#### _NativeSet çš„ uncheckedInitialize

æ ¹æ® `_elements` é¦–åœ°å€å€¼åŠ åç§»é‡ `bucket.offset` å¾—åˆ°æ’å…¥ä½ç½®ï¼Œæ’å…¥æ•°æ®ã€‚

![29](é›†åˆç±»/29.png)

## å­—å…¸

å­—å…¸ï¼šå‚¨å­˜æ— åºçš„äº’ç›¸å…³è”çš„åŒä¸€ç±»å‹çš„é”®å’ŒåŒä¸€ç±»å‹çš„å€¼çš„é›†åˆã€‚

å­—å…¸ç±»å‹çš„å…¨å†™æ–¹å¼ `Dictionary<Key, Value>`ï¼Œç®€å†™æ–¹å¼ `[Key: Value]`ï¼Œå»ºè®®ä½¿ç”¨ç®€å†™æ–¹å¼ã€‚å…¶ä¸­å­—å…¸çš„ Key å¿…é¡»æ˜¯å¯å“ˆå¸Œçš„ã€‚

### åˆ›å»ºç©ºå­—å…¸

1ã€åˆå§‹å™¨æ–¹å¼

```swift
var dic = Dictionary<String, Int>()
```

2ã€ç®€å†™æ–¹å¼

```swift
var dic = [String: Int]()
```

3ã€å­—é¢é‡æ–¹å¼

```swift
var dic3: Dictionary<String, Int> = [:]
```

### å­—é¢é‡åˆ›å»ºå­—å…¸

å­—å…¸å­—é¢é‡ï¼š`[key1:value1, key2:value2, key3:value3]`

```swift
let dic = ["zhangsan": 18, "lishi": 19, "wangwu": 20]
```

#### count å’Œ isEmpty

`count`ï¼šåªè¯»å±æ€§ï¼Œæ‰¾å‡º Dictionary æ‹¥æœ‰å¤šå°‘å…ƒç´ ã€‚

```swift
let dic = ["zhangsan": 18, "lishi": 19, "wangwu": 20]
print(dic.count)
// Prints '3'
```

`isEmpty`ï¼šå¸ƒå°”é‡å±æ€§ï¼Œæ£€æŸ¥å­—å…¸æ˜¯å¦ä¸ºç©ºã€‚

```swift
let dic = ["zhangsan": 18, "lishi": 19, "wangwu": 20]
print(dic.isEmpty)
// Prints 'false'
```

### éå†å­—å…¸

`For-In`å¾ªç¯

```swift
let dic = ["zhangsan": 18, "lishi": 19, "wangwu": 20]

for (key, value) in dic {
    print("name \(key), age \(value)")
}
```

æ‰“å°ç»“æœï¼š

```js
name lishi, age 19
name wangwu, age 20
name zhangsan, age 18
```

å¯ä»¥é€šè¿‡å­—å…¸çš„ keys æˆ– values å±æ€§éå†å­—å…¸çš„é”®æˆ–å€¼çš„é›†åˆã€‚

```swift
let dic = ["zhangsan": 18, "lishi": 19, "wangwu": 20]

for key in dic.keys {
    print("name \(key)")
}

for key in dic.values {
    print("name \(key)")
}
```

æ‰“å°ç»“æœï¼š

```js
name zhangsan
name wangwu
name lishi
name 18
name 20
name 19
```

Swift çš„ Dictionary ç±»å‹æ˜¯æ— åºçš„ï¼Œå¯ä»¥é€šè¿‡å¯¹ keys æˆ– values è°ƒç”¨ sort() æ–¹æ³•æ’åºï¼Œæ¥éå†æœ‰åºçš„é”®æˆ–å€¼ã€‚

```swift
let dic = ["zhangsan": 18, "lishi": 19, "wangwu": 20]

for key in dic.keys.sorted() {
    print("name \(key), age \(dic[key])")
}
```

æ‰“å°ç»“æœï¼š

```swift
name lishi, age Optional(19)
name wangwu, age Optional(20)
name zhangsan, age Optional(18)
```

### æ“ä½œå­—å…¸

#### æ·»åŠ æˆ–æ›´æ–°å…ƒç´ 

1ã€ä½¿ç”¨ä¸‹æ ‡æ·»åŠ æˆ–æ›´æ–°å…ƒç´ ã€‚

```swift
var dic = ["zhangsan": 18, "lishi": 19, "wangwu": 20]
dic["zhangsan"] = 28  // '["lishi": 19, "zhangsan": 28, "wangwu": 20]'
```

2ã€ä½¿ç”¨ `updateValue(_:forKey)` æ–¹æ³•æ·»åŠ æˆ–æ›´æ–°å…ƒç´ ï¼Œè¿”å›ä¸€ä¸ªå­—å…¸å€¼ç±»å‹çš„å¯é€‰é¡¹å€¼ã€‚

```swift
var dic = ["zhangsan": 18, "lishi": 19, "wangwu": 20]
dic.updateValue(29, forKey: "lishi")  // '["wangwu": 20, "zhangsan": 18, "lishi": 29]'
```

#### å­—å…¸-ç§»é™¤å…ƒç´ 

1ã€å¯ä»¥ä½¿ç”¨ä¸‹æ ‡è„šæœ¬è¯­æ³•ç»™ä¸€ä¸ªé”®èµ‹å€¼ `nil`ï¼Œå®ç°ä»å­—å…¸ä¸­ç§»é™¤è¯¥é”®å€¼å¯¹ã€‚

```swift
var dic = ["zhangsan": 18, "lishi": 19, "wangwu": 20]
dic["zhangsan"] = nil  // '["lishi": 19, "wangwu": 20]'
```

2ã€ä¹Ÿå¯ä»¥ä½¿ç”¨ `removeValue(forKey:)` ä»å­—å…¸ä¸­ç§»é™¤é”®å€¼å¯¹ã€‚

```swift
var dic = ["zhangsan": 18, "lishi": 19, "wangwu": 20]
print(dic.removeValue(forKey: "zhangsan") ?? 0)  // '18'
print(dic)                                       // '["lishi": 19, "wangwu": 20]'
print(dic.removeValue(forKey: "zhangsan"))       // 'nil'
```

åœ¨ä½¿ç”¨è¿™ä¸ªæ–¹æ³•ç§»é™¤é”®å€¼å¯¹æ—¶ï¼Œå¦‚æœé”®å€¼å¯¹å­˜åœ¨åˆ™è¿”å›å…¶ `value`ï¼Œå¦‚æœä¸å­˜åœ¨åˆ™è¿”å› `nil`ã€‚

#### åˆå¹¶ä¸¤ä¸ªå­—å…¸

`merge(_:uniquingKeysWith:)`

1ã€ä¿ç•™æ—§å€¼

```swift
var dictionary = ["a": 1, "b": 2]
dictionary.merge(["a": 3, "c": 4]) { (current, _) in current }
print(dictionary)
// Prints '["b": 2, "c": 4, "a": 1]'
```

2ã€ä¿ç•™æ–°å€¼

```swift
var dictionary = ["a": 1, "b": 2]
dictionary.merge(["a": 5, "d": 6]) { (_, new) in new }
print(dictionary)
// Prints '["a": 5, "b": 2, "d": 6, "c": 4]'
```

#### firstIndex

è™½ç„¶å­—å…¸æ˜¯æ— åºçš„ï¼Œä½†æ˜¯æ¯ä¸ªkvå¯¹ï¼ˆé”®å€¼å¯¹ï¼‰åœ¨æ‰©å®¹ä¹‹å‰çš„ä½ç½®æ˜¯ç¡®å®šçš„ã€‚å¯ä»¥é€šè¿‡ `firstIndex` è·å–æŸä¸ªkvå¯¹çš„ä½ç½®ã€‚

```swift
let imagePaths = ["star": "/glyphs/stat.png",
                  "protrait": "/images/content/portrait.jpg",
                  "spacer": "/images/shared/spacer.gif"]
let glyphIndex = imagePaths.firstIndex(where: { $0.value.hasPrefix("/glyphs") })

if let index = glyphIndex {
    print(index)
    print("The '\(imagePaths[index].key)' image is a glyph.")
} else {
    print("No glyphs found!")
}
```

æ‰“å°ç»“æœï¼š

```js
Index(_variant: Swift.Dictionary<Swift.String, Swift.String>.Index._Variant.native(Swift._HashTable.Index(bucket: Swift._HashTable.Bucket(offset: 1), age: -1384877248)))
The 'star' image is a glyph.
```

å¦‚æœéœ€è¦ä¿æŒé¡ºåºçš„kvå¯¹ï¼Œå¯ä»¥æ˜¯ç”¨ KeyValuePairsã€‚

```swift
let recordTimes: KeyValuePairs = ["Florence Griffith-Joyner": 10.49,
                                  "Evelyn Ashford": 10.76,
                                  "Evelyn Ashford": 10.79,
                                  "Marlies Gohr": 10.81]
print(recordTimes.first)
// Prints 'Optional((key: "Florence Griffith-Joyner", value: 10.49))'
```

### å­—å…¸å®ç°æ¢ç§˜

ä»å…³é”®æ–¹æ³•å¼€å§‹ï¼Œæ²¿ç€è°ƒç”¨é“¾é˜…è¯»ã€‚ä» set æ–¹æ³•å¼€å§‹ã€‚

#### ä»ä¸‹æ ‡æ“ä½œè¯´èµ·

å­—å…¸çš„å…³é”®æ“ä½œè·Ÿ set æ–¹æ³•ç±»ä¼¼ï¼Œå°±æ˜¯ä¸‹æ ‡æ“ä½œã€‚

`subscript(key:)`ï¼šå­—å…¸çš„ set æ–¹æ³•ï¼Œå‚æ•°æ˜¯ `Key`ï¼Œè¿”å›å€¼æ˜¯å¯é€‰ `Value?`ã€‚

![30](é›†åˆç±»/30.png)

`lookup()`ï¼šget æ–¹æ³•é€šè¿‡ lookup() æ–¹æ³•æ‰¾åˆ°å¯¹åº”çš„ valueã€‚

`setValue()`ï¼šå†™å…¥æ–°å€¼ã€‚

#### Dictionary._Variant çš„ setValue

`setValue(_ value: __owned Value, forKey key: Key)`ï¼šå†™å…¥æ–°å€¼ã€‚éœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œå€¼ã€é”®ã€‚

æºç åŒ…æ‹¬ OC å’Œ Swift ä¸¤ä¸ªå®ç°ï¼Œæœ€åä¸¤è¡Œæ˜¯ Swift å®ç°éƒ¨åˆ†ã€‚

![31](é›†åˆç±»/31.png)

è°ƒç”¨é“¾ï¼š`setValue()` â†’ `asNative.setValue()`ã€‚

`isUniquelyReferenced()`ï¼šåˆ¤æ–­å½“å‰ Dictionary æ˜¯å¦å”¯ä¸€ã€‚

`asNative` æ˜¯ `_NativeDictionary`ï¼Œä¸»è¦è´Ÿè´£å®ç° `setValue()` æ–¹æ³•ğŸ‘‡ã€‚

#### _NativeDictionary çš„ setValue

`setValue(_ value: __owned Value, forKey key: Key, isUnique: Bool)`ï¼šå¯ä»¥çœ‹åˆ°éœ€è¦ä¸‰ä¸ªå‚æ•°ï¼Œå€¼ã€é”®ã€æ˜¯å¦å”¯ä¸€ã€‚

![32](é›†åˆç±»/32.png)

å®ç°éƒ¨åˆ†å’Œ `insertNew()` ç±»ä¼¼ï¼Œé‡‡ç”¨çš„ä¹Ÿæ˜¯å¼€æ”¾å¯»å€æ³•ã€‚

å¦‚æœæ‰¾åˆ°äº†ï¼Œåˆ™æ ¹æ® `_values` é¦–åœ°å€å€¼åŠ ä¸Šæ¡¶çš„åç§»é‡ `bucket.offset` è®¡ç®—å‡ºä½ç½®ï¼Œå­˜æ”¾ valueã€‚

å¦‚æœæ²¡æ‰¾åˆ°ï¼Œåˆ™è°ƒç”¨ `_insert()` æ–¹æ³•ğŸ‘‡ã€‚

#### _NativeDictionary çš„_insert

`_insert(at bucket: Bucket, key: __owned Key, value: __owned Value)`ï¼šéœ€è¦ä¸‰ä¸ªå‚æ•°ï¼Œæ¡¶ã€é”®ã€å€¼ã€‚

![33](é›†åˆç±»/33.png)

`hashTable.insert(bucket)`ï¼šå°†æ¡¶æ’å…¥åˆ°å“ˆå¸Œè¡¨é‡Œã€‚

`uncheckedInitialize()`ï¼šä¿å­˜é”®å€¼ã€‚

>ä¸¤ä¸ªå…³é”®æ“ä½œï¼š
>
>1. ä¿å­˜æ¡¶åˆ°å“ˆå¸Œè¡¨ã€‚
>2. ä¿å­˜é”®å€¼ã€‚

#### _NativeDictionary çš„ uncheckedInitialize

`uncheckedInitialize(at bucket: Bucket, toKey key: __owned Key, value: __owned Value)`ï¼šéœ€è¦ä¸‰ä¸ªå‚æ•°ï¼Œæ¡¶ã€é”®ã€å€¼ã€‚

![34](é›†åˆç±»/34.png)

`(_keys + bucket.offset).initialize(to: key)`ï¼šæ ¹æ® _keys çš„é¦–åœ°å€åŠ ä¸Šæ¡¶çš„åç§»é‡ bucket.offset è®¡ç®—å‡ºä½ç½®ï¼Œå­˜æ”¾ keyã€‚

`(_values + bucket.offset).initialize(to: value)`ï¼šæ ¹æ® _values çš„é¦–åœ°å€åŠ ä¸Šæ¡¶çš„åç§»é‡ bucket.offset è®¡ç®—å‡ºä½ç½®ï¼Œå­˜æ”¾ keyã€‚

>ä¸¤ä¸ªå…³é”®æ“ä½œï¼š
>
>1. ä¿å­˜keyã€‚
>2. ä¿å­˜valueã€‚

#### _NativeDictionary çš„ findKey

`find(_ key: Key, hashValue: Int) -> (bucket: Bucket, found: Bool)`ï¼šéœ€è¦ä¸¤ä¸ªå‚æ•°ï¼Œé”®ã€é”®çš„å“ˆå¸Œå€¼ã€‚è¿”å›ç»“æœåŒ…æ‹¬ä¸¤ä¸ªå†…å®¹ï¼Œæ¡¶ã€æ˜¯å¦å­˜åœ¨ã€‚

![35](é›†åˆç±»/35.png)

`idealBucket()`ï¼šæ ¹æ®å“ˆå¸Œå€¼æŸ¥æ‰¾æ¡¶ã€‚

`_isOccupied()`ï¼šæ¡¶æ˜¯å¦è¢«å ç”¨ã€‚

`bucket(wrappedAfter:)`ï¼šä»å½“å‰ bucket å¼€å§‹å‘åæŸ¥æ‰¾æ¡¶ã€‚

>ä¸¤ä¸ªå…³é”®æ“ä½œï¼š
>
>1. æ ¹æ®å“ˆå¸Œå€¼æŸ¥æ‰¾å¯¹åº”çš„æ¡¶ã€‚
>2. æŸ¥æ‰¾æ²¡æœ‰è¢«å ç”¨çš„æ¡¶ã€‚
