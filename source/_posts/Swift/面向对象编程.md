---
title: é¢å‘å¯¹è±¡ç¼–ç¨‹
date: 2023-05-04 10:41:19
tags: Swift
---

* [æ¦‚è¿°](#æ¦‚è¿°)
* [æšä¸¾](#æšä¸¾)
* [å±æ€§](#å±æ€§)
* [æ–¹æ³•](#æ–¹æ³•)
* [ä¸‹æ ‡](#ä¸‹æ ‡)
* [åˆå§‹åŒ–å’Œååˆå§‹åŒ–](#åˆå§‹åŒ–å’Œååˆå§‹åŒ–)
* [ç»§æ‰¿](#ç»§æ‰¿)
* [å¤šæ€](#å¤šæ€)
* [æ‰©å±•](#æ‰©å±•)
* [åè®®](#åè®®)
* [åè®®å’Œæ‰©å±•](#åè®®å’Œæ‰©å±•)
* [é¢å‘åè®®ç¼–ç¨‹](#é¢å‘åè®®ç¼–ç¨‹)

<!-- more -->

## æ¦‚è¿°

Swift çš„ç±»ã€ç»“æ„ä½“ã€æšä¸¾ä¸­éƒ½å¯ä»¥å®šä¹‰å±æ€§ã€æ–¹æ³•ã€ä¸‹æ ‡ã€æ„é€ ä½“å’ŒåµŒå¥—ç±»å‹ã€‚åœ¨ Swift ä¸­ï¼Œæšä¸¾å’Œç»“æ„ä½“æ˜¯å€¼ç±»å‹ï¼Œç±»æ˜¯å¼•ç”¨ç±»å‹ã€‚ä»æ•´ä½“çš„åŠŸèƒ½ä¸Šçœ‹ Swift çš„æšä¸¾ã€ç»“æ„ä½“ã€ç±»ä¸‰è€…å…·æœ‰å®Œå…¨å¹³ç­‰çš„åœ°ä½ã€‚

### é¢å‘å¯¹è±¡çš„ä¸‰å¤§ç‰¹æ€§

1. **å°è£…ï¼ˆEncapsulationï¼‰**ï¼šéšè—ç±»çš„å®ç°ç»†èŠ‚ï¼Œè®©ä½¿ç”¨è€…åªèƒ½é€šè¿‡é¢„å®šçš„æ–¹æ³•æ¥è®¿é—®ã€‚
2. **ç»§æ‰¿ï¼ˆinheritanceï¼‰**ï¼šæŒ‡å­ç±»ä»çˆ¶ç±»ç»§æ‰¿æ–¹æ³•ï¼Œä½¿å¾—å­ç±»å…·æœ‰çˆ¶ç±»ç›¸åŒçš„è¡Œä¸ºã€‚é€šè¿‡ç»§æ‰¿åˆ›å»ºçš„æ–°ç±»ç§°ä¸ºâ€œå­ç±»â€æˆ–â€œæ´¾ç”Ÿç±»â€ï¼Œè¢«ç»§æ‰¿çš„ç±»ç§°ä¸ºâ€œåŸºç±»â€ã€â€œçˆ¶ç±»â€æˆ–â€œè¶…ç±»â€ã€‚ç»§æ‰¿çš„è¿‡ç¨‹ï¼Œå°±æ˜¯ä»ä¸€èˆ¬åˆ°ç‰¹æ®Šçš„è¿‡ç¨‹ã€‚
3. **å¤šæ€ï¼ˆpolymorphismï¼‰**ï¼šæŒ‡åŒä¸€ä¸ªæ–¹æ³•åœ¨ä¸åŒçš„å¯¹è±¡ä¸Šæœ‰ä¸åŒçš„å®ç°æ–¹å¼ã€‚

### åŸºæœ¬å•å…ƒ

1. æšä¸¾ï¼ˆenumï¼‰
2. ç»“æ„ä½“ï¼ˆstructï¼‰
3. ç±»ï¼ˆclassï¼‰
4. åè®®ï¼ˆprotocolï¼‰
5. æ‰©å±•ï¼ˆextensionï¼‰

### ç±»å’Œç»“æ„ä½“ç›¸ä¼¼ç‚¹

1. **å±æ€§**ï¼šå®šä¹‰å±æ€§ç”¨æ¥å­˜å‚¨å€¼ï¼›
2. **æ–¹æ³•**ï¼šå®šä¹‰æ–¹æ³•ç”¨äºæä¾›åŠŸèƒ½ï¼›
3. **ä¸‹æ ‡**ï¼šå®šä¹‰ä¸‹æ ‡è„šæœ¬ç”¨æ¥å…è®¸ä½¿ç”¨ä¸‹æ ‡è¯­æ³•è®¿é—®å€¼ï¼›
4. **æ‰©å±•**ï¼šå¯ä»¥è¢«æ‰©å±•æä¾›é»˜è®¤æ‰€æ²¡æœ‰çš„åŠŸèƒ½ï¼›
5. **åè®®**ï¼šéµå¾ªåè®®æ¥é’ˆå¯¹ç‰¹å®šç±»å‹æä¾›æ ‡å‡†åŠŸèƒ½ã€‚
6. **åˆå§‹åŒ–å™¨**ï¼šå®šä¹‰åˆå§‹åŒ–å™¨ç”¨äºåˆå§‹åŒ–çŠ¶æ€ï¼›

### ç±»å’Œç»“æ„ä½“çš„ä¸åŒç‚¹

1. **ç»§æ‰¿**ï¼šå…è®¸ä¸€ä¸ªç±»ç»§æ‰¿å¦ä¸€ä¸ªç±»çš„ç‰¹å¾ï¼›
2. **ç±»å‹è½¬æ¢**ï¼šå…è®¸åœ¨è¿è¡Œæ—¶æ£€æŸ¥å’Œè§£é‡Šä¸€ä¸ªç±»å®ä¾‹çš„ç±»å‹ï¼›
3. **ååˆå§‹åŒ–å™¨**ï¼šå…è®¸ä¸€ä¸ªç±»å®ä¾‹é‡Šæ”¾æ‰€æœ‰è¢«åˆ†é…çš„èµ„æºï¼›
4. **å¼•ç”¨è®¡æ•°**ï¼šå…è®¸ä¸æ­¢ä¸€ä¸ªå¯¹ç±»å®ä¾‹çš„å¼•ç”¨ã€‚

## æšä¸¾

### æšä¸¾è¯­æ³•

ç”¨ `enum` å…³é”®å­—æ¥å®šä¹‰ä¸€ä¸ªæšä¸¾ï¼Œç„¶åå°†æ‰€æœ‰çš„å®šä¹‰å†…å®¹æ”¾åœ¨å¤§æ‹¬å·`{}`ä¸­ã€‚

```swift
enum CompassPoint {
    case north
    case south
    case east
    case west
}
```

å¤šä¸ªæˆå‘˜å€¼å¯ä»¥å‡ºç°åœ¨åŒä¸€è¡Œä¸­ï¼Œç”¨é€—å·éš”å¼€ï¼š

```swift
enum CompassPoint {
    case north, south, east, west
}
```

æ¯ä¸ªæšä¸¾éƒ½å®šä¹‰äº†ä¸€ä¸ªå…¨æ–°çš„ç±»å‹ã€‚æšä¸¾çš„åå­—éœ€è¦é¦–å­—æ¯å¤§å†™ï¼ˆä¾‹å¦‚ï¼š`CompassPoint`ï¼‰ã€‚è¦ç»™æšä¸¾ç±»å‹èµ·ä¸€ä¸ªå•æ•°çš„åå­—ï¼Œä»è€Œä½¿å¾—æšä¸¾èƒ½å¤Ÿé€šä¿—æ˜“æ‡‚ã€é¡¾åæ€ä¹‰ã€‚

### ä½¿ç”¨ Switch è¯­å¥æ¥åŒ¹é…æšä¸¾å€¼

ä½¿ç”¨ `switch` è¯­å¥åŒ¹é…æ¯ä¸€ä¸ªå•ç‹¬çš„æšä¸¾å€¼ï¼š

```swift
enum CompassPoint {
    case north, south, east, west
}

let directionToHead = CompassPoint.south
switch directionToHead {
case .north:
    print("north")
case .south:
    print("south")
case .east:
    print("east")
case .west:
    print("weat")
}

// Prints "south"
```

### éå†æšä¸¾çš„ case

1. `CaseIterable`ï¼šé€šè¿‡åœ¨æšä¸¾åå­—åé¢å†™ `CaseIterable`ï¼Œæ¥å…è®¸æšä¸¾è¢«éå†ã€‚
2. `allCases`ï¼šSwift çš„æšä¸¾æš´éœ²äº†ä¸€ä¸ªé›†åˆ `allCases`ï¼ŒåŒå­—é¢ä¹‰ï¼Œè¯¥é›†åˆåŒ…å«å¯¹åº”æšä¸¾ç±»å‹çš„æ‰€æœ‰æƒ…å†µã€‚

```swift
enum CompassPoint: CaseIterable {
    case north
    case south
    case east
    case west
}

for direction in CompassPoint.allCases {
    print(direction)
}
```

æ‰“å°ç»“æœï¼š

```js
north
south
east
west
```

### å…³è”å€¼

å¯ä»¥å®šä¹‰æšä¸¾æ¥å­˜å‚¨ä»»æ„ç±»å‹çš„å…³è”å€¼ï¼Œä¸åŒæšä¸¾æˆå‘˜å…³è”å€¼çš„ç±»å‹å¯ä»¥ä¸åŒã€‚

å®šä¹‰ä¸€ä¸ªæšä¸¾ï¼Œæ”¯æŒæ¡å½¢ç å’ŒäºŒç»´ç ï¼š

```swift
enum Barcode {
    case upc(Int, Int, Int, Int)
    case qrCode(String)
}

var productBarCode = Barcode.upc(8, 85909, 51226, 3)
print(productBarCode)

productBarCode = .qrCode("ABCDEFGHIJKLMNOPQRSTUVWXYZ")
print(productBarCode)
```

æ‰“å°ç»“æœï¼š

```js
upc(8, 85909, 51226, 3)
qrCode("ABCDEFGHIJKLMNOPQRSTUVWXYZ")
```

`upc` æœ‰å››ä¸ªå…³è”å€¼ï¼Œéƒ½æ˜¯ `Int` ç±»å‹ï¼›`qrCode` æœ‰ä¸€ä¸ªå…³è”å€¼ï¼Œ`String` ç±»å‹ã€‚

ä½¿ç”¨ `switch` **åŒ¹é…å€¼**ï¼š

```swift
switch productBarCode {
case .upc(let numberSystem, let manufacturer, let product, let check):
    print("UPC: \(numberSystem), \(manufacturer), \(product), \(check).")
case .qrCode(let productCode):
    print("QR code: \(productCode)")
}

// Prints "QR code: ABCDEFGHIJKLMNOPQRSTUVWXYZ"
```

### åŸå§‹å€¼

åŸå§‹å€¼ï¼šæŒ‡æšä¸¾æˆå‘˜å¯ä»¥ç”¨ç›¸åŒç±»å‹çš„**é»˜è®¤å€¼**é¢„å…ˆå¡«å……ã€‚

```swift
enum ASCIIControlCharacter: Character {
    case tab = "\t"
    case lineFeed = "\n"
    case carriageReturn = "\r"
}
```

#### é¢„è®¾åŸå§‹å€¼

åœ¨æ“ä½œå­˜å‚¨æ•´æ•°æˆ–å­—ç¬¦ä¸²åŸå§‹å€¼æšä¸¾çš„æ—¶å€™ï¼Œå› ä¸ºSwiftçš„æšä¸¾ä¼šè‡ªåŠ¨åˆ†é…å€¼ï¼ˆåœ¨æ²¡æœ‰åˆ†é…å€¼æ—¶ï¼‰ï¼Œæ‰€ä»¥ä¸ç”¨æ˜¾ç¤ºçš„ä¸ºæ¯ä¸€ä¸ªæˆå‘˜åˆ†é…åŸå§‹å€¼ã€‚

```swift
enum Planet: Int {
    case mercury = 1, venus, earth, mars, jupiter, saturn, uranus, neptune
}

enum CompassPoint: String {
    case north, south, east, west
}
```

ä½¿ç”¨ `rawValue` è·å–å…¶å€¼ï¼š

```swift
print(Planet.earth.rawValue)
// Prints "3"

print(CompassPoint.south.rawValue)
// Prints "south"
```

`.earth` çš„åŸå§‹å€¼è¢«è‡ªåŠ¨åˆ†é…æˆäº† 3ï¼Œ`.south` çš„åŸå§‹å€¼è¢«è‡ªåŠ¨åˆ†é…æˆäº†å­—ç¬¦ä¸²â€œsouthâ€ã€‚

#### ä»åŸå§‹å€¼åˆå§‹åŒ–

æšä¸¾æä¾›äº†ä¸€ä¸ªé»˜è®¤åˆå§‹åŒ–å™¨ï¼Œè¯¥åˆå§‹åŒ–å™¨å¯ä»¥æ¥æ”¶ä¸€ä¸ªå½¢å¼å‚æ•° rawValueï¼Œè¿”å›ä¸€ä¸ªæšä¸¾æˆå‘˜æˆ–è€… nilã€‚

ä½¿ç”¨åˆå§‹åŒ–å™¨åˆ›å»ºä¸€ä¸ªæšä¸¾å®ä¾‹ï¼š

```swift
let possiblePlanet = Planet(rawValue: 7)
print(possiblePlanet!)
// Prints "uranus"
```

æˆ–è€…ï¼š

```swift
let positionToFind = 11
if let somePlanet = Planet(rawValue: positionToFind) {
    switch somePlanet {
    case .earth:
        print("earth")
    default:
        print("Not a safe place for humans")
    }
} else {
    print("There isn't a planet at position \(positionToFind)")
}
// Prints "There isn't a planet at position 11"
```

### é€’å½’æšä¸¾ï¼ˆindirectï¼‰

é€’å½’æšä¸¾ï¼šæšä¸¾æˆå‘˜çš„**å…³è”å€¼æ˜¯æšä¸¾**ã€‚

å› ä¸ºç¼–è¯‘å™¨åœ¨æ“ä½œé€’å½’æšä¸¾æ—¶å¿…é¡»æ’å…¥é—´æ¥å¯»å€å±‚ï¼Œæ‰€ä»¥åœ¨å£°æ˜æšä¸¾æ—¶éœ€è¦ä½¿ç”¨ `indirect` å…³é”®å­—æ¥æ˜ç¡®è¯¥æšä¸¾æ˜¯é€’å½’æšä¸¾ã€‚

å®ç° `(1 + 2) * 3`ï¼Œå…ˆç®—åŠ æ³•ï¼Œå†ç®—ä¹˜æ³•ï¼š

```swift
indirect enum ArithmeticExpression {
    case number(Int)
    case addition(ArithmeticExpression, ArithmeticExpression)
    case multiplication(ArithmeticExpression, ArithmeticExpression)
}

// æ‰§è¡Œå‡½æ•°
func evaluate(_ expression: ArithmeticExpression) -> Int {
    switch expression {
    case let .number(value):
        return value
    case let .addition(left, right):
        return evaluate(left) + evaluate(right)
    case let .multiplication(left, right):
        return evaluate(left) * evaluate(right)
    }
}

// (1 + 2) * 3
let one = ArithmeticExpression.number(1)
let two = ArithmeticExpression.number(2)
let sum = ArithmeticExpression.addition(one, two)
let product = ArithmeticExpression.multiplication(sum, ArithmeticExpression.number(3))

print(evaluate(product))
// Prints "9"
```

å› ä¸º `switch` å®ç°äº†æ‰€æœ‰ caseï¼Œæ‰€ä»¥ä¸ç”¨ `default` å­—æ®µã€‚

## å±æ€§

### å­˜å‚¨å±æ€§

å­˜å‚¨å±æ€§æ˜¯ç‰¹å®šç±»å’Œç»“æ„ä½“å®ä¾‹ä¸€éƒ¨åˆ†ï¼Œå¯ä»¥æ˜¯å˜é‡å­˜å‚¨å±æ€§ï¼ˆvarï¼‰ï¼Œä¹Ÿå¯ä»¥æ˜¯å¸¸é‡å­˜å‚¨å±æ€§ï¼ˆletï¼‰ã€‚

```swift
class DataManager {
    var fileName = "data.text"
    let filePath: String
    init(name: String, path: String) {
        fileName = name
        filePath = path
    }
}
```

#### å¸¸é‡ç»“æ„ä½“å®ä¾‹çš„å­˜å‚¨å±æ€§

å¦‚æœåˆ›å»ºäº†ä¸€ä¸ªç»“æ„ä½“çš„å®ä¾‹ï¼Œå¹¶ä¸”æŠŠå®ä¾‹èµ‹ç»™å¸¸é‡ï¼Œåˆ™ä¸èƒ½ä¿®æ”¹è¯¥å®ä¾‹çš„å±æ€§ï¼Œå³ä½¿æ˜¯å£°æ˜ä¸ºå˜é‡çš„å±æ€§ã€‚å³**å¸¸é‡ç»“æ„ä½“å®ä¾‹ï¼Œä¸å…è®¸ä¿®æ”¹å…¶å±æ€§**ã€‚

![01.png](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/01.png)

#### å»¶è¿Ÿå­˜å‚¨å±æ€§

åœ¨å£°æ˜å±æ€§æ—¶ï¼Œé€šè¿‡åœ¨å£°æ˜å‰é¢æ ‡æ³¨ `lazy` ä¿®æ”¹è¯­æ¥è¡¨ç¤ºä¸€ä¸ªå»¶è¿Ÿå­˜å‚¨å±æ€§ï¼Œå³**è¢« `lazy` ä¿®é¥°ç¬¦æ ‡è®°çš„å±æ€§**ã€‚å»¶è¿Ÿå­˜å‚¨å±æ€§çš„åˆå§‹å€¼ä¼šå»¶è¿Ÿåˆ°åœ¨å…¶ç¬¬ä¸€æ¬¡ä½¿ç”¨æ—¶æ‰è¿›è¡Œè®¡ç®—ã€‚

å»¶è¿Ÿå­˜å‚¨å±æ€§çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ï¼šåœ¨å»¶è¿Ÿå­˜å‚¨å±æ€§è¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–æ—¶ï¼ŒåŒæ—¶è¢«å¤šä¸ªçº¿ç¨‹è®¿é—®ï¼Œåˆ™**æ— æ³•ä¿è¯å±æ€§å€¼åªåˆå§‹åŒ–ä¸€æ¬¡**ã€‚

```swift
class DataImporter {
    var fileName = "data.text"
    init() {
        print("DataImporter inits")
    }
}

class DataManager {
    lazy var importer = DataImporter()
    var data = [String]()
}

let manager = DataManager()
manager.data.append("some data")
manager.data.append("some more data")
print("manager.data.append finish")
print(manager.importer.fileName)
```

æ‰“å°ç»“æœï¼š

```js
manager.data.append finish
DataImporter inits
data.text
```

â€œDataImporter initsâ€ æ˜¯åœ¨æ‰§è¡Œå®Œ `manager.data.append()`ï¼Œç›´åˆ°è°ƒç”¨ `print(manager.importer.fileName)` ä¹‹å‰æ‰æ‰“å°çš„ã€‚

### è®¡ç®—å±æ€§

ç±»ã€ç»“æ„ä½“å’Œæšä¸¾ä¹Ÿèƒ½å¤Ÿå®šä¹‰è®¡ç®—å±æ€§ï¼Œä¸å­˜å‚¨å±æ€§ä¸åŒï¼Œ**è®¡ç®—å±æ€§ä¸å­˜å‚¨å€¼**ã€‚è®¡ç®—å±æ€§é€šè¿‡æä¾›ä¸€ä¸ªè¯»å–å™¨å’Œä¸€ä¸ªè®¾ç½®å™¨ï¼Œé—´æ¥å®ç°è¯»å–å’Œä¿®æ”¹å…¶å®ƒçš„å±æ€§å’Œå€¼ã€‚

```swift
struct Point {
    var x = 0.0, y = 0.0
}
struct Size {
    var width = 0.0, height = 0.0
}
struct Rect {
    var origin = Point()
    var size = Size()
    var center: Point {
        get {
            let centerX = origin.x + (size.width / 2)
            let centerY = origin.y + (size.height / 2)
            return Point(x: centerX, y: centerY)
        }
        set(newCenter) {
            origin.x = newCenter.x - (size.width / 2)
            origin.y = newCenter.y - (size.height / 2)
        }
    }
}
```

#### ç®€å†™ setter

è®¡ç®—å±æ€§çš„è®¾ç½®å™¨æœ‰ä¸€ä¸ªé»˜è®¤çš„åå­— newValueï¼Œå¯ä»¥ä¸ç”¨ä¸ºè®¾ç½®å™¨ä¼ å…¥çš„å€¼å®šä¹‰åå­—ã€‚

```swift
struct Rect {
    var origin = Point()
    var size = Size()
    var center: Point {
        get {
            return Point(x: origin.x + (size.width / 2), y: origin.y + (size.height / 2))
        }
        set {
            origin.x = newValue.x - (size.width / 2)
            origin.y = newValue.y - (size.height / 2)
        }
    }
}
```

#### ç®€å†™ getter

å¦‚æœæ•´ä¸ªè¯»å–å™¨ getter çš„å‡½æ•°ä½“æ˜¯ä¸€ä¸ªå•ä¸€çš„è¡¨è¾¾å¼ï¼Œåˆ™ getter ä¼šéšå¼è¿”å›è¿™ä¸ªè¡¨è¾¾å¼ã€‚å¯ä»¥çœç•¥ returnï¼š

```swift
struct Rect {
    var origin = Point()
    var size = Size()
    var center: Point {
        get {
            Point(x: origin.x + (size.width / 2), y: origin.y + (size.height / 2))
        }
        set {
            origin.x = newValue.x - (size.width / 2)
            origin.y = newValue.y - (size.height / 2)
        }
    }
}
```

#### åªè¯»è®¡ç®—å±æ€§

åªè¯»è®¡ç®—å±æ€§ï¼šè®¡ç®—å±æ€§åªæœ‰è¯»å–å™¨ï¼Œæ²¡æœ‰è®¾ç½®å™¨ã€‚åªè¯»å±æ€§å¯ä»¥è¿”å›ä¸€ä¸ªå€¼ï¼Œä½†æ˜¯ä¸èƒ½ä¿®æ”¹ã€‚å¯ä»¥é€šè¿‡ç‚¹è¯­æ³•è®¿é—®åªè¯»è®¡ç®—å±æ€§ã€‚

å› ä¸ºè®¡ç®—å±æ€§çš„å€¼æ˜¯ä¸å›ºå®šçš„ï¼Œæ‰€ä»¥å¿…é¡»ç”¨ `var` å…³é”®å­—å®šä¹‰è®¡ç®—å±æ€§ä¸ºå˜é‡å±æ€§ï¼ŒåŒ…æ‹¬åªè¯»è®¡ç®—å±æ€§ã€‚

`let` å…³é”®å­—åªç”¨äºå¸¸é‡å±æ€§ï¼Œæ˜ç¡®å±æ€§åœ¨åˆå§‹åŒ–åå°±ä¸èƒ½æ›´æ”¹ã€‚

```swift
struct Rect {
    var origin = Point()
    var size = Size()
    var center: Point {
        get {
            Point(x: origin.x + (size.width / 2), y: origin.y + (size.height / 2))
        }
    }
}
```

æˆ–è€…ç®€å†™æˆï¼š

```swift
struct Rect {
    var origin = Point()
    var size = Size()
    var center: Point {
        return Point(x: origin.x + (size.width / 2), y: origin.y + (size.height / 2))
    }
}
```

### å±æ€§è§‚å¯Ÿè€…

`willSet` ä¼šåœ¨ä¸€ä¸ªæ–°å€¼**è¢«å­˜å‚¨ä¹‹å‰è¢«è°ƒç”¨**ã€‚æ–°çš„å±æ€§å€¼ä¼šä»¥å¸¸é‡å½¢å¼å‚æ•°ä¼ é€’ï¼Œé»˜è®¤åå­—ä¸º newValueï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰åå­—ã€‚
`didSet` ä¼šåœ¨ä¸€ä¸ªæ–°å€¼**è¢«å­˜å‚¨åè¢«è°ƒç”¨**ã€‚æ—§çš„å±æ€§å€¼ä¼šä»¥å¸¸é‡å½¢å¼å‚æ•°ä¼ é€’ï¼Œé»˜è®¤åå­—ä¸º oldValueï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰åå­—ã€‚å¦‚æœåœ¨å±æ€§çš„ `didSet` é‡Œç»™è¯¥å±æ€§èµ‹å€¼ï¼Œåˆ™ä¼šè¦†ç›– `willSet` é‡Œè®¾ç½®çš„å€¼ã€‚

```swift
class StepCounter {
    var totalSteps: Int = 0 {
        willSet(newTotalSteps) {
            print("About to set totalSteps to \(newTotalSteps)")
        }
        didSet {
            if totalSteps > oldValue {
                print("Added \(totalSteps - oldValue) steps")
            }
        }
    }
}

let stepCounter = StepCounter()
stepCounter.totalSteps = 200
stepCounter.totalSteps = 300
```

æ‰“å°ç»“æœï¼š

```js
About to set totalSteps to 200
Added 200 steps
About to set totalSteps to 300
Added 100 steps
```

#### å…¨å±€å’Œå±€éƒ¨å˜é‡

è§‚å¯Ÿå±æ€§çš„èƒ½åŠ›åŒæ ·å¯¹å…¨å±€å˜é‡å’Œå±€éƒ¨å˜é‡æœ‰æ•ˆã€‚å…¨å±€å˜é‡æ˜¯å®šä¹‰åœ¨ä»»ä½•å‡½æ•°ã€æ–¹æ³•ã€é—­åŒ…æˆ–è€…ç±»å‹ç¯å¢ƒä¹‹å¤–çš„å˜é‡ã€‚å±€éƒ¨å˜é‡æ˜¯å®šä¹‰åœ¨å‡½æ•°ã€æ–¹æ³•æˆ–è€…é—­åŒ…ç¯å¢ƒä¹‹ä¸­çš„å˜é‡ã€‚

```swift
var count: Int = 0 {
    willSet {
        print("About to set count to \(newValue)")
    }
    didSet {
        if count > oldValue {
            print("Added \(count - oldValue)")
        }
    }
}

count = 10
print(count)
```

æ‰“å°ç»“æœï¼š

```js
About to set count to 10
Added 10
10
```

### ç±»å‹å±æ€§ï¼ˆstaticï¼‰

ä½¿ç”¨ `static` å…³é”®å­—å®šä¹‰ç±»å‹å±æ€§ã€‚**ç±»ç±»å‹**çš„è®¡ç®—å±æ€§ï¼Œå¯ä»¥ä½¿ç”¨ `class` å…³é”®å­—æ¥å…è®¸å­ç±»é‡å†™çˆ¶ç±»çš„å®ç°ã€‚

```swift
class SomeClass {
    static var storedTypeProperty = "Some value."
    static var computedTypeProperty: Int {
        return 27
    }
    class var overrideableComputedTypeProperty: Int {
        return 107
    }
}
```

## æ–¹æ³•

### å®ä¾‹æ–¹æ³•

å®ä¾‹æ–¹æ³•æ˜¯å±äºç‰¹å®šç±»å®ä¾‹ã€ç»“æ„ä½“å®ä¾‹æˆ–è€…æšä¸¾å®ä¾‹çš„å‡½æ•°ã€‚å®ä¾‹æ–¹æ³•ä¸ºå®ä¾‹æä¾›åŠŸèƒ½æ€§ï¼Œå¯ä»¥æä¾›è®¿é—®å’Œä¿®æ”¹å±æ€§çš„æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥æä¾›ä¸å®ä¾‹ç›®çš„ç›¸å…³çš„åŠŸèƒ½ã€‚

å®šä¹‰ä¸€ä¸ª**ç±»**ï¼Œåœ¨å®ä¾‹æ–¹æ³•ä¸­ä¿®æ”¹**ç±»çš„å±æ€§**ï¼š

```swift
class Counter {
    var count = 0
    func increment() {
        count += 1
    }
    func increment(by amount: Int) {
        count += amount
    }
    func reset() {
        count = 0
    }
}
```

#### éšå«å±æ€§-self

æ¯ä¸€ä¸ªç±»çš„å®ä¾‹éƒ½éšå«ä¸€ä¸ª `self` å±æ€§ï¼Œå®ƒä»£è¡¨å®åŠ›æœ¬èº«ï¼Œå¯ä»¥ä½¿ç”¨å®ƒæ¥è°ƒç”¨å®ä¾‹æ–¹æ³•ã€‚

å¦‚æœæ²¡æœ‰æ˜¾ç¤ºçš„å†™å‡º `self`ï¼Œåˆ™åœ¨æ–¹æ³•ä¸­è°ƒç”¨å±æ€§æˆ–æ–¹æ³•æ—¶ï¼ŒSwift ä¼šå‡å®šè°ƒç”¨çš„æ˜¯å½“å‰å®ä¾‹ä¸­çš„å±æ€§æˆ–æ–¹æ³•ã€‚

ğŸ“¢æ³¨æ„ï¼šå½“å®ä¾‹æ–¹æ³•çš„å½¢å¼å‚æ•°åä¸æŸä¸ªå®ä¾‹å±æ€§åç›¸åŒæ—¶ï¼Œå½¢å¼å‚æ•°åå…·æœ‰ä¼˜å…ˆæƒï¼Œå¯ä»¥ä½¿ç”¨ `self` è°ƒç”¨å±æ€§æ¥åŒºåˆ†å½¢å¼å‚æ•°åå’Œå±æ€§åã€‚

```swift
struct Point {
    var x = 0.0, y = 0.0
    func isToTheRightOf(x: Double) -> Bool {
        return self.x > x
    }
}

let somePoint = Point(x: 2.0, y: 2.0)
if somePoint.isToTheRightOf(x: 1.0) {
    print("This point is to the right of the line where x == 1.0")
}

// Prints "This point is to the right of the line where x == 1.0"
```

#### åœ¨å®ä¾‹æ–¹æ³•ä¸­ä¿®æ”¹å±æ€§-mutatingï¼ˆå¼‚å˜æ–¹æ³•ï¼‰

ç»“æ„ä½“å’Œæšä¸¾æ˜¯å€¼ç±»å‹ï¼Œé»˜è®¤æƒ…å†µä¸‹ï¼Œ**å€¼ç±»å‹å±æ€§ä¸èƒ½è¢«è‡ªèº«çš„å®ä¾‹æ–¹æ³•ä¿®æ”¹**ã€‚å¯ä»¥åœ¨ `func` å…³é”®å­—å‰æ”¾ä¸€ä¸ª `mutating` å…³é”®å­—æ¥æŒ‡å®šæ–¹æ³•å¯ä»¥ä¿®æ”¹å±æ€§ã€‚

```swift
struct Point {
    var x = 0.0, y = 0.0
    mutating func moveBy(x deltaX: Double, y deltaY: Double) {
        x += deltaX
        y += deltaY
    }
}

var somePoint = Point(x: 1.0, y: 1.0)
somePoint.moveBy(x: 2.0, y: 3.0)
print("The point is now at (\(somePoint.x), \(somePoint.y))")
// Prints "The point is now at (3.0, 4.0)"
```

#### åœ¨ mutating æ–¹æ³•ä¸­èµ‹å€¼ç»™ self

ç»“æ„ä½“çš„å¼‚å˜æ–¹æ³•å¯ä»¥æŒ‡å®šæ•´ä¸ªå®ä¾‹ç»™éšå«çš„ `self` å±æ€§ã€‚

```swift
struct Point {
    var x = 0.0, y = 0.0
    mutating func moveBy(x deltaX: Double, y deltaY: Double) {
        self = Point(x: x + deltaX, y: y + deltaY)
    }
}

var somePoint = Point(x: 1.0, y: 1.0)
somePoint.moveBy(x: 2.0, y: 3.0)
print("The point is now at (\(somePoint.x), \(somePoint.y))")
// Prints "The point is now at (3.0, 4.0)"
```

#### æšä¸¾çš„ mutating æ–¹æ³•

æšä¸¾çš„å¼‚å˜æ–¹æ³•å¯ä»¥è®¾ç½®éšå«çš„ `self` å±æ€§ä¸ºç›¸åŒæšä¸¾é‡Œçš„ä¸åŒæˆå‘˜ã€‚

```swift
enum TriStateSwitch {
    case off, low, high
    mutating func next() {
        switch self {
        case .off:
            self = .low
        case .low:
            self = .high
        case .high:
            self = .off
        }
    }
}

var ovenLight = TriStateSwitch.off
ovenLight.next()
print(ovenLight)
// Prints "low"
```

### ç±»å‹æ–¹æ³•ï¼ˆstaticï¼‰

é€šè¿‡åœ¨ `func` å…³é”®å­—å‰é¢ä½¿ç”¨ `static` å…³é”®å­—æ¥æ˜ç¡®ä¸€ä¸ªç±»å‹æ–¹æ³•ã€‚ç±»åŒæ ·å¯ä»¥ä½¿ç”¨ `class` å…³é”®å­—æ¥å…è®¸å­ç±»é‡å†™çˆ¶ç±»å¯¹ç±»å‹æ–¹æ³•çš„å®ç°ã€‚

```swift
class SomeClass {
    class func someTypeMethod() {
        print("someTypeMethod")
    }
}
SomeClass.someTypeMethod()
// Prints "someTypeMethod"
```

## ä¸‹æ ‡

ç±»ã€ç»“æ„ä½“å’Œæšä¸¾å¯ä»¥å®šä¹‰ä¸‹æ ‡ï¼Œå®ƒå¯ä»¥ä½œä¸ºè®¿é—®é›†åˆã€åˆ—è¡¨æˆ–åºåˆ—æˆå‘˜å…ƒç´ çš„å¿«æ·æ–¹å¼ã€‚

ä¸‹æ ‡çš„ä½œç”¨ï¼š

1. å¯ä»¥é€šè¿‡ç´¢å¼•å€¼æ¥è®¾ç½®æˆ–æ£€ç´¢å€¼ï¼Œè€Œä¸ç”¨åˆ†åˆ«ä¸ºè®¾ç½®æˆ–æ£€ç´¢æä¾›å®ä¾‹æ–¹æ³•ã€‚

2. å¯ä»¥ä¸ºä¸€ä¸ªç±»å‹å®šä¹‰å¤šä¸ªä¸‹æ ‡ï¼Œä¸‹æ ‡ä¼šæ ¹æ®ä¼ å…¥çš„ç´¢å¼•å€¼çš„ç±»å‹ï¼Œé€‰æ‹©åˆé€‚çš„ä¸‹æ ‡é‡è½½ä½¿ç”¨ã€‚

3. å¯ä»¥ä½¿ç”¨å¤šä¸ªè¾“å…¥å½¢å‚æ¥å®šä¹‰ä¸‹æ ‡ï¼Œä»¥æ»¡è¶³è‡ªå®šä¹‰ç±»å‹çš„éœ€æ±‚ã€‚

### ä¸‹æ ‡è¯­æ³•ï¼ˆsubscriptï¼‰

ä½¿ç”¨å…³é”®å­— `subscript` å®šä¹‰ä¸‹æ ‡ã€‚ä¸å®ä¾‹æ–¹æ³•ç›¸åŒï¼Œå¯ä»¥æŒ‡å®šä¸€ä¸ªæˆ–å¤šä¸ªè¾“å…¥å½¢å¼å‚æ•°å’Œè¿”å›ç±»å‹ã€‚ä¸å®ä¾‹æ–¹æ³•ä¸åŒçš„æ˜¯ï¼Œä¸‹æ ‡å¯ä»¥æ˜¯è¯»å†™çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯åªè¯»çš„ã€‚

ä¸‹æ ‡è„šæœ¬ï¼ˆ`subscript`ï¼‰å…è®¸é€šè¿‡åœ¨å®ä¾‹ååé¢çš„**æ–¹æ‹¬å·å†…å†™ä¸€ä¸ªæˆ–å¤šä¸ªå€¼**ï¼Œå¯¹è¯¥ç±»çš„å®ä¾‹è¿›è¡ŒæŸ¥è¯¢ã€‚

```swift
struct TimesTable {
    let multiplier: Int
    subscript(index: Int) -> Int {
        return multiplier * index
    }
}

let threeTimesTable = TimesTable(multiplier: 3)
print("six times three is \(threeTimesTable[6])")
// Prints "six times three is 18"
```

### ä¸‹æ ‡å‚æ•°

1. ä¸‹æ ‡å¯ä»¥æ¥æ”¶ä»»æ„æ•°é‡çš„è¾“å…¥å½¢å¼å‚æ•°ï¼Œå¹¶ä¸”è¿™äº›è¾“å…¥å½¢å¼å‚æ•°å¯ä»¥æ˜¯ä»»æ„ç±»å‹ï¼›
2. ä¸‹æ ‡å¯ä»¥è¿”å›ä»»ä½•ç±»å‹ï¼›
3. ä¸‹æ ‡å¯ä»¥ä½¿ç”¨å˜é‡å½¢å¼å‚æ•°ï¼ˆ`var`ï¼‰å’Œå¯å˜å®è¡Œå‚æ•°ï¼ˆ`...`ï¼‰ï¼Œä½†æ˜¯ä¸èƒ½ä½¿ç”¨è¾“å…¥è¾“å‡ºå½¢å¼å‚æ•°ï¼ˆ`inout`ï¼‰ï¼Œä¹Ÿä¸èƒ½æä¾›é»˜è®¤å½¢å¼å‚æ•°ã€‚

### å®ä¾‹ä¸‹æ ‡

```swift
// çŸ©é˜µ
struct Matrix {
    // è¡Œï¼Œåˆ—
    let rows: Int, columns: Int
    // åæ ‡
    var grid: [Double]
    init(rows: Int, columns: Int) {
        self.rows = rows
        self.columns = columns
        grid = Array(repeating: 0.0, count: rows * columns)
    }
    func indexIsValid(row: Int, column: Int) -> Bool {
        return row >= 0 && row <= rows && columns >= 0 && columns <= columns
    }
    subscript(row: Int, column: Int) -> Double {
        get {
            assert(indexIsValid(row: row, column: column), "Index out of range")
            return grid[(row * columns) + column]
        }
        set {
            assert(indexIsValid(row: row, column: column), "Index out of range")
            grid[(row * columns) + column] = newValue
        }
    }
}

var matrix = Matrix(rows: 2, columns: 2)
matrix[0, 1] = 1.5
matrix[1, 0] = 3.2
print(matrix.grid)
// Prints "[0.0, 1.5, 3.2, 0.0]"
```

![02.png](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/02.png)

### ç±»å‹ä¸‹æ ‡ï¼ˆstaticï¼‰

é™¤äº†å®šä¹‰å®ä¾‹ä¸‹æ ‡å¤–ï¼Œä¹Ÿå¯ä»¥å®šä¹‰ç±»å‹æœ¬èº«çš„ä¸‹æ ‡ã€‚åœ¨ `subscript` å…³é”®å­—å‰åŠ  `static` å…³é”®å­—æ¥æ ‡è®°ç±»å‹ä¸‹æ ‡ã€‚

```swift
enum Planet: Int {
    case mercury = 1, venus, earth, mars, jupiter, saturn, uranus, neptune
    static subscript(n: Int) -> Planet {
        return Planet(rawValue: n)!
    }
}
let mars = Planet[3]
print(mars)
// Prints "earth"
```

åŒæ ·çš„ï¼Œä½¿ç”¨ `class` å…³é”®å­—ï¼Œå¯ä»¥å…è®¸å­ç±»é‡å†™çˆ¶ç±»çš„ä¸‹æ ‡å®ç°ã€‚

```swift
enum Planet: Int {
    case mercury = 1, venus, earth, mars, jupiter, saturn, uranus, neptune
    static subscript(n: Int) -> Planet {
        return Planet(rawValue: n)!
    }
}

class PlanetClass {
    class subscript(n: Int) -> Planet {
        return Planet[n]
    }
}

class SubPlanetClass {
    class subscript(n: Int) -> Planet {
        return Planet[n + 1]
    }
}

print(PlanetClass[3])
// Prints "earth"
print(SubPlanetClass[3])
// Prints "mars"
```

## åˆå§‹åŒ–å’Œååˆå§‹åŒ–

### åˆå§‹åŒ–å™¨

åˆå§‹åŒ–å™¨åœ¨åˆ›å»ºç‰¹å®šç±»å‹çš„å®ä¾‹æ—¶è¢«è°ƒç”¨ã€‚

å¦‚ä¸‹æ‰€ç¤ºï¼šåœ¨åˆå§‹åŒ–å™¨é‡Œç»™å­˜å‚¨å±æ€§è®¾ç½®åˆå§‹å€¼ï¼š

```swift
// æ¸©åº¦è®¡
struct Fahrenheit {
    var temperature: Double
    init() {
        temperature = 32.0
    }
}

var f = Fahrenheit()
print("The default temperature is \(f.temperature) Fahrenheit")
// Prints "The default temperature is 32.0 Fahrenheit"
```

### é»˜è®¤çš„å±æ€§å€¼

å­˜å‚¨å±æ€§çš„åˆå§‹å€¼ï¼Œå¯ä»¥åœ¨åˆå§‹åŒ–å™¨è®¾ç½®ï¼Œä¹Ÿå¯ä»¥**åœ¨å±æ€§å®šä¹‰çš„æ—¶å€™è®¾ç½®**ã€‚

å¦‚ä¸‹æ‰€ç¤ºï¼Œåœ¨å­˜å‚¨å±æ€§å®šä¹‰çš„æ—¶å€™è®¾ç½®åˆå§‹å€¼ï¼š

```swift
struct Fahrenheit {
    var temperature = 32.0
}

var f = Fahrenheit()
print("The default temperature is \(f.temperature) Fahrenheit")
// Prints "The default temperature is 32.0 Fahrenheit"
```

### é»˜è®¤çš„åˆå§‹åŒ–å™¨

å½“ç»“æ„ä½“æˆ–ç±»æ²¡æœ‰æä¾›åˆå§‹åŒ–å™¨æ—¶ï¼ŒSwfit ä¼šæä¾›ä¸€ä¸ªé»˜è®¤çš„åˆå§‹åŒ–å™¨ã€‚

æ²¡æœ‰æä¾›åˆå§‹åŒ–å™¨çš„**ç±»**ï¼Œå¿…é¡»è®¾ç½®é»˜è®¤å±æ€§å€¼ï¼š

```swift
class ShoppingListItem {
    var name: String?
    var quantity = 1
    var purchased = false
}

var item = ShoppingListItem()
```

æä¾›äº†åˆå§‹åŒ–å™¨çš„ç»“æ„ä½“æˆ–ç±»ï¼Œå¯ä»¥ä¸è®¾ç½®é»˜è®¤å±æ€§å€¼ï¼š

```swift
class ShoppingListItem {
    var name: String?
    var quantity: Int
    var purchased: Bool
    init() {
        quantity = 1
        purchased = false
    }
}

var item = ShoppingListItem()
```

### è‡ªå®šä¹‰åˆå§‹åŒ–

å¯ä»¥é€šè¿‡ä¸ºåˆå§‹åŒ–å™¨æ·»åŠ å½¢å¼å‚æ•°çš„æ–¹å¼ï¼Œå®ç°è‡ªå®šä¹‰ç±»å‹å’Œå€¼çš„åç§°ã€‚åˆå§‹åŒ–å½¢å¼å‚æ•°ä¸å‡½æ•°çš„å½¢å¼å‚æ•°å…·æœ‰ç›¸åŒçš„åŠŸèƒ½å’Œè¯­æ³•ã€‚

```swift
// æ‘„æ°åº¦
struct Celsius {
    var temperatureInCelsius: Double
    // åæ°æ¸©åº¦è®¡çš„(å†°ç‚¹ä¸º32åº¦ï¼Œæ²¸ç‚¹ä¸º212åº¦)
    init(fromFahrenheit fahrenheit: Double) {
        temperatureInCelsius = (fahrenheit - 32.0) / 1.8
    }
    // å¼€(å¼€å°”æ–‡æ¸©æ ‡çš„è®¡é‡å•ä½ï¼Œ1å¼€æ°åº¦ç›¸å½“äº1æ‘„æ°åº¦)
    init(fromKelvin kelvin: Double) {
        temperatureInCelsius = kelvin - 273.15
    }
}
// æ°´çš„æ²¸ç‚¹
let boilingPointOfWater = Celsius(fromFahrenheit: 212.0)
// æ°´çš„å†°ç‚¹
let freezingPointOfWater = Celsius(fromKelvin: 273.15)

print(boilingPointOfWater.temperatureInCelsius)
// Prints "100.0"
print(freezingPointOfWater.temperatureInCelsius)
// Prints "0.0"
```

### åœ¨åˆå§‹åŒ–ä¸­åˆ†é…å¸¸é‡å±æ€§

å¸¸é‡å±æ€§ï¼šèµ‹å€¼åä¸èƒ½ä¿®æ”¹ã€‚

åœ¨åˆå§‹åŒ–ç»“æŸå‰ï¼Œè¦ä¿è¯å¸¸é‡å±æ€§è¢«è®¾ç½®äº†ç¡®å®šçš„å€¼ï¼Œå¯ä»¥åœ¨åˆå§‹åŒ–çš„ä»»æ„æ—¶åˆ»è®¾ç½®ã€‚

```swift
class SurveyQuestion {
    let text: String
    var response: String?
    init(text: String) {
        self.text = text
    }
    func ask() {
        print(text)
    }
}

let beetsQuestion = SurveyQuestion(text: "How about beets?")
beetsQuestion.ask()
// Prints "How about beets?"
beetsQuestion.response = "I like beets."
```

### ç»“æ„ä½“çš„æˆå‘˜åˆå§‹åŒ–å™¨

å¦‚æœç»“æ„ä½“ç±»å‹ä¸­æ²¡æœ‰å®šä¹‰è‡ªå®šä¹‰åˆå§‹åŒ–å™¨ï¼Œç³»ç»Ÿä¼šæä¾›ä¸€ä¸ªé»˜è®¤çš„æˆå‘˜åˆå§‹åŒ–å™¨ã€‚æ²¡æœ‰æä¾›åˆå§‹åŒ–å™¨çš„**ç±»**ï¼Œå¿…é¡»è®¾ç½®é»˜è®¤å±æ€§å€¼ã€‚ä½†æ˜¯**ç»“æ„ä½“çš„**æˆå‘˜åˆå§‹åŒ–å™¨å…è®¸å­˜å‚¨å±æ€§æ²¡æœ‰é»˜è®¤å€¼ã€‚

```swift
struct Size {
    var width: Float, height = 0.0
}
let twoByTwo = Size(width: 1.0, height: 1.0)
print(twoByTwo)
// Prints "Size(width: 1.0, height: 1.0)"
```

### å€¼ç±»å‹çš„åˆå§‹åŒ–å™¨å§”æ‰˜

åˆå§‹åŒ–å™¨å§”æ‰˜ï¼šåˆå§‹åŒ–å™¨å¯ä»¥è°ƒç”¨å…¶ä»–åˆå§‹åŒ–å™¨æ¥æ‰§è¡Œéƒ¨åˆ†å®ä¾‹çš„åˆå§‹åŒ–ã€‚é¿å…äº†å¤šä¸ªåˆå§‹åŒ–å™¨é‡Œå†—ä½™ä»£ç ã€‚

```swift
struct Size {
    var width = 0.0, height = 0.0
}

struct Point {
    var x = 0.0, y = 0.0
}

struct Rect {
    var origin = Point()
    var size = Size()
    init() {
        self.init(origin: Point(x: 0.0, y: 0.0), size: Size(width: 2.0, height: 2.0))
    }
    // å€¼ç±»å‹çš„ç®€å•åˆå§‹åŒ–å™¨
    init(origin: Point, size: Size) {
        self.origin = origin
        self.size = size
    }
    init(center: Point, size: Size) {
        let originX = center.x - (size.width / 2)
        let originY = center.y - (size.height / 2)
        self.init(origin: Point(x: originX, y: originY), size: size)
    }
}

let rect1 = Rect()
let rect2 = Rect(center: Point(x: 1.0, y: 1.0), size: Size(width: 2.0, height: 2.0))
let rect3 = Rect(origin: Point(x: 0.0, y: 0.0), size: Size(width: 2.0, height: 2.0))
print("rect1: \(rect1.origin), \(rect1.size)")
// Prints "rect1: Point(x: 0.0, y: 0.0), Size(width: 2.0, height: 2.0)"
print("rect2: \(rect1.origin), \(rect1.size)")
// Prints "rect2: Point(x: 0.0, y: 0.0), Size(width: 2.0, height: 2.0)"
print("rect3: \(rect1.origin), \(rect1.size)")
// Prints "rect3: Point(x: 0.0, y: 0.0), Size(width: 2.0, height: 2.0)"
```

### ç±»çš„ç»§æ‰¿å’Œåˆå§‹åŒ–

### æŒ‡å®šåˆå§‹åŒ–å™¨å’Œä¾¿æ·åˆå§‹åŒ–å™¨ï¼ˆconvenienceï¼‰

ç”¨ä¸**å€¼ç±»å‹çš„ç®€å•åˆå§‹åŒ–å™¨**ç›¸åŒçš„æ–¹å¼ç±»å†™ç±»çš„**æŒ‡å®šåˆå§‹åŒ–å™¨**ï¼š

```swift
init(origin: Point, size: Size) {
    self.origin = origin
    self.size = size
}
```

å°† `convenience` ä¿®é¥°ç¬¦æ”¾åˆ° `init` å…³é”®å­—å‰å®šä¹‰**ä¾¿æ·åˆå§‹åŒ–å™¨**ï¼š

```swift
convenience init() {
    self.init(origin: Point(x: 0.0, y: 0.0), size: Size(width: 2.0, height: 2.0))
}
```

![03.png](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/03.png)

### ç±»çš„åˆå§‹åŒ–å§”æ‰˜

1. æŒ‡å®šåˆå§‹åŒ–**å¿…é¡»**ä»å®ƒçš„ç›´ç³»çˆ¶ç±»è°ƒç”¨æŒ‡å®šåˆå§‹åŒ–å™¨ï¼ˆå­ç±»å¿…é¡»è¦è°ƒç”¨çˆ¶ç±»ï¼‰ã€‚
2. ä¾¿æ·åˆå§‹åŒ–å™¨**å¿…é¡»**ä»ç›¸åŒçš„ç±»é‡Œè°ƒç”¨å¦ä¸€ä¸ªåˆå§‹åŒ–å™¨ï¼ˆä¾¿æ·åˆå§‹åŒ–å™¨æˆ–æŒ‡å®šåˆå§‹åŒ–å™¨ï¼‰ã€‚
3. ä¾¿æ·åˆå§‹åŒ–å™¨**æœ€ç»ˆ**å¿…é¡»è°ƒç”¨ä¸€ä¸ªæŒ‡å®šåˆå§‹åŒ–å™¨ã€‚

![04.png](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/04.png)

### ä¸¤æ®µå¼åˆå§‹åŒ–

Swift çš„ç±»åˆå§‹åŒ–æ˜¯ä¸€ä¸ªä¸¤æ®µå¼è¿‡ç¨‹ï¼š

* ç¬¬ä¸€é˜¶æ®µï¼š**æ¯ä¸€ä¸ª**å­˜å‚¨å±æ€§è¢«å¼•å…¥ç±»å¹¶åˆ†é…ä¸€ä¸ªåˆå§‹å€¼ã€‚
* ç¬¬äºŒé˜¶æ®µï¼šæ¯ä¸ªç±»éƒ½å¯ä»¥åœ¨æ–°çš„å®ä¾‹å‡†å¤‡ä½¿ç”¨ä¹‹å‰å®šåˆ¶å®ƒçš„å­˜å‚¨å±æ€§ã€‚

#### ä¸¤æ®µå¼åˆå§‹åŒ–-é˜¶æ®µä¸€

1. æŒ‡å®šåˆå§‹åŒ–å™¨æˆ–ä¾¿æ·åˆå§‹åŒ–å™¨åœ¨ç±»ä¸­è¢«**è°ƒç”¨**ï¼›
2. ä¸ºè¿™ä¸ªç±»çš„æ–°å®ä¾‹**åˆ†é…å†…å­˜**ï¼Œå†…å­˜è¿˜æ²¡æœ‰è¢«åˆå§‹åŒ–ï¼›
3. è¿™ä¸ªç±»çš„æŒ‡å®šåˆå§‹åŒ–å™¨ç¡®ä¿æ‰€æœ‰ç”±è¯¥ç±»å¼•å…¥çš„å­˜å‚¨å±æ€§éƒ½æœ‰ä¸€ä¸ªå€¼ã€‚ç°åœ¨è¿™äº›**å­˜å‚¨å±æ€§çš„å†…å­˜è¢«åˆå§‹åŒ–äº†**ï¼›
4. æŒ‡å®šåˆå§‹åŒ–å™¨ä¸Šäº¤**çˆ¶ç±»çš„åˆå§‹åŒ–å™¨**ä¸ºå…¶å­˜å‚¨å±æ€§æ‰§è¡Œç›¸åŒä»»åŠ¡ï¼›
5. è¿™ä¸ªè°ƒç”¨çˆ¶ç±»åˆå§‹åŒ–å™¨çš„è¿‡ç¨‹å°†æ²¿ç€**åˆå§‹åŒ–é“¾**ä¸€ç›´å‘ä¸Šè¿›è¡Œï¼Œç›´åˆ°åˆ°è¾¾åˆå§‹åŒ–å™¨é“¾çš„æœ€é¡¶éƒ¨ï¼›
6. ä¸€æ—¦è¾¾åˆ°åˆå§‹åŒ–å™¨çš„æœ€é¡¶éƒ¨ï¼Œåœ¨é“¾é¡¶éƒ¨çš„ç±»ç¡®ä¿æ‰€æœ‰çš„å­˜å‚¨å±æ€§éƒ½æœ‰ä¸€ä¸ªå€¼ï¼Œæ­¤å®ä¾‹çš„å†…å­˜è¢«è®¤ä¸º**å®Œå…¨åˆå§‹åŒ–**äº†ï¼Œæ­¤æ—¶ç¬¬ä¸€é˜¶æ®µå®Œæˆã€‚

![09.png](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/09.png)

#### ä¸¤æ®µå¼åˆå§‹åŒ–-é˜¶æ®µäºŒ

ä»é¡¶éƒ¨åˆå§‹åŒ–å™¨å¾€ä¸‹ï¼Œåˆå§‹åŒ–é“¾ä¸­çš„æ¯ä¸€ä¸ª**æŒ‡å®šåˆå§‹åŒ–å™¨**éƒ½æœ‰æœºä¼šè¿›ä¸€æ­¥å®šåˆ¶å®ä¾‹ã€‚åœ¨ç¬¬äºŒé˜¶æ®µï¼Œåˆå§‹åŒ–å™¨èƒ½å¤Ÿè®¿é—® `self`ï¼Œå¹¶ä¸”å¯ä»¥ä¿®æ”¹å®ƒçš„å±æ€§ã€è°ƒç”¨å®ƒçš„å®ä¾‹æ–¹æ³•ç­‰ç­‰ã€‚

æœ€ç»ˆï¼Œåˆå§‹åŒ–é“¾ä¸­ä»»ä½•**ä¾¿æ·åˆå§‹åŒ–å™¨**éƒ½æœ‰æœºä¼šå®šåˆ¶å®ä¾‹ä»¥åŠä½¿ç”¨ `self`ã€‚

![10.png](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/10.png)

### å®‰å…¨æ£€æŸ¥

1ã€æŒ‡å®šåˆå§‹åŒ–å™¨å¿…é¡»ä¿è¯åœ¨å‘ä¸Šå§”æ‰˜ç»™çˆ¶ç±»åˆå§‹åŒ–å™¨ä¹‹å‰ï¼Œ**å…¶æ‰€åœ¨çš„ç±»å¼•å…¥çš„æ‰€æœ‰å±æ€§**éƒ½è¦åˆå§‹åŒ–å®Œæˆã€‚ï¼ˆå­ç±»å¿…é¡»å…ˆåˆå§‹åŒ–è‡ªå·±çš„æ‰€æœ‰å±æ€§ï¼Œå†è°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–å™¨ï¼‰

![05.png](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/05.png)

2ã€æŒ‡å®šåˆå§‹åŒ–å™¨å¿…é¡»å…ˆå‘ä¸Šå§”æ‰˜çˆ¶ç±»åˆå§‹åŒ–å™¨ï¼Œç„¶åæ‰èƒ½ä¸º**ç»§æ‰¿çš„å±æ€§**è®¾ç½®æ–°å€¼ï¼Œå¦åˆ™æŒ‡å®šåˆå§‹åŒ–å™¨èµ‹äºˆçš„æ–°å€¼ä¼šè¢«çˆ¶ç±»ä¸­çš„åˆå§‹åŒ–å™¨æ‰€è¦†ç›–ã€‚ï¼ˆ**å­ç±»å¿…é¡»å…ˆè°ƒç”¨çˆ¶ç±»çš„åˆå§‹åŒ–å™¨ï¼Œå†åˆå§‹åŒ–çˆ¶ç±»çš„å±æ€§**ï¼‰

![06.png](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/06.png)

3ã€ä¾¿æ·åˆå§‹åŒ–å™¨å¿…é¡»å…ˆå§”æ‰˜åŒç±»ä¸­çš„å…¶å®ƒåˆå§‹åŒ–å™¨ï¼Œç„¶åå†ä¸º**ä»»æ„å±æ€§**èµ‹å€¼ï¼Œå¦åˆ™ä¾¿æ·åˆå§‹åŒ–å™¨èµ‹äºˆçš„æ–°å€¼ä¼šè¢«è‡ªå·±ç±»ä¸­å…¶å®ƒæŒ‡å®šåˆå§‹åŒ–å™¨æ‰€è¦†ç›–ã€‚

![07.png](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/07.png)

4ã€åˆå§‹åŒ–å™¨åœ¨ç¬¬ä¸€é˜¶æ®µåˆå§‹åŒ–å®Œæˆä¹‹å‰ï¼Œä¸èƒ½è°ƒç”¨ä»»ä½•å®ä¾‹æ–¹æ³•ã€ä¸èƒ½è¯»å–ä»»ä½•å®ä¾‹å±æ€§çš„å€¼ï¼Œä¹Ÿä¸èƒ½å¼•ç”¨ `self` ä½œä¸ºå€¼ã€‚

![08.png](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/08.png)

æ­£ç¡®çš„æ‰§è¡Œé¡ºåºï¼š

```swift
class Person {
    var name: String
    var age: Int
    init(name: String, age: Int) {
        self.name = name;
        self.age = age
    }
    convenience init() {
        self.init(name: "[unnamed]", age: 0)
    }
}

class Teacher: Person {
    var salary: Int
    init(name: String, age: Int, salary: Int) {
        // 1ã€åˆå§‹åŒ–è‡ªå®šä¹‰å±æ€§
        self.salary = salary
        // 2ã€å§”æ‰˜çˆ¶ç±»åˆå§‹åŒ–å™¨
        super.init(name: name, age: age)
        // 3ã€ä¿®æ”¹çˆ¶ç±»å±æ€§
        self.name = name + "è€å¸ˆ"
        // 4ã€è°ƒç”¨å®ä¾‹æ–¹æ³•
        self.showInfo()
    }
    convenience init(name: String) {
        self.init(name: name, age: 30, salary: 5000)
    }
    
    func showInfo() {
        print("teacher name \(name), age \(age), salary \(salary)")
    }
}

let teacher = Teacher(name: "kevin")
// Prints "teacher name kevinè€å¸ˆ, age 30, salary 5000"
```

### åˆå§‹åŒ–å™¨çš„ç»§æ‰¿å’Œé‡å†™ï¼ˆoverrideï¼‰

ä¸ Object-C ä¸­çš„å­ç±»ä¸åŒï¼ŒSwfit çš„å­ç±»ä¸ä¼šé»˜è®¤ç»§æ‰¿çˆ¶ç±»çš„åˆå§‹åŒ–å™¨ã€‚Swift çš„è¿™ç§æœºåˆ¶é˜²æ­¢çˆ¶ç±»çš„ç®€å•åˆå§‹åŒ–å™¨è¢«ä¸€ä¸ªæ›´ä¸“ç”¨çš„å­ç±»ç»§æ‰¿ï¼Œå¹¶è¢«ç”¨æ¥åˆ›å»ºä¸€ä¸ªæ²¡æœ‰å®Œå…¨åˆå§‹åŒ–æˆ–é”™è¯¯åˆå§‹åŒ–çš„æ–°å®ä¾‹çš„æƒ…å†µã€‚**åªæœ‰åœ¨ç‰¹å®šæƒ…å†µä¸‹æ‰ä¼šç»§æ‰¿çˆ¶ç±»çš„åˆå§‹åŒ–å™¨**ã€‚

å¦‚æœæƒ³è‡ªå®šä¹‰å­ç±»æ¥å®ç°ä¸€ä¸ªæˆ–å¤šä¸ªçˆ¶ç±»ç›¸åŒçš„åˆå§‹åŒ–å™¨ï¼Œå¯ä»¥åœ¨å­ç±»ä¸­ä¸ºåˆå§‹åŒ–å™¨æä¾›å®šåˆ¶çš„å®ç°ã€‚å¦‚æœæä¾›çš„å­ç±»åˆå§‹åŒ–å™¨å®Œå…¨åŒ¹é…çˆ¶ç±»æŒ‡å®šåˆå§‹åŒ–å™¨ï¼Œåˆ™å¯ä»¥é‡å†™çˆ¶ç±»çš„åˆå§‹åŒ–å™¨ã€‚**é€šè¿‡åœ¨å­ç±»åˆå§‹åŒ–å™¨å®šä¹‰çš„å‰é¢å†™ `override` ä¿®é¥°ç¬¦ï¼Œå®ç°å¯¹è¯¥æ–¹æ³•çš„é‡å†™ã€‚**åŒé»˜è®¤åˆå§‹åŒ–å™¨ä¸€æ ·ï¼Œå³ä½¿æ˜¯è‡ªåŠ¨æä¾›çš„é»˜è®¤åˆå§‹åŒ–å™¨ä¹Ÿå¯ä»¥é‡å†™ã€‚

### åˆå§‹åŒ–å™¨çš„è‡ªåŠ¨ç»§æ‰¿

è§„åˆ™1ï¼šå¦‚æœå­ç±»æ²¡æœ‰å®šä¹‰ä»»ä½•æŒ‡å®šåˆå§‹åŒ–å™¨ï¼Œå®ƒä¼šè‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»æ‰€æœ‰çš„**æŒ‡å®šåˆå§‹åŒ–å™¨**ã€‚

è§„åˆ™2ï¼šå¦‚æœå­ç±»æä¾›äº†æ‰€æœ‰çˆ¶ç±»æŒ‡å®šåˆå§‹åŒ–å™¨çš„å®ç°â€”â€”è¦ä¹ˆæ˜¯é€šè¿‡è§„åˆ™1ç»§æ‰¿æ¥çš„ï¼Œè¦ä¹ˆé€šè¿‡åœ¨å®šä¹‰ä¸­æä¾›è‡ªå®šä¹‰å®ç°çš„â€”â€”é‚£ä¹ˆå®ƒè‡ªåŠ¨ç»§æ‰¿çˆ¶ç±»æ‰€æœ‰çš„**ä¾¿æ·åˆå§‹åŒ–å™¨**ã€‚

### å¯å¤±è´¥åˆå§‹åŒ–å™¨ï¼ˆinit?/init!ï¼‰

ç±»ã€ç»“æ„ä½“æˆ–æšä¸¾çš„å¯å¤±è´¥åˆå§‹åŒ–å™¨å¼•ç”¨åœºæ™¯ï¼š

1. åˆå§‹åŒ–ä¼ å…¥æ— æ•ˆçš„å½¢å¼å‚æ•°å€¼ï¼›
2. ç¼ºå°‘æŸç§å¤–éƒ¨æ‰€éœ€çš„èµ„æºï¼›
3. å…¶ä»–é˜»æ­¢åˆå§‹åŒ–çš„æƒ…å†µã€‚

å®šä¹‰æ–¹å¼ï¼š

1. é€šè¿‡åœ¨ `init` å…³é”®å­—åé¢æ·»åŠ é—®å·ï¼ˆ`init?`ï¼‰çš„æ–¹å¼æ¥å®šä¹‰ä¸€ä¸ªå¯å¤±è´¥åˆå§‹åŒ–å™¨ä»¥åˆ›å»ºä¸€ä¸ªåˆé€‚ç±»å‹çš„å¯é€‰é¡¹å®ä¾‹ã€‚

2. é€šè¿‡åœ¨ `init` å…³é”®å­—åé¢æ·»åŠ æƒŠå¹å·ï¼ˆ`init!`ï¼‰çš„æ–¹å¼æ¥å®šä¹‰ä¸€ä¸ªå¯å¤±è´¥åˆå§‹åŒ–å™¨ä»¥åˆ›å»ºä¸€ä¸ª**éšå¼å±•å¼€**å…·æœ‰åˆé€‚ç±»å‹çš„å¯é€‰é¡¹å®ä¾‹ã€‚

### å¿…è¦åˆå§‹åŒ–å™¨ï¼ˆrequiredï¼‰

åœ¨ç±»çš„åˆå§‹åŒ–å™¨å‰æ·»åŠ  `required` ä¿®é¥°ç¬¦æ¥è¡¨æ˜æ‰€æœ‰è¯¥ç±»çš„å­ç±»éƒ½å¿…é¡»å®ç°è¯¥åˆå§‹åŒ–å™¨ã€‚

### ååˆå§‹åŒ–ï¼ˆdeinitï¼‰

åœ¨ç±»çš„**å®ä¾‹è¢«é‡Šæ”¾**çš„æ—¶å€™ï¼Œååˆå§‹åŒ–å™¨å°±ä¼šç«‹å³è¢«è°ƒç”¨ã€‚ä½¿ç”¨ `deinit` å…³é”®å­—æ¥å†™ååˆå§‹åŒ–å™¨ï¼ŒåŒå†™åˆå§‹åŒ–å™¨è¦ç”¨ `init` å…³é”®å­—ä¸€æ ·ã€‚ååˆå§‹åŒ–å™¨åªåœ¨ç±»ç±»å‹ä¸­æœ‰æ•ˆã€‚

ååˆå§‹åŒ–å™¨çš„è°ƒç”¨æ—¶æœºï¼š

1. ååˆå§‹åŒ–å™¨ä¼šåœ¨å®ä¾‹è¢«é‡Šæ”¾ä¹‹å‰è‡ªåŠ¨è¢«è°ƒç”¨ã€‚
2. ä¸èƒ½è‡ªè¡Œè°ƒç”¨ååˆå§‹åŒ–å™¨ã€‚
3. çˆ¶ç±»çš„ååˆå§‹åŒ–å™¨å¯ä»¥è¢«å­ç±»ç»§æ‰¿ï¼Œå¹¶ä¸”å­ç±»çš„ååˆå§‹åŒ–å™¨å®ç°ç»“æŸä¹‹åçˆ¶ç±»çš„ååˆå§‹åŒ–å™¨ä¼šè¢«è°ƒç”¨ã€‚
4. çˆ¶ç±»çš„ååˆå§‹åŒ–å™¨æ€»ä¼šè¢«è°ƒç”¨ï¼Œå°±ç®—å­ç±»æ²¡æœ‰ååˆå§‹åŒ–å™¨ã€‚

æ¯ä¸ªç±»å½“ä¸­åªèƒ½æœ‰ä¸€ä¸ªååˆå§‹åŒ–å™¨ã€‚ååˆå§‹åŒ–å™¨ä¸æ¥æ”¶ä»»ä½•å½¢å¼å‚æ•°ï¼Œå¹¶ä¸”ä¸éœ€è¦å†™åœ†æ‹¬å·ã€‚

```swift
deinit {
    // perform the deinitialization
}
```

## ç»§æ‰¿

### å®šä¹‰åŸºç±»

Swift ç±»ä¸ä¼šä»ä¸€ä¸ªé€šç”¨åŸºç±»ç»§æ‰¿ï¼Œ**ä»»ä½•ä¸ä»å¦ä¸€ä¸ªç±»ç»§æ‰¿çš„ç±»éƒ½æ˜¯æ‰€è°“çš„åŸºç±»**ã€‚å¦‚æœæ²¡æœ‰æŒ‡å®šç‰¹å®šçˆ¶ç±»çš„ç±»éƒ½ä¼šä»¥åŸºç±»çš„å½¢å¼åˆ›å»ºã€‚

```swift
/// å®šä¹‰ä¸€ä¸ªäº¤é€šå·¥å…·ç±»
class Vehicle {
    var currentSpeed = 0.0
    var description: String {
        return "traveling at \(currentSpeed) miles per hour"
    }
    func makeNoise() {
        // to do
    }
}
```

### å­ç±»

**å­ç±»æ˜¯åŸºäºç°æœ‰ç±»åˆ›å»ºæ–°ç±»çš„è¡Œä¸º**ã€‚å­ç±»ä»ç°æœ‰çš„ç±»ç»§æ‰¿äº†ä¸€äº›ç‰¹å¾ï¼Œå¯ä»¥é‡æ–°å®šä¹‰ç»§æ‰¿æ¥çš„ç‰¹å¾ï¼Œä¹Ÿå¯ä»¥ä¸ºå­ç±»æ·»åŠ æ–°çš„ç‰¹å¾ã€‚ä¸ºäº†è¡¨æ˜å­ç±»æœ‰çˆ¶ç±»ï¼Œè¦æŠŠå­ç±»å†™åœ¨çˆ¶ç±»çš„å‰é¢ï¼Œç”¨å†’å·åˆ†éš”ï¼ˆ`subClass : superClass`ï¼‰ã€‚

```swift
/// å®šä¹‰ä¸€ä¸ªè‡ªè¡Œè½¦ç±»ï¼Œç»§æ‰¿è‡ªäº¤é€šå·¥å…·ç±»
class Bicycle : Vehicle {
    // è‡ªå®šä¹‰æ–°çš„å±æ€§ï¼Œæ˜¯å¦æœ‰è½¦ç­
    var hasBasket = false
}

let bicycle = Bicycle()
bicycle.hasBasket = true
bicycle.currentSpeed = 15.0
print("Bicycle: \(bicycle.description)")
// Prints "Bicycle: traveling at 15.0 miles per hour"
```

### é‡å†™ï¼ˆoverrideï¼‰

é‡å†™ï¼šå­ç±»å¯ä»¥æä¾›è‡ªå·±çš„å®ä¾‹æ–¹æ³•ã€ç±»å‹æ–¹æ³•ã€å®ä¾‹å±æ€§ã€ç±»å‹å±æ€§æˆ–ä¸‹æ ‡è„šæœ¬çš„è‡ªå®šä¹‰å®ç°ï¼Œå¦åˆ™å­ç±»å°†ä¼šä»çˆ¶ç±»ç»§æ‰¿ã€‚

å¦‚æœæƒ³è¦é‡å†™è€Œä¸æ˜¯ç»§æ‰¿ä¸€ä¸ªç‰¹å¾ï¼Œéœ€è¦åœ¨é‡å†™å®šä¹‰å‰é¢åŠ ä¸Š `override` å…³é”®å­—ï¼Œè¡¨æ˜æä¾›ä¸€ä¸ªé‡å†™ï¼Œè€Œä¸æ˜¯é¢å¤–æä¾›ä¸€ä¸ªç›¸åŒçš„å®šä¹‰ã€‚é¢å¤–æä¾›ä¸€ä¸ªç›¸åŒçš„å®šä¹‰å¯èƒ½å¯¼è‡´æ„æƒ³ä¸åˆ°çš„è¡Œä¸ºï¼Œå¹¶ä¸”ä»»ä½•æ²¡æœ‰ä½¿ç”¨ `override` å…³é”®å­—çš„é‡å†™éƒ½ä¼šåœ¨ç¼–è¯‘æ—¶æŠ¥é”™ã€‚

### è®¿é—®çˆ¶ç±»çš„æ–¹æ³•ã€å±æ€§å’Œä¸‹æ ‡è„šæœ¬

å¯ä»¥é€šè¿‡ä½¿ç”¨ `super` å‰ç¼€è®¿é—®çˆ¶ç±»çš„æ–¹æ³•ã€å±æ€§æˆ–ä¸‹æ ‡è„šæœ¬ã€‚

1. ä¸€ä¸ªå‘½åä¸º `somoeMethod()` çš„é‡å†™æ–¹æ³•å¯ä»¥é€šè¿‡ `super.someMethod()` åœ¨é‡å†™æ–¹æ³•çš„å®ç°ä¸­è°ƒç”¨çˆ¶ç±»ç‰ˆæœ¬çš„ `someMethod()` æ–¹æ³•ã€‚
2. ä¸€ä¸ªå‘½åä¸º `someProperty` çš„é‡å†™å±æ€§å¯ä»¥é€šè¿‡ `super.someProperty` åœ¨é‡å†™çš„ getter æˆ– setter å®ç°ä¸­è®¿é—®çˆ¶ç±»ç‰ˆæœ¬çš„ `someProperty` å±æ€§ã€‚
3. ä¸€ä¸ªå‘½åä¸º `someIndex` çš„é‡å†™ä¸‹æ ‡è„šæœ¬å¯ä»¥é€šè¿‡ `super[someIndex]` åœ¨é‡å†™çš„ä¸‹æ ‡è„šæœ¬å®ç°ä¸­è®¿é—®çˆ¶ç±»ç‰ˆæœ¬ä¸­ç›¸åŒçš„ä¸‹æ ‡è„šæœ¬ã€‚

### é‡å†™æ–¹æ³•

åœ¨å­ç±»ä¸­é‡å†™ä¸€ä¸ªç»§æ‰¿çš„å®ä¾‹æ–¹æ³•æˆ–ç±»å‹æ–¹æ³•æ¥æä¾›å®šåˆ¶çš„æˆ–æ›¿ä»£çš„æ–¹æ³•å®ç°ã€‚

```swift
class Vehicle {
    var currentSpeed = 0.0
    var description: String {
        return "traveling at \(currentSpeed) miles per hour"
    }
    func makeNoise() {
        // to do
    }
}

/// å®šä¹‰ä¸€ä¸ªç«è½¦ç±»ï¼Œç»§æ‰¿è‡ªäº¤é€šå·¥å…·ç±»
class Train: Vehicle {
    // é‡å†™å‘å£°æ–¹æ³•
    override func makeNoise() {
        print("ç«è½¦é¸£ç¬›~")
    }
}

let train = Train()
train.makeNoise()
// Prints "ç«è½¦é¸£ç¬›~"
```

### é‡å†™å±æ€§çš„ getter å’Œ setter

å¯ä»¥æä¾›ä¸€ä¸ªè‡ªå®šä¹‰çš„ `getter` æˆ– `setter` æ–¹æ³•æ¥é‡å†™ä»»æ„ç»§æ‰¿çš„å±æ€§ï¼ˆå­˜å‚¨å±æ€§æˆ–è®¡ç®—å±æ€§ï¼‰ã€‚

```swift
class Car: Vehicle {
    var gear = 1
    override var description: String {
        return super.description + " in gear \(gear)"
    }
}
let car = Car()
car.currentSpeed = 25.0
car.gear = 3
print("Car: \(car.description)")
// Prints "Car: traveling at 25.0 miles per hour in gear 3"
```

### é‡å†™å±æ€§çš„è§‚å¯Ÿå™¨

å¯ä»¥ä½¿ç”¨å±æ€§é‡å†™æ¥ä¸ºç»§æ‰¿çš„å±æ€§æ·»åŠ å±æ€§è§‚å¯Ÿå™¨ï¼ˆ`willSet`ã€`didSet`ï¼‰ã€‚

æ³¨æ„ï¼š

1. å› ä¸ºå¸¸é‡å­˜å‚¨å±æ€§ï¼ˆ`let`ï¼‰å’Œåªè¯»çš„è®¡ç®—å±æ€§ï¼ˆ`readonly`ï¼‰ä¸æ”¯æŒæ”¹å˜ï¼Œæ‰€ä»¥ä¸èƒ½æä¾› `willSet` å’Œ `didSet` æ¥ç›‘å¬å€¼çš„æ”¹å˜ï¼ˆå®ƒä»¬ä¸ä¼šå˜ï¼‰ã€‚
2. ä¸èƒ½ä¸ºåŒä¸€ä¸ªå±æ€§åŒæ—¶æä¾›é‡å†™çš„ `setter` å’Œé‡å†™çš„å±æ€§è§‚å¯Ÿå™¨ã€‚è‡ªå®šä¹‰çš„ `setter` å°±å¯ä»¥å®ç°ç›‘å¬å€¼çš„æ”¹å˜ã€‚

```swift
class AutomaticCar: Car {
    override var currentSpeed: Double {
        didSet {
            gear = Int(currentSpeed / 10.0) + 1
        }
    }
}

let automaticCar = AutomaticCar()
automaticCar.currentSpeed = 35.0
print("AutomaticCar: \(automaticCar.description)")
// Prints "AutomaticCar: traveling at 35.0 miles per hour in gear 4"
```

### ç»„ç»‡é‡å†™ï¼ˆfinalï¼‰

é€šè¿‡åœ¨æ–¹æ³•ã€å±æ€§æˆ–è€…ä¸‹æ ‡ç”²è‹¯çš„å…³é”®å­—å‰å†™ `final` ä¿®é¥°ç¬¦ï¼Œæ¥é˜»æ­¢å…¶è¢«é‡å†™ï¼ˆå¦‚ï¼š`final var`ï¼Œ`final func`ï¼Œ`final class func`ï¼Œ`final subscript`ï¼‰ã€‚

## å¤šæ€

å¤šæ€æ˜¯é¢å‘å¯¹è±¡ä¸‰å¤§ç‰¹æ€§ä¹‹ä¸€ï¼ŒæŒ‡åŒä¸€ä¸ªæ–¹æ³•åœ¨ä¸åŒçš„å¯¹è±¡ä¸Šæœ‰ä¸åŒçš„å®ç°æ–¹å¼ã€‚

### ç±»å‹

```swift
class MediaItem {
    var name: String
    init(name: String) {
        self.name = name
    }
}

class Movie: MediaItem {
    var director: String
    init(name: String, director: String) {
        self.director = director
        super.init(name: name)
    }
}

class Song: MediaItem {
    var artist: String
    init(name: String, artist: String) {
        self.artist = artist
        super.init(name: name)
    }
}

let library = [
    Movie(name: "Casablanca", director: "Michael Curtiz"),
    Song(name: "Blue Suede Shoes", artist: "Elvis Presley"),
    Movie(name: "Citizen Kane", director: "Orson Welles"),
    Song(name: "The One And Only", artist: "Chesney Hawkes"),
    Song(name: "Never Gonna Give You Up", artist: "Rick Astley")
]

print(type(of: library))
// Prints "Array<MediaItem>"

let library1 = [
    Movie(name: "Casablanca", director: "Michael Curtiz")
]
print(type(of: library1))
// Prints "Array<Movie>"

let library2 = [
    Song(name: "Blue Suede Shoes", artist: "Elvis Presley")
]
print(type(of: library2))
// Prints "Array<Song>"
```

### ç±»å‹æ£€æŸ¥ï¼ˆisï¼‰

ä½¿ç”¨ç±»å‹æ£€æŸ¥æ“ä½œç¬¦`is`æ¥æ£€æŸ¥**ä¸€ä¸ªå®ä¾‹æ˜¯å¦å±äºä¸€ä¸ªç‰¹å®šçš„å­ç±»**ï¼Œå¦‚æœå®ä¾‹æ˜¯è¯¥å­ç±»ç±»å‹ï¼Œç±»å‹æ£€æŸ¥æ“ä½œç¬¦è¿”å› trueï¼Œå¦åˆ™è¿”å› falseã€‚

```swift
class MediaItem {
    var name: String
    init(name: String) {
        self.name = name
    }
}

class Movie: MediaItem {
    var director: String
    init(name: String, director: String) {
        self.director = director
        super.init(name: name)
    }
}

class Song: MediaItem {
    var artist: String
    init(name: String, artist: String) {
        self.artist = artist
        super.init(name: name)
    }
}

let library = [
    Movie(name: "Casablanca", director: "Michael Curtiz"),
    Song(name: "Blue Suede Shoes", artist: "Elvis Presley"),
    Movie(name: "Citizen Kane", director: "Orson Welles"),
    Song(name: "The One And Only", artist: "Chesney Hawkes"),
    Song(name: "Never Gonna Give You Up", artist: "Rick Astley")
]

print(type(of: library))

for item in library {
    if item is Song {
        print(item.name)
    }
}
```

æ‰“å°ç»“æœï¼š

```js
Array<MediaItem>
Blue Suede Shoes
The One And Only
Never Gonna Give You Up
```

### å‘ä¸‹ç±»å‹è½¬æ¢ï¼ˆas?/as!ï¼‰

æŸä¸ª**ç±»ç±»å‹**çš„å¸¸é‡æˆ–å˜é‡å¯èƒ½å®é™…ä¸Šå¼•ç”¨è‡ªä¸€ä¸ªå­ç±»çš„å®ä¾‹ï¼Œå¯ä»¥ä½¿ç”¨ç±»å‹è½¬æ¢æ“ä½œç¬¦`as?`æˆ–`as!`å°†å®ƒå‘ä¸‹ç±»å‹è½¬æ¢è‡³å…¶å­ç±»ç±»å‹ã€‚å› ä¸ºå‘ä¸‹ç±»å‹è½¬æ¢å¯èƒ½å¤±è´¥ï¼Œæ‰€ä»¥ç±»å‹è½¬æ¢æ“ä½œç¬¦æœ‰ä¸¤ä¸ªä¸åŒçš„å½¢å¼`as?`å’Œ`as!`ã€‚

1. `as?`ï¼Œæ¡ä»¶å½¢å¼ï¼Œè¿”å›ä¸€ä¸ªå°†è¦å‘ä¸‹ç±»å‹è½¬æ¢çš„å€¼çš„å¯é€‰é¡¹ã€‚
2. `as!`ï¼Œå¼ºåˆ¶å½¢å¼ï¼Œå°†å‘ä¸‹ç±»å‹è½¬æ¢å’Œ**å¼ºåˆ¶å±•å¼€**ç»“åˆä¸ºä¸€ä¸ªæ­¥éª¤ã€‚

```swift
class MediaItem {
    var name: String
    init(name: String) {
        self.name = name
    }
}

class Movie: MediaItem {
    var director: String
    init(name: String, director: String) {
        self.director = director
        super.init(name: name)
    }
}

class Song: MediaItem {
    var artist: String
    init(name: String, artist: String) {
        self.artist = artist
        super.init(name: name)
    }
}

let library = [
    Movie(name: "Casablanca", director: "Michael Curtiz"),
    Song(name: "Blue Suede Shoes", artist: "Elvis Presley"),
    Movie(name: "Citizen Kane", director: "Orson Welles"),
    Song(name: "The One And Only", artist: "Chesney Hawkes"),
    Song(name: "Never Gonna Give You Up", artist: "Rick Astley")
]

print(type(of: library))

for item in library {
    if let song = item as? Song {
        print("Song: \(song.name)")
    }
}
```

æ‰“å°ç»“æœï¼š

```js
Array<MediaItem>
Song: Blue Suede Shoes
Song: The One And Only
Song: Never Gonna Give You Up
```

### ä¸ç¡®å®šç±»å‹ Any å’Œ AnyObject

Swift ä¸ºä¸ç¡®å®šçš„ç±»å‹æä¾›äº†ä¸¤ç§ç‰¹æ®Šçš„ç±»å‹åˆ«åï¼š

1. `AnyObject`ï¼šè¡¨ç¤º**ä»»ä½•ç±»ç±»å‹**çš„å®ä¾‹ã€‚
2. `Any`ï¼šè¡¨ç¤º**ä»»ä½•ç±»å‹**ï¼ŒåŒ…æ‹¬å‡½æ•°ç±»å‹ã€‚

### åµŒå¥—ç±»å‹

Swift ä¸­çš„ç±»ã€ç»“æ„ä½“å’Œæšä¸¾å¯ä»¥è¿›è¡ŒåµŒå¥—ï¼Œå³**åœ¨æŸä¸€ä¸ªç±»å‹çš„å†…éƒ¨å®šä¹‰ç±»å‹**ï¼ŒåµŒå¥—ç±»å‹èƒ½å¤Ÿè®¿é—®å®ƒå¤–éƒ¨çš„æˆå‘˜ã€‚

è¿™ç§ç±»å‹åµŒå¥—åœ¨ Java ä¸­ç§°ä¸ºå†…éƒ¨ç±»ï¼Œåœ¨ C# ä¸­ç§°ä¸ºåµŒå¥—ç±»ã€‚

åµŒå¥—ç±»

```swift
class Person {
    var body = Body() 
    
    class Body {
        var height = 175
        var weight = 80
        func profile() -> String {
            return "Height: \(self.height), Weight: \(self.weight)"
        }
    }
}

let p = Person()
print(p.body.profile())
// Prints "Height: 175, Weight: 80"
```

åµŒå¥—ç»“æ„ä½“

```swift
struct Shapes {
    struct Line {
        var x = 0
        var y = 0
        var length = 0
    }
    
    struct Rectangle {
        var x = 0
        var y = 0
        var width = 0
        var height = 0
        var area = 0
    }
    
    struct Circle {
        let pi = 3.1415926
        var radius = 0.0
    }
}

var c = Shapes.Circle()
c.radius = 45.0
```

## æ‰©å±•

æ‰©å±•ä¸ºç°æœ‰çš„ç±»ã€ç»“æ„ä½“ã€æšä¸¾ç±»å‹æˆ–åè®®æ·»åŠ äº†æ–°åŠŸèƒ½ï¼ŒåŒ…æ‹¬ä¸ºæ— è®¿é—®æƒé™çš„æºä»£ç æ‰©å±•ç±»å‹çš„èƒ½åŠ›ï¼ˆé€†å‘å»ºæ¨¡ï¼‰ã€‚

æ‰©å±•å’Œ Object-C ä¸­çš„ category ç±»ä¼¼ï¼Œä¸ Object-C çš„åˆ†ç±»ä¸åŒçš„æ˜¯ Swift çš„æ‰©å±•æ²¡æœ‰åå­—ã€‚

```swift
class Person {

}

// æ‰©å±•ï¼šè®© Person å®ç° Hashable åè®®
extension Person : Hashable {

}
```

### æ‰©å±•ï¼ˆextensionï¼‰çš„èƒ½åŠ›

1. æ·»åŠ è®¡ç®—å®ä¾‹å±æ€§å’Œè®¡ç®—ç±»å‹å±æ€§ï¼›
2. å®šä¹‰å®ä¾‹æ–¹æ³•å’Œç±»å‹æ–¹æ³•ï¼›
3. æä¾›æ–°åˆå§‹åŒ–å™¨ï¼›
4. å®šä¹‰ä¸‹æ ‡ï¼›
5. å®šä¹‰å’Œä½¿ç”¨æ–°å†…åµŒç±»å‹ï¼›
6. ä½¿ç°æœ‰çš„ç±»å‹éµå¾ªæŸäº›ä»¥ã€‚
7. **æ‰©å±•å¯ä»¥å‘ä¸€ä¸ªç±»å‹æ·»åŠ æ–°çš„æ–¹æ³•ï¼Œä½†æ˜¯ä¸èƒ½é‡å†™å·²æœ‰çš„æ–¹æ³•ã€‚**

#### æ‰©å±•çš„èƒ½åŠ›-è®¡ç®—å±æ€§

* æ‰©å±•å¯ä»¥å‘å·²æœ‰çš„ç±»å‹æ·»åŠ è®¡ç®—å®ä¾‹å±æ€§å’Œè®¡ç®—ç±»å‹å±æ€§ã€‚

```swift
extension Double {
    var km: Double { return self * 1_000.0 }
    var m: Double { return self }
    var cm: Double { return self / 100.0 }
    var mm: Double { return self / 1_000.0 }
    var ft: Double { return self / 3.28084 }
}
let oneInch = 25.4.mm
print("One inch is \(oneInch) meters")
let threeFeet = 3.ft
print("Three feet is \(threeFeet) meters")
```

æ‰“å°ç»“æœï¼š

```swift
One inch is 0.0254 meters
Three feet is 0.914399970739201 meters
```

#### æ‰©å±•çš„èƒ½åŠ›-åˆå§‹åŒ–å™¨

* æ‰©å±•å¯ä»¥å‘å·²æœ‰çš„ç±»å‹æ·»åŠ æ–°çš„åˆå§‹åŒ–å™¨ã€‚

é€šè¿‡æ‰©å±•å¯ä»¥ä½¿åˆå§‹åŒ–å™¨æ¥æ”¶è‡ªå®šä¹‰ç±»å‹ä½œä¸ºå½¢å¼å‚æ•°ï¼Œä¹Ÿå¯ä»¥æä¾›è¯¥ç±»å‹åŸå§‹å®ç°ä¸­æœªåŒ…å«çš„é¢å¤–åˆå§‹åŒ–é€‰é¡¹ã€‚

æ‰©å±•èƒ½ä¸ºç±»æ·»åŠ æ–°çš„**ä¾¿æ·åˆå§‹åŒ–å™¨**ï¼Œä½†æ˜¯ä¸èƒ½æ·»æŒ‡å®šåˆå§‹åŒ–æˆ–ååˆå§‹åŒ–å™¨ã€‚**æŒ‡å®šåˆå§‹åŒ–å™¨å’Œååˆå§‹åŒ–å™¨å¿…é¡»ç”±åŸæ¥ç±»çš„å®ç°æä¾›**ã€‚

```swift
struct Size {
    var width = 0.0, height = 0.0
}

struct Point {
    var x = 0.0, y = 0.0
}

struct Rect {
    var origin = Point()
    var size = Size()
}

extension Rect {
    init(center: Point, size: Size) {
        let originX = center.x - (size.width / 2)
        let originY = center.y - (size.height / 2)
        self.init(origin: Point(x: originX, y: originY), size: size)
    }
}

let centerRect = Rect(center: Point(x: 4.0, y: 4.0), size: Size(width: 3.0, height: 3.0))
print(centerRect.origin)
// Prints "Point(x: 2.5, y: 2.5)"
```

#### æ‰©å±•çš„èƒ½åŠ›-æ–¹æ³•

æ‰©å±•å¯ä»¥ä¸ºå·²æœ‰çš„ç±»å‹æ·»åŠ æ–°çš„å®ä¾‹æ–¹æ³•å’Œç±»å‹æ–¹æ³•ã€‚

```swift
extension Int {
    func repetitions(task: () -> Void) {
        for _ in 0..<self {
            task()
        }
    }
}

2.repetitions {
    print("Hello!")
}
```

æ‰“å°ç»“æœï¼š

```js
Hello!
Hello!
```

#### æ‰©å±•çš„èƒ½åŠ›-mutatingæ–¹æ³•

æ‰©å±•çš„å®ä¾‹æ–¹æ³•ä»å¯ä»¥ä¿®æ”¹ï¼ˆå¼‚å˜ï¼‰å®ä¾‹æœ¬èº«ã€‚

ç»“æ„ä½“å’Œæšä¸¾ç±»å‹æ–¹æ³•åœ¨ä¿®æ”¹ self æˆ–æœ¬èº«çš„å±æ€§æ—¶å¿…é¡»æ ‡è®°å®ä¾‹æ–¹æ³•ä¸º `mutating`ï¼Œå’ŒåŸæœ¬å®ç°çš„ä¸€éæ–¹æ³•ä¸€æ ·ã€‚

```swift
extension Int {
    mutating func sequare() {
        self = self * self
    }
}
var someInt = 3
someInt.sequare()
print(someInt)
// Prints "9"
```

#### æ‰©å±•çš„èƒ½åŠ›-ä¸‹æ ‡

æ‰©å±•èƒ½ä¸ºå·²æœ‰çš„ç±»å‹æ·»åŠ æ–°çš„ä¸‹æ ‡ã€‚

```swift
extension Int {
    subscript(digitIndex: Int) -> Int {
        var decimalBase = 1
        for _ in 0..<digitIndex {
            decimalBase *= 10
        }
        return (self / decimalBase) % 10
    }
}
print(746381295[0])
// Prints "5"
print(746381295[1])
// Prints "9"
print(746381295[2])
// Prints "2"
print(746381295[8])
// Prints "7"
```

#### æ‰©å±•çš„èƒ½åŠ›-æ·»åŠ å†…åµŒç±»å‹

```swift
extension Int {
    enum Kind {
        case negative, zero, positive
    }
    var kind: Kind {
        switch self {
        case 0:
            return .zero
        case let x where x > 0:
            return .positive
        default:
            return .negative
        }
    }
}

print(0.kind)
// Prints "zero"
print(100.kind)
// Prints "positive"
print((0-1).kind)
// Prints "negative"
```

## åè®®

### åè®®çš„è¯­æ³•

è‡ªå®šä¹‰ç±»å‹å£°æ˜æ—¶ï¼Œ**å°†åè®®åæ”¾åœ¨ç±»å‹åçš„å†’å·ä¹‹å**æ¥è¡¨ç¤ºè¯¥ç±»å‹é‡‡çº³ä¸€ä¸ªç‰¹å®šçš„åè®®ï¼Œå¤šä¸ªåè®®å¯ä»¥ç”¨é€—å·åˆ†å¼€åˆ—å‡ºã€‚è‹¥ä¸€ä¸ªç±»æ‹¥æœ‰çˆ¶ç±»ï¼Œå°†è¿™ä¸ªçˆ¶ç±»åæ”¾åœ¨å…¶é‡‡çº³çš„åè®®å**ä¹‹å‰**ï¼Œå¹¶ç”¨é€—å·åˆ†éš”ã€‚

![10](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/11.png)

### å±æ€§è¦æ±‚

åè®®å¯ä»¥è¦æ±‚æ‰€æœ‰éµå¾ªè¯¥åè®®çš„ç±»å‹ï¼Œæä¾›ç‰¹å®šåå­—å’Œç±»å‹çš„å®ä¾‹å±æ€§æˆ–ç±»å‹å±æ€§ã€‚åè®®å¹¶ä¸ä¼šå…·ä½“è¯´æ˜å±æ€§æ—¶å­˜å‚¨å‹å±æ€§è¿˜æ˜¯è®¡ç®—å‹å±æ€§ï¼Œå®ƒåªå…·ä½“è¦æ±‚â€”â€”**å±æ€§æœ‰ç‰¹å®šçš„åç§°å’Œç±»å‹**ã€‚

åè®®åŒæ—¶è¦æ±‚â€”â€”**ä¸€ä¸ªå±æ€§å¿…é¡»æ˜ç¡®æ˜¯å¯è¯»çš„æˆ–å¯è¯»å¯å†™**ï¼š

1. è‹¥åè®®è¦æ±‚ä¸€ä¸ªå±æ€§ä¸ºå¯è¯»å¯å†™çš„ï¼Œé‚£ä¹ˆè¯¥å±æ€§ä¸èƒ½ç”¨å¸¸é‡å‚¨å­˜å±æ€§æˆ–åªè¯»è®¡ç®—å±æ€§æ¥æ»¡è¶³ã€‚

2. è‹¥åè®®è¦æ±‚ä¸€ä¸ªå±æ€§ä¸ºå¯è¯»çš„ï¼Œé‚£ä¹ˆä»»ä½•ç§ç±»çš„å±æ€§éƒ½èƒ½æ»¡è¶³è¿™ä¸ªè¦æ±‚ã€‚

è¯»å†™è®¡ç®—å±æ€§å’Œåªè¯»è®¡ç®—å±æ€§ï¼š

```swift
protocol SomeProtocol {
    var mustBeSettable: Int { get set }
    var doesNotNeedToBeSettable: Int { get }
}
```

åˆ¶åº¦è®¡ç®—å±æ€§ï¼š

```swift
protocol FullyNamed {
    var fullName: String { get }
}

struct Person: FullyNamed {
    var fullName: String
}
let john = Person(fullName: "John Appleseed")
// Prints "John Appleseed"
```

åªè¯»è®¡ç®—å±æ€§

```swift
class Starship: FullyNamed {
    var prefix: String?
    var name: String
    init(name: String, prefix: String? = nil) {
        self.name = name
        self.prefix = prefix
    }
    var fullName: String {
        return (prefix != nil ? prefix! + " " : "") + name
    }
}
var ncc1701 = Starship(name: "Enterprise", prefix: "USS")
print(ncc1701.fullName)
// Prints "USS Enterprise"
```

åœ¨åè®®ä¸­å®šä¹‰**ç±»å‹å±æ€§**æ—¶åœ¨å‰é¢æ·»åŠ  `static` å…³é”®å­—ã€‚å½“ç±»çš„å®ç°ä½¿ç”¨ `class` æˆ– `static` å…³é”®å­—å‰ç¼€å£°æ˜ç±»å‹å±æ€§è¦æ±‚æ—¶ï¼Œè¿™ä¸ªè§„åˆ™ä»ç„¶é€‚ç”¨ã€‚

```swift
protocol AnotherProtocol {
    static var someTypeProperty: Int { get set }
}
```

### æ–¹æ³•è¦æ±‚

åè®®å¯ä»¥è¦æ±‚é‡‡çº³çš„ç±»å‹**å®ç°æŒ‡å®šçš„å®ä¾‹æ–¹æ³•å’Œç±»æ–¹æ³•**ã€‚

1. è¿™äº›æ–¹æ³•ä½œä¸ºåè®®å®šä¹‰çš„ä¸€éƒ¨åˆ†ï¼Œä¹¦å†™æ–¹å¼ä¸æ­£å¸¸å®ä¾‹å’Œç±»æ–¹æ³•çš„æ–¹å¼å®Œå…¨ç›¸åŒï¼Œä½†æ˜¯ä¸éœ€è¦å¤§æ‹¬å·å’Œæ–¹æ³•çš„ä¸»é¢˜ï¼›
2. å…è®¸æ–¹æ³•æ‹¥æœ‰å‚æ•°ï¼Œä¸æ­£å¸¸çš„æ–¹æ³•ä½¿ç”¨åŒæ ·çš„è§„åˆ™ï¼›
3. æ–¹æ³•å‚æ•°ä¸èƒ½å®šä¹‰é»˜è®¤å€¼ã€‚

åœ¨ç±»å®ç°æ—¶ï¼Œç±»å‹æ–¹æ³•è¦æ±‚ä½¿ç”¨ `class` æˆ– `static` ä½œä¸ºå…³é”®å­—å‰ç¼€ï¼Œåè®®ä¸­åŒæ ·é€‚ç”¨ã€‚

```swift
protocol AnotherProtocol {
    func someMethod(element: String)
    static func anotherMethod(element: Int)
}
```

### mutating æ–¹æ³•è¦æ±‚

å¯¹äºåè®®é‡Œå®šä¹‰çš„å®ä¾‹æ–¹æ³•ï¼Œå¦‚æœæƒ³è¦å¼‚å˜é‡‡ç”¨äº†è¯¥åè®®çš„ç±»å‹å®ä¾‹ï¼Œå°±è¦åœ¨æ–¹æ³•çš„å®šä¹‰å½“ä¸­ä½¿ç”¨ `mutating` å…³é”®å­—ã€‚è¿™å…è®¸ç»“æ„ä½“å’Œæšä¸¾ç±»å‹èƒ½é‡‡ç”¨ç›¸åº”åè®®å¹¶æ»¡è¶³æ–¹æ³•è¦æ±‚ã€‚

```swift
protocol MoveProtocol {
    mutating func moveBy(x deltaX: Int, y deltaY: Int)
}

struct Point: MoveProtocol {
    var x = 0, y = 0
    mutating func moveBy(x deltaX: Int, y deltaY: Int) {
        self = Point(x: x + deltaX, y: y + deltaY)
    }
}

var p = Point(x: 1, y: 1)
p.moveBy(x: 1, y: 1)
print(p)
// Prints "Point(x: 2, y: 2)"
```

### åˆå§‹åŒ–å™¨è¦æ±‚

åè®®å¯ä»¥è¦æ±‚éµå¾ªåè®®çš„ç±»å‹å®ç°æŒ‡å®šçš„åˆå§‹åŒ–å™¨ã€‚

åè®®åœ¨å®šä¹‰åˆå§‹åŒ–å™¨æ—¶å’Œä¸€èˆ¬çš„åˆå§‹åŒ–å™¨ä¸€æ ·ï¼Œåªç”¨å°†åˆå§‹åŒ–å™¨å†™åœ¨åè®®çš„å®šä¹‰å½“ä¸­ï¼Œåªæ˜¯ä¸ç”¨å†™å¤§æ‹¬å·ï¼ˆåˆå§‹åŒ–çš„å®ä½“ï¼‰ã€‚

```swift
protocol SomeProtocol {
    init(someParameter: Int)
}
```

### åˆå§‹åŒ–å™¨è¦æ±‚çš„ç±»å®ç°

ä¸€ã€å¦‚æœæƒ³è®©éµå¾ªåè®®çš„ç±»æ»¡è¶³åè®®çš„åˆå§‹åŒ–å™¨è¦æ±‚ï¼Œåœ¨å®ç°åè®®æŒ‡å®šçš„åˆå§‹åŒ–å™¨æˆ–ä¾¿æ·åˆå§‹åŒ–å™¨æ—¶ï¼Œå¿…é¡»ä½¿ç”¨ `required` å…³é”®å­—ä¿®é¥°åˆå§‹åŒ–å™¨çš„å®ç°ã€‚

```swift
protocol SomeProtocol {
    init(someParameter: Int)
}

class SomeClass: SomeProtocol {
    required init(someParameter: Int) {
        // initializer implementation goes here
    }
}
```

å¦‚æœéµå¾ªäº†åè®®ï¼Œä¸”å®ç°äº†åè®®æŒ‡å®šçš„åˆå§‹åŒ–å™¨ï¼Œæ²¡æœ‰ä½¿ç”¨ `required` å…³é”®å­—ï¼Œåˆ™ä¼šæŠ¥é”™ï¼š

![12](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/12.png)

äºŒã€å¦‚æœä¸€ä¸ªå­ç±»é‡å†™äº†çˆ¶ç±»æŒ‡å®šçš„åˆå§‹åŒ–å™¨ï¼Œå¹¶ä¸”éµå¾ªåè®®å®ç°äº†åˆå§‹åŒ–å™¨è¦æ±‚ï¼Œé‚£ä¹ˆå°±è¦ä¸ºè¿™ä¸ªåˆå§‹åŒ–å™¨çš„å®ç°æ·»åŠ  `required` å’Œ `override` ä¸¤ä¸ªä¿®é¥°ç¬¦ã€‚

![15](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/15.png)

å¦‚æœé‡å†™äº†æ–¹æ³•ï¼Œæ²¡æœ‰åŠ  `override` å…³é”®å­—ï¼Œåˆ™ä¼šæŠ¥é”™ï¼š

![13](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/13.png)

å¦‚æœéµå¾ªäº†åè®®å®ç°äº†åˆå§‹åŒ–å™¨è¦æ±‚ï¼Œæ²¡æœ‰åŠ  `required` å…³é”®å­—ï¼Œåˆ™ä¼šæŠ¥é”™ï¼š

![14](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/14.png)

### å°†åè®®ä½œä¸ºç±»å‹

1. åœ¨å‡½æ•°ã€æ–¹æ³•æˆ–è€…åˆå§‹åŒ–å™¨é‡Œä½œä¸ºå½¢å¼å‚æ•°ç±»å‹æˆ–è€…è¿”å›ç±»å‹ï¼›
2. ä½œä¸ºå¸¸é‡ã€å˜é‡æˆ–è€…å±æ€§çš„ç±»å‹ï¼›
3. ä½œä¸ºæ•°ç»„ã€å­—å…¸æˆ–è€…å…¶ä»–å­˜å‚¨å™¨çš„å…ƒç´ çš„ç±»å‹ã€‚

### åè®®ç»§æ‰¿

åè®®å¯ä»¥ç»§æ‰¿ä¸€ä¸ªæˆ–è€…å¤šä¸ªå…¶ä»–åè®®ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ç»§æ‰¿çš„åŸºç¡€ä¹‹ä¸Šæ·»åŠ æ›´å¤šè¦æ±‚ã€‚åè®®ç»§æ‰¿çš„è¯­æ³•ä¸ç±»ç»§æ‰¿çš„è¯­æ³•ç›¸ä¼¼ï¼Œåªä¸è¿‡å¯ä»¥é€‰æ‹©åˆ—å‡º**å¤šä¸ªç»§æ‰¿çš„åè®®**ï¼Œä½¿ç”¨é€—å·åˆ†éš”ã€‚

![16](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/16.png)

### ç±»ä¸“ç”¨çš„åè®®ï¼ˆAnyObjectï¼‰

é€šè¿‡æ·»åŠ  `AnyObject` å…³é”®å­—åˆ°åè®®çš„ç»§æ‰¿åˆ—è¡¨ï¼Œå¯ä»¥**é™åˆ¶åè®®åªèƒ½è¢«ç±»ç±»å‹é‡‡çº³**ï¼Œå¹¶ä¸”ä¸æ˜¯ç»“æ„ä½“æˆ–è€…æšä¸¾ã€‚

![17](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/17.png)

### åè®®ç»„åˆï¼ˆ&ï¼‰

å¯ä»¥ä½¿ç”¨åè®®ç»„åˆæ¥å¤åˆå¤šä¸ªåè®®åˆ°ä¸€ä¸ªè¦æ±‚é‡Œã€‚åè®®ç»„åˆä¸å®šä¹‰ä»»ä½•æ–°çš„åè®®ç±»å‹ã€‚

åè®®ç»„åˆä½¿ç”¨ `SomeProtocol & AnotherProtocol` çš„å½¢å¼ã€‚å¯ä»¥åˆ—ä¸¾ä»»æ„æ•°é‡çš„åè®®ï¼Œç”¨å’Œç¬¦å·`&`è¿æ¥ï¼Œä½¿ç”¨é€—å·`,`åˆ†éš”ã€‚é™¤äº†åè®®åˆ—è¡¨ï¼Œåè®®ç»„åˆä¹Ÿèƒ½åŒ…å«ç±»ç±»å‹ï¼Œè¿™å…è®¸æ ‡æ˜ä¸€ä¸ªéœ€è¦çš„çˆ¶ç±»ã€‚

```swift
protocol Named {
    var name: String { get }
}

protocol Aged {
    var age: Int { get }
}

struct Person: Named, Aged {
    var name: String
    var age: Int
}

func wishHappyBirthday(to celebrator: Named & Aged) {
    print("Happy birthday, \(celebrator.name), you'er \(celebrator.age)")
}

let birthdayPerson = Person(name: "kevin", age: 18)
wishHappyBirthday(to: birthdayPerson)
// Prints "Happy birthday, kevin, you'er 18"
```

### å¯é€‰åè®®è¦æ±‚ï¼ˆoptionalï¼‰

å¯ä»¥ç»™åè®®å®šä¹‰å¯é€‰è¦æ±‚ï¼Œè¿™äº›è¦æ±‚ä¸éœ€è¦å¼ºåˆ¶éµå¾ªåè®®çš„ç±»å‹å®ç°ã€‚

å¯é€‰è¦æ±‚ä½¿ç”¨ `optional` ä¿®é¥°ç¬¦ä½œä¸ºå‰ç¼€æ”¾åœ¨åè®®çš„å®šä¹‰ä¸­ã€‚

å¯é€‰è¦æ±‚å…è®¸ Object-C æ“ä½œï¼Œåè®®å’Œå¯é€‰è¦æ±‚å¿…é¡»ä½¿ç”¨ `@objc` æ ‡å¿—æ ‡è®°ï¼Œæ³¨æ„ `@objc` åè®®åªèƒ½è¢«ç»§æ‰¿è‡ª Object-C ç±»æˆ–å…¶ä»– `@objc` ç±»é‡‡çº³ï¼Œä»–ä»¬ä¸èƒ½è¢«ç»“æ„ä½“æˆ–è€…æšä¸¾é‡‡çº³ã€‚

## åè®®å’Œæ‰©å±•

### åœ¨æ‰©å±•é‡Œæ·»åŠ åè®®éµå¾ª

å¯ä»¥é€šè¿‡æ‰©å±•ä¸ºä¸€ä¸ªå·²ç»å­˜åœ¨çš„ç±»å‹**é‡‡çº³**å’Œ**éµå¾ª**ä¸€ä¸ªæ–°çš„åè®®ï¼Œå³ä½¿æ— æ³•è®¿é—®ç°æœ‰ç±»å‹çš„æºä»£ç ä¹Ÿèƒ½å®ç°ã€‚

æ‰©å±•å¯ä»¥æ·»åŠ æ–°çš„å±æ€§ã€æ–¹æ³•å’Œå°æ ‡åˆ°å·²ç»å­˜åœ¨çš„ç±»å‹ï¼Œå¹¶ä¸”å› æ­¤å…è®¸æ·»åŠ åè®®éœ€è¦çš„ä»»ä½•**è¦æ±‚**ã€‚

```swift
protocol TextRepresentable {
    var desc: String { get }
}

extension Person: TextRepresentable {
    var desc: String {
        return "name \(name) age \(age)"
    }
}

let p = Person(name: "zhangsan", age: 35)
print(p.desc)
// Prints "name zhangsan age 35"
```

### æœ‰æ¡ä»¶çš„éµå¾ªåè®®

æ³›å‹ç±»å‹å¯èƒ½**åªåœ¨æŸäº›æƒ…å†µä¸‹**æ»¡è¶³ä¸€ä¸ªåè®®çš„è¦æ±‚ï¼Œæ¯”å¦‚å½“ç±»å‹çš„æ³›å‹å½¢å¼å‚æ•°ä¹Ÿéµå¾ªå¯¹åº”åè®®æ—¶ã€‚

å¯ä»¥é€šè¿‡åœ¨æ‰©å±•ç±»å‹æ—¶åˆ—å‡ºé™åˆ¶è®©æ³›å‹ç±»å‹**æœ‰æ¡ä»¶åœ°éµå¾ªæŸåè®®**ï¼Œå³åœ¨é‡‡çº³åè®®çš„åå­—åé¢å†™æ³›å‹ `where` åˆ†å¥ã€‚

```swift
protocol TextRepresentable {
    var desc: String { get }
}

extension Person: TextRepresentable {
    var desc: String {
        return "name \(name) age \(age)"
    }
}

extension Array: TextRepresentable where Element: TextRepresentable {
    var desc: String {
        let itemDesc = self.map{ $0.desc }
        return itemDesc.joined(separator: ",")
    }
}

let array = [Person(name: "zhangsan", age: 20), Person(name: "lis", age: 30)];
print(array.desc)
// Prints "name zhangsan age 20,name lis age 30"
```

å¦‚æœå‚æ•°æ²¡æœ‰éµå¾ª åè®®ï¼š

```swift
protocol TextRepresentable {
    var desc: String { get }
}

extension Array: TextRepresentable {
    var desc: String {
        var temp = ""
        for element in self {
            if let p = element as? Person {
                if temp.count > 0 {
                    temp += ","
                }
                temp += "name \(p.name) age \(p.age)"
            }
        }
        return temp
    }
}

let array = [Person(name: "zhangsan", age: 20), Person(name: "lis", age: 30)];
print(array.desc)
// Prints "name zhangsan age 20,name lis age 30"
```

é€šè¿‡å¯¹æ¯”å¯è§ï¼Œæœ‰æ•ˆçš„éµå¾ªåè®®å¯ä»¥æ›´å¥½çš„ç®€åŒ–ä»£ç å’Œé€»è¾‘ã€‚

### ä½¿ç”¨æ‰©å±•å£°æ˜é‡‡çº³åè®®

å¦‚æœä¸€ä¸ªç±»å‹å·²ç»**éµå¾ª**äº†åè®®çš„æ‰€æœ‰**è¦æ±‚**ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å£°æ˜è¯¥å±æ€§**é‡‡çº³**äº†è¿™ä¸ªåè®®ï¼Œåˆ™å¯ä»¥é€šè¿‡ä¸€ä¸ªç©ºçš„æ‰©å±•æ¥è®©è¯¥ç±»å‹**é‡‡çº³**è¿™ä¸ªåè®®ã€‚ğŸ‘‡

```swift
// Hamster å·²ç»éµå¾ªäº† TextRepresentable åè®®çš„éœ€æ±‚ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰å£°æ˜â€œé‡‡çº³äº† TextRepresentable åè®®â€
struct Hamster {
    var name: String
    var desc: String {
        return "A hamster named \(name)"
    }
}

// é€šè¿‡ä¸€ä¸ªç©ºçš„æ‰©å±•è®© Hamster é‡‡çº³ TextRepresentable åè®®
extension Hamster: TextRepresentable {}
```

### åè®®æ‰©å±•

åè®®å¯ä»¥é€šè¿‡æ‰©å±•æ¥æä¾›æ–¹æ³•å’Œå±æ€§çš„å®ç°ï¼Œæ¥å®ç°**éµå¾ªåè®®ç±»å‹**ï¼Œè¿™å°±å…è®¸åœ¨åè®®è‡ªèº«å®šä¹‰è¡Œä¸ºï¼Œè€Œä¸æ˜¯åœ¨æ¯ä¸€ä¸ªéµå¾ªçš„ç±»é‡Œæˆ–è€…å…¨å±€å‡½æ•°é‡Œå®šä¹‰è¡Œä¸ºã€‚

```swift
protocol Named {
    var name: String { get }
}

protocol Aged {
    var age: Int { get }
}

protocol TextRepresentable {
    var desc: String { get }
}

struct Person: Named, Aged {
    var name: String
    var age: Int
}

extension Person: TextRepresentable {
    var desc: String {
        return "name \(name) age \(age)"
    }
}

extension Aged {
    func moreThan35() -> Bool {
        return age >= 35
    }
}

let p = Person(name: "zhangsan", age: 35)
print(p.moreThan35())
// Print "true"
```

### ç»™åè®®æä¾›é»˜è®¤å®ç°

å¯ä»¥ä½¿ç”¨åè®®æ‰©å±•æ¥ç»™åè®®çš„ä»»ä¸€æ–¹æ³•æˆ–è€…è®¡ç®—å±æ€§è¦æ±‚æä¾›é»˜è®¤å®ç°ï¼š

```swift
protocol Named {
    var name: String { get }
}

protocol Aged {
    var age: Int { get }
}

protocol TextRepresentable {
    var desc: String { get }
}

extension TextRepresentable {
    var desc: String {
        return "name and age"
    }
}

struct Person: Named, Aged {
    var name: String
    var age: Int
}

extension Person: TextRepresentable {
//    var desc: String {
//        return "name \(name) age \(age)"
//    }
}

extension Aged {
    func moreThan35() -> Bool {
        return age >= 35
    }
}

let p = Person(name: "zhangsan", age: 35)
print(p.desc)
// Prints "name and age"
```

å¦‚æœ**éµå¾ªç±»å‹**ï¼ˆ`Person`ï¼‰ç»™è¿™ä¸ªåè®®ï¼ˆ`TextRepresentable`ï¼‰çš„**è¦æ±‚**ï¼ˆ`var desc(): String { get }`ï¼‰æä¾›äº†è‡ªå·±çš„å®ç°ï¼Œé‚£ä¹ˆè¯¥å®ç°ä¼šæ›¿ä»£æ‰©å±•ä¸­æä¾›çš„é»˜è®¤å®ç°ï¼š

```swift
protocol Named {
    var name: String { get }
}

protocol Aged {
    var age: Int { get }
}

protocol TextRepresentable {
    var desc: String { get }
}

extension TextRepresentable {
    var desc: String {
        return "name and age"
    }
}

struct Person: Named, Aged {
    var name: String
    var age: Int
}

extension Person: TextRepresentable {
    var desc: String {
        return "name \(name) age \(age)"
    }
}

extension Aged {
    func moreThan35() -> Bool {
        return age >= 35
    }
}

let p = Person(name: "zhangsan", age: 35)
print(p.desc)
// Prints "name zhangsan age 35"
```

### ç»™åè®®æ‰©å±•æ·»åŠ é™åˆ¶

é€šè¿‡æ‰©å±•å¯ä»¥ä¸ºç±»å‹æ·»åŠ æ–¹æ³•å’Œå±æ€§ï¼Œä¹Ÿå¯ä»¥åœ¨æ·»åŠ è¿™äº›æ–¹æ³•å’Œå±æ€§æ—¶è®¾å®šé™åˆ¶ã€‚åœ¨æ‰©å±•åè®®åå­—åè¾¹ä½¿ç”¨ `where` åˆ†å¥æ¥å†™è¿™äº›é™åˆ¶ã€‚

```swift
protocol Named {
    var name: String { get }
}

protocol Aged {
    var age: Int { get }
}

protocol TextRepresentable {
    var desc: String { get }
}

struct Person: Named, Aged {
    var name: String
    var age: Int
}

extension Person: TextRepresentable {
    var desc: String {
        return "name \(name) age \(age)"
    }
}

extension Collection where Iterator.Element: TextRepresentable {
    var desc: String {
        let itemDesc = self.map{ $0.desc }
        return itemDesc.joined(separator: ",")
    }
}

let collection = [Person(name: "zhangsan", age: 20), Person(name: "lis", age: 30)];
print(collection.desc)
// Prints "name zhangsan age 20,name lis age 30"
```

å¦‚æœ Collection ä¸­åŒ…å«æ²¡æœ‰é‡‡çº³ `TextRepresentable` åè®®çš„å¯¹è±¡ï¼Œåˆ™ä¸èƒ½ä½¿ç”¨æ‰©å±•é‡Œæä¾›çš„ `desc()` æ–¹æ³•ï¼š

![18](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/18.png)

## é¢å‘åè®®ç¼–ç¨‹

### OOPï¼ˆé¢å‘å¯¹è±¡ç¼–ç¨‹ï¼‰

OOPï¼ˆObject Oriented Programmingï¼‰å³é¢å‘å¯¹è±¡ç¨‹åºè®¾è®¡ï¼Œæ˜¯ä»¥å»ºç«‹æ¨¡å‹ä½“ç°å‡ºæ¥çš„æŠ½è±¡æ€ç»´è¿‡ç¨‹å’Œé¢å‘å¯¹è±¡çš„æ–¹æ³•ã€‚

å‡ ä¹æ‰€æœ‰çš„ç¼–ç¨‹è¯­è¨€éƒ½æ”¯æŒOOPï¼ŒJavaã€Rubyç­‰è¯­è¨€çš„è®¾è®¡ç†å¿µä¸­å‡ ä¹å°†ä¸€åˆ‡äº‹ç‰©éƒ½çœ‹åšå¯¹è±¡ï¼Œå¯¹è±¡å³ä¸­å¿ƒã€å¯¹è±¡å³çœŸç†ã€‚

> é¢å‘å¯¹è±¡ä¸‰è¦ç´ ï¼š
>
> 1. å°è£…
> å°†äº‹ç‰©æŠ½è±¡ä¸ºç±»ï¼ŒæŠŠå¯¹å¤–æ¥å£æš´éœ²ï¼Œå°†å®ç°å’Œå†…éƒ¨æ•°æ®éšè—ã€‚
> 2. ç»§æ‰¿
> å¯ä»¥ä½¿ç”¨ç°æœ‰ç±»çš„æ‰€æœ‰åŠŸèƒ½ï¼Œå¹¶åœ¨æ— åºé‡æ–°ç¼–å†™åŸæ¥çš„ç±»çš„æƒ…å†µä¸‹å¯¹è¿™äº›åŠŸèƒ½è¿›è¡Œæ‰©å±•ã€‚
> <1> é€šè¿‡ç»§æ‰¿åˆ›å»ºçš„ç±»ç§°ä¸ºâ€œå­ç±»â€æˆ–â€œæ´¾ç”Ÿç±»â€ã€‚
> <2> è¢«ç»§æ‰¿çš„ç±»ç§°ä¸ºâ€œåŸºç±»â€ã€â€œçˆ¶ç±»â€æˆ–â€œè¶…ç±»â€ã€‚
> <3> ç»§æ‰¿çš„è¿‡ç¨‹ï¼Œè¢«ç§°ä¸ºä»ä¸€èˆ¬åˆ°ç‰¹æ®Šçš„è¿‡ç¨‹ã€‚
> <4> ä¸€ä¸ªå­ç±»åªèƒ½æœ‰ä¸€ä¸ªåŸºç±»ï¼Œå¯ä»¥é€šè¿‡**å¤šçº§ç»§æ‰¿**æ¥å®ç°å¤šé‡ç»§æ‰¿ã€‚ï¼ˆåœ¨æŸäº› OOP è¯­è¨€ä¸­ï¼Œä¸€ä¸ªå­ç±»å¯ä»¥ç»§æ‰¿å¤šä¸ªåŸºç±»ã€‚ï¼‰
> 3. å¤šæ€
> å…è®¸å°†å­ç±»ç±»å‹çš„æŒ‡é’ˆèµ‹å€¼ç»™çˆ¶ç±»ç±»å‹çš„æŒ‡é’ˆã€‚

OOP çš„ç¼ºé™·ï¼š

1. ç»§æ‰¿æœºåˆ¶è¦æ±‚åœ¨å¼€å§‹ä¹‹å‰å°±èƒ½è®¾è®¡å¥½æ•´ä¸ªç¨‹åºçš„æ¡†æ¶ã€ç»“æ„ã€äº‹ç‰©é—´çš„è¿æ¥å…³ç³»ã€‚è¿™è¦æ±‚å¼€å‘è€…å¿…é¡»æœ‰å¾ˆå¥½çš„åˆ†ç±»è®¾è®¡èƒ½åŠ›ï¼Œå°†ä¸åŒçš„å±æ€§å’Œæ–¹æ³•åˆ†é…åˆ°åˆé€‚çš„å±‚æ¬¡é‡Œé¢å»ã€‚è®¾è®¡æ¸…æ™°æ˜äº†çš„ç»§æ‰¿ä½“ç³»æ€»æ˜¯å¾ˆéš¾çš„ã€‚ï¼ˆ**C++æ ‡å‡†åº“ä¸æ˜¯é¢å‘å¯¹è±¡çš„**ï¼‰

2. ç»“æ„å¤©ç”Ÿå¯¹æ”¹åŠ¨æœ‰æŠµæŠ—ç‰¹æ€§ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆ OOP é¢†åŸŸä¸­æ‰€æœ‰ç¨‹åºå‘˜éƒ½å¯¹é‡æ„è®³è«å¦‚æ·±ï¼Œæœ‰äº›æ¡†æ¶åˆ°æœ€åä»£ç é‡å‡ å¥è†¨èƒ€å˜å¾—éš¾ä»¥ç»´æŠ¤ä»è€Œå¤±æ§ã€‚ï¼ˆ**ä¿®æ”¹è¡Œä¸ºæ¯”ä¿®æ”¹ç»“æ„ä½“ç®€å•**ï¼‰

3. ç»§æ‰¿æœºåˆ¶å¸¦æ¥çš„å¦ä¸€ä¸ªé—®é¢˜æ˜¯ï¼šå¾ˆå¤šè¯­è¨€éƒ½ä¸æä¾›å¤šç»§æ‰¿ï¼Œæˆ‘ä»¬ä¸å¾—ä¸åœ¨çˆ¶ç±»å¡å…¥æ›´å¤šçš„å†…å®¹ï¼Œå­ç±»ä¸­ä¼šå­˜åœ¨æ— ç”¨çš„çˆ¶ç±»å±æ€§å’Œæ–¹æ³•ï¼Œè€Œè¿™äº›å†—ä½™ä»£ç ç»™å­ç±»å¸¦æ¥çš„ä¸€å®šçš„é£é™©ï¼Œè€Œä¸”å¯¹äºå±‚çº§å¾ˆæ·±çš„ä»£ç ç»“æ„ä½“æ¥è¯´ Bug ä¿®å¤å°†ä¼šæˆä¸ºéš¾é¢˜ã€‚ï¼ˆ**ç»„åˆä¼˜äºç»§æ‰¿**ï¼‰

4. **å¯¹è±¡**ï¼ˆClassï¼Œå¼•ç”¨ç±»å‹ï¼‰çš„çŠ¶æ€ä¸æ˜¯ç¼–ç çš„å¥½å‹ï¼Œç›¸åæ˜¯ç¼–ç çš„æ•Œäººã€‚å¯¹è±¡å›ºæœ‰çš„çŠ¶æ€åœ¨åˆ†äº«å’Œä¼ é€’è¿‡ç¨‹ä¸­å¾ˆéš¾è¿½è¸ªè°ƒè¯•ï¼Œå°¤å…¶åœ¨å¹¶è¡Œç¨‹åºç¼–ç ä¸­é—®é¢˜å°±æ›´åŠ æ˜æ˜¾ï¼Œå¾ˆéš¾æŸ¥æ‰¾å¯¹è±¡åœ¨å“ªä¸€ä¸ªå¹¶è¡Œçº¿ç¨‹å‘ç”Ÿäº†æ”¹å˜ã€‚OOP æ‰€å¸¦æ¥çš„å¯å˜ã€ä¸ç¡®å®šã€å¤æ‚ç­‰ç‰¹å¾å®Œå…¨ä¸å¹¶è¡Œç¼–ç¨‹ä¸­å€¡å¯¼çš„å°å‹åŒ–ã€æ ¸å¿ƒåŒ–ã€é«˜æ•ˆåŒ–å®Œå…¨èƒŒç¦»ã€‚åœ¨å¹¶è¡Œç¼–ç¨‹ä¸­ï¼Œå€¼ç±»å‹çš„ä¼˜åŠ¿æ›´åŠ æ˜æ˜¾ï¼Œä¸€ä¸ªå€¼åœ¨ä¼ é€’åï¼Œä¸ä¼šå› ä¸ºä¼ é€’å‡ºå»çš„å€¼çš„å˜åŒ–è€Œå˜åŒ–ï¼Œå³å¹¶è¡Œçº¿ç¨‹é—´ä¿®æ”¹çš„å€¼éƒ½æ˜¯ç‹¬ç«‹çš„ã€‚ï¼ˆ**å€¼ç±»å‹ä¼˜äºå¼•ç”¨ç±»å‹**ï¼‰

### POPï¼ˆé¢å‘åè®®ç¼–ç¨‹ï¼‰

Protocol oriented programmingã€‚

åè®®ä¸ºæ–¹æ³•ã€å±æ€§ç­‰å®šä¹‰äº†è“å›¾ï¼Œç„¶åç±»ã€ç»“æ„ä½“æˆ–æšä¸¾å¯ä»¥é‡‡ç”¨è¯¥åè®®ã€‚

åœ¨ Objective-C ä¸­æ•°ç»„çš„å®ç°éµå¾ªçš„æ˜¯ OOP ç¼–ç¨‹èŒƒå¼ã€‚å¯å˜æ•°ç»„ `NSMutableArray` ç»§æ‰¿è‡ª `NSArray`ï¼Œ`NSArray` ç»§æ‰¿è‡ª `NSObject`ã€‚åŒæ—¶`NSArray` é‡‡çº³äº† `NSCopying`ã€`NSFastEnumeration`ã€`NSMutableCopying`ã€`NSSecureCoding` ç­‰åè®®ã€‚

![19](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/19.png)

åœ¨ Swift ä¸­æ•°ç»„çš„å®ç°éµå¾ªçš„æ˜¯ POP ç¼–ç¨‹èŒƒå¼ã€‚`Array` æ²¡æœ‰ç»§æ‰¿è‡ªä»»ä½•ç±»ï¼Œè€Œæ˜¯éµå¾ªäº†ä¸€ç³»åˆ—çš„åè®®ï¼Œä¸åŒçš„åè®®å®šä¹‰äº†ä¸åŒåŠŸèƒ½çš„è“å›¾ã€‚

![20](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/20.png)

### OOP vs POP

**OOP å…³å¿ƒå¯¹è±¡æ˜¯ä»€ä¹ˆï¼ŒPOP å…³å¿ƒå¯¹è±¡åšä»€ä¹ˆã€‚**

#### OOP å…³å¿ƒå¯¹è±¡æ˜¯ä»€ä¹ˆ

é‡‡ç”¨ OOP å®ç°ä¸åŒç§ç±»çš„è¿åŠ¨å‘˜ï¼š

é¦–é¡µä¸åŒç§ç±»çš„è¿åŠ¨å‘˜ç»Ÿç§°ä¸ºè¿åŠ¨å‘˜ï¼Œè¿åŠ¨å‘˜éƒ½æ˜¯äººï¼Œæ‰€ä»¥æœ‰ä»¥ä¸‹æ–¹æ¡ˆ

1ã€å®šä¹‰äººç±»ï¼Œä¸€ä¸ªæœ‰åå­—ã€å¹´é¾„å’Œè¯´è¯ç­‰åŸºæœ¬èƒ½åŠ›çš„äººç±»ï¼š

```swift
class Human {
    var name: String
    var age: Int
    
    init(name: String, age: Int) {
        self.name = name
        self.age = age
    }
    
    func sayHi() {
        print("say Hi")
    }
}
```

2ã€å®šä¹‰è¿åŠ¨å‘˜ï¼Œä¸€ä¸ªäººç±»è¿åŠ¨å‘˜ï¼ˆç»§æ‰¿è‡ªâ€œäººç±»â€ï¼‰ï¼Œä»–å¯ä»¥è‡ªå®šä¹‰è‡ªæˆ‘ä»‹ç»çš„å†…å®¹ï¼š

```swift
class Athlete: Human {
    override func sayHi() {
        print("Hi, I'm \(name)")
    }
}
```

3ã€å®šä¹‰ç”°å¾„è¿åŠ¨å‘˜ã€æ¸¸æ³³è¿åŠ¨å‘˜ï¼Œä»–ä»¬ç»Ÿç§°ä¸ºè¿åŠ¨å‘˜ï¼ˆç»§æ‰¿è‡ªâ€œè¿åŠ¨å‘˜â€ï¼‰ï¼Œå¹¶å¯ä»¥å®šä¹‰å±äºè‡ªå·±çš„ç‰¹æœ‰çš„èƒ½åŠ›ï¼š

```swift
class Runner: Athlete {
    func run() {
        print("run")
    }
}

class Swimmer: Athlete {
    func swim() {
        print("swim")
    }
}
```

ğŸ¤”**æ€è€ƒ**ï¼šå¦‚æœæ—¢æ˜¯ç”°å¾„è¿åŠ¨å‘˜ï¼Œåˆæ˜¯æ¸¸æ³³è¿åŠ¨å‘˜ï¼Ÿ

```swift
class RunnerAndSwimmer: Athlete {
    func run() {
        print("run")
    }

    func swim() {
        print("swim")
    }
}
```

ç›´æ¥å®šä¹‰ä¸€ä¸ªâ€œç”°å¾„æ¸¸æ³³â€è¿åŠ¨å‘˜ï¼Œè¿™ä¸ªå‘½åçœŸçš„å¾ˆ OCã€‚

å¦‚æœè¿˜æ˜¯ç¯®çƒè¿åŠ¨å‘˜Aï¼Œåˆ™å¯ä»¥å†™æˆ â€œRunnerAndSwimmerAndBasketballPlayerâ€ï¼Œè€Œä¸”è¿˜å¯ä»¥ä¸€ç›´ and ä¸‹å»ï¼Œâ€œRunnerAndSwimmerAndBasketballPlayerAnd...â€ã€‚

å³ï¼šâ€œç”°å¾„â€ + â€œæ¸¸æ³³â€ + â€œç¯®çƒâ€

```swift
class RunnerAndSwimmerAndBasketballPlayer: Athlete {
    func run() {
        print("run")
    }

    func swim() {
        print("swim")
    }

    func playBasketball() {
        print("play basketball")
    }
}
```

å¦‚æœè¿™æ—¶æœ‰ä¸€ä¸ªè¿åŠ¨å‘˜Bï¼Œç›¸å¯¹äºç¬¬ä¸€ä¸ªé™¤äº†ä¸æ˜¯â€œç”°å¾„â€è¿åŠ¨å‘˜å¤–å…¶ä»–çš„éƒ½æ˜¯ï¼Œåˆ™éœ€è¦å®šä¹‰ä¸€ä¸ªç±»ï¼Œç±»åå¯ä»¥å†™æˆ â€œSwimmerAndBasketballPlayerâ€ã€‚

å³ï¼šâ€œæ¸¸æ³³â€ + â€œç¯®çƒâ€

```swift
class SwimmerAndBasketballPlayer: Athlete {
    func swim() {
        print("swim")
    }

    func playBasketball() {
        print("play basketball")
    }
}
```

è¿åŠ¨å‘˜Cï¼šâ€œç”°å¾„â€ + â€œç¯®çƒâ€

```swift
class RunnerAndBasketballPlayer: Athlete {
    func run() {
        print("run")
    }

    func playBasketball() {
        print("play basketball")
    }
}
```

4ã€å®šä¹‰è£åˆ¤ï¼Œè£åˆ¤è‚¯å®šæ˜¯ä¸€ä¸ªäººç±»

```swift
class Referee: Human {
    override func sayHi() {
        print("Hi, I'm \(name)")
    }
}
```

ğŸ¤”**æ€è€ƒ**ï¼šå¦‚æœæ—¢æ˜¯è¿åŠ¨å‘˜ï¼Œåˆæ˜¯è£åˆ¤ï¼Ÿ

```swift
class Referee: Athlete {
    override func sayHi() {
        print("Hi, I'm \(name)")
    }
}
```

è®©è£åˆ¤ç»§æ‰¿è‡ªè¿åŠ¨å‘˜ï¼Œæ¥è¡¨æ˜è¿™ä¸ªè£åˆ¤ä¹Ÿæ˜¯å±äºè¿åŠ¨å‘˜è¿™ä¸€ç±»é‡Œçš„ã€‚æ˜¾ç¤ºç”Ÿæ´»ä¸­è™½ç„¶è£åˆ¤æœ‰å¯èƒ½æ˜¯ä»è¿åŠ¨å‘˜å‘å±•æ¥çš„ï¼Œä½†æ˜¯è¿™é‡Œæ˜¾ç„¶è£åˆ¤å’Œè¿åŠ¨å‘˜æ˜¯ä¸¤ä¸ªèŒä¸šï¼Œå¹¶æ²¡æœ‰ä»å±å…³ç³»ã€‚

#### POP å…³å¿ƒå¯¹è±¡åšä»€ä¹ˆ

1ã€å®šä¹‰äººç±»åº”è¯¥å…·å¤‡çš„åŸºæœ¬å±æ€§ï¼Œç”°å¾„è¿åŠ¨å‘˜çš„åŸºæœ¬å±æ€§ï¼Œæ¸¸æ³³è¿åŠ¨å‘˜çš„åŸºæœ¬å±æ€§ï¼š

```swift
protocol Human {
    var name: String { get set }
    var age: Int { get set }
    func sayHi()
}

protocol Runnalbe {
    func run()
}

protocol Swimming {
    func swim()
}
```

2ã€ç”°å¾„è¿åŠ¨å‘˜ï¼šâ€œäººç±»â€ + â€œç”°å¾„â€

```swift
struct Runner: Human, Runnalbe {
    var name = "zhangsan"
    var age = 35
    
    func sayHi() {
        print("Hi, I'm \(name)")
    }
    
    func run() {
        print("run")
    }
}
```

3ã€æ¸¸æ³³è¿åŠ¨å‘˜ï¼šâ€œäººç±»â€ + â€œæ¸¸æ³³â€

```swift
struct Swimmer: Human, Swimming {
    var name = "lisi"
    var age = 18
    
    func sayHi() {
        print("Hi, I'm \(name)")
    }
    
    func swim() {
        print("swim")
    }
}
```

4ã€è¿åŠ¨å¥å°†ï¼šâ€œäººç±»â€ + â€œç”°å¾„â€ + â€œæ¸¸æ³³â€

```swift
struct AllAroundAthlete: Human, Runnalbe, Swimming {
    var name: String = "wangwu"
    var age: Int = 25
    
    func sayHi() {
        print("Hi, I'm \(name)")
    }
    
    func run() {
        print("run")
    }
    
    func swim() {
        print("swim")
    }
}
```

### POP

Objective-C çš„UIKitæ¡†æ¶éƒ¨åˆ†ç»§æ‰¿ç»“æ„å›¾ğŸ‘‡ï¼š

![21](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/21.png)

#### ã€Šæ€ªç‰©åŸå ¡ Monster Castleã€‹

å¼€å‘ä¸€æ¬¾å¡”é˜²æ¸¸æˆã€Šæ€ªç‰©åŸå ¡ Monster Castleã€‹ã€‚

ä½¿ç”¨ OOP å¼€å‘ï¼Œæ¸¸æˆä¸­çš„è§’è‰²ï¼š

1. ä¸»è¦åˆ†ä¸ºä¸¤ç±»è§’è‰² `Castle` å’Œ `Monster`ï¼›
2. `Castle` åŒ…æ‹¬ç”µè„‘ç©å®¶ `AI Player` å’ŒçœŸå®ç©å®¶ `Human Player`ï¼›
3. `Monster` åŒ…æ‹¬ä¸‰ç§æ€ªç‰© `Munch Monster`ã€`Quirk Monster` å’Œ `Zap Monster`ã€‚

![22](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/22.png)

æ¸¸æˆä¸­çš„èƒ½åŠ›ï¼š

1. `Castle` å’Œ `Zap Monster` æœ‰å°„å‡»çš„èƒ½åŠ›ã€‚

![23](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/23.png)

é€šè¿‡å°è£…ä¸€ä¸ª Shooting Helper ç±»æ¥å®ç°å°„å‡»çš„èƒ½åŠ›ï¼Œåˆ™ Castle å’Œ Zap Monster é€šè¿‡ Shooting Helper æ¥è¿›è¡Œå°„å‡»ã€‚

è™½ç„¶ä¸€ä¸ªä¸“é—¨è´Ÿè´£å°„å‡»çš„ç±»å¯ä»¥å®ç°éœ€æ±‚ï¼Œä½†æ˜¯æ— æ³•ä» Castle å’Œ Zap Monster çš„**å®šä¹‰**é‡Œé¢çœ‹å‡ºä»–ä»¬æ˜¯æ‹¥æœ‰å°„å‡»çš„èƒ½åŠ›çš„ï¼Œåªæœ‰å»**å†…éƒ¨å®ç°**é‡ŒæŸ¥æ‰¾ Shooting Helper çš„å­˜åœ¨ï¼Œæ‰èƒ½çŸ¥é“è¿™ä¸¤ä¸ªè§’è‰²æ˜¯æœ‰å°„å‡»èƒ½åŠ›çš„ï¼Œè€Œå¦å¤–ä¸¤ä¸ª Munch Monster å’Œ Quirk Monster æ˜¯æ²¡æœ‰è®¾è®¡èƒ½åŠ›çš„ã€‚

---

å¦‚æœä½¿ç”¨ POP å¼€å‘ï¼Œåˆ™ä¸å†å…³å¿ƒè§’è‰²çš„åˆ†ç±»ï¼Œæ‰€æœ‰çš„è§’è‰²éƒ½æ˜¯ `GameObject` çš„å­ç±»ï¼Œå®ƒä»¬çš„ä¸åŒç‚¹åœ¨äºä»–ä»¬æ‹¥æœ‰çš„èƒ½åŠ›ä¸åŒã€‚

æ¸¸æˆä¸­çš„è§’è‰²ï¼š`AI Player`ï¼ˆç”µè„‘ç©å®¶ï¼‰ã€`Human Player`ï¼ˆçœŸå®ç©å®¶ï¼‰ã€`Munch Monster`ï¼ˆè’™å¥‡æ€ªç‰©ï¼‰ã€`Quirk Monster`ï¼ˆé­å…‹æ€ªç‰©ï¼‰ã€`Zap Monster`ï¼ˆæ‰æ™®æ€ªç‰©ï¼‰ã€‚
æ¸¸æˆä¸­çš„èƒ½åŠ›ï¼š`Gun Trait`ï¼ˆå¼ºåˆ¶ç‰¹æ€§ï¼‰ã€`Render Trait`ï¼ˆæ¸²æŸ“ç‰¹æ€§ï¼‰ã€`Movement Trait`ï¼ˆè¿åŠ¨ç‰¹æ€§ï¼‰ã€`Health Trait`ï¼ˆè¡€æ¡ï¼‰ã€`AI Trait`

![24](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/24.png)

åˆ™ä»£ç ä¸­è§’è‰²çš„å½¢æˆï¼Œå®Œå…¨ç”±ä»–æ‰€æ‹¥æœ‰çš„èƒ½åŠ›æç°å‡ºæ¥ï¼š

```swift
class AIPlayer: GameObject, AITrait, GunTrait, RenderTrait, HealthTrait {

}

class ZapMonster: GameObject, GunTrait, RenderTrait, HealthTrait, MovementTrait {

}
```

---

![25](../Swift/é¢å‘å¯¹è±¡ç¼–ç¨‹/25.png)

```swift
class LoginViewController: UIViewController {
    private func isUsernameValid(username: String) -> Bool {
        return true
    }
    
    private func isPasswordValid(password: String) -> Bool {
        return true
    }
    
    @IBAction func loginButtonPressed() {
        if isUsernameValid(username: usernameTextField.text!) &&
           isPasswordValid(password: passwordTextField.text!) {
           // proceed with login
        } else {
           // show alert
        }
    }
}
```

```swift
class UsernameValidator {
    func isUsernameValid(username: String) -> Bool {
        return true
    }
}

class PasswordValidator {
    func isPasswordValid(password: String) -> Bool {
        return true
    }
}

class LoginViewController: UIViewController {
    let usernameValidator = UsernameValidator()
    let passwordValidator = PasswordValidator()
    
    @IBAction func loginButtonPressed() {
        if usernameValidator.isUsernameValid(username: usernameTextField.text!) &&
           passwordValidator.isPasswordValid(password: passwordTextField.text!) {
           // proceed with login
        } else {
           // show alert
        }
    }
}
```